import{d as j,g as q,u as H,a as L}from"./images.api-9d0ce6b5.js";import{ax as S,l as G,m as p,H as y,O as M,o as a,f as $,w as z,b as m,c as _,a as o,F as V,P as R,g as U,t as O,a1 as C,j as b,k as P,a3 as T}from"./vendor-0c23bfd6.js";import"./index-d4fc2d74.js";import"./chunk-bin-ui-next-6e1c6195.js";import"./chunk-brace-b1f520b9.js";const J={class:"images-modal-wrap"},Q={class:"group-wrap"},W=["onClick"],X={class:"img-wrap"},Y={key:0,class:"comp-item img-add"},Z=["onClick"],ee={__name:"image-select",props:{modelValue:{type:String,default:""},ignoreGroupKeys:{type:Array,default:()=>[]}},emits:["update:modelValue","change","resize"],setup(i,{expose:r,emit:f}){const s=i,h=G({get:()=>s.modelValue,set:e=>f("update:modelValue",e)}),d=p(!1),g=p([]),n=p(""),k=p([]),c=p(!1),w=G(()=>!j.includes(n.value));q().then(e=>{g.value=e.filter(t=>!s.ignoreGroupKeys.includes(t.key))});async function v(e){try{c.value=!0,k.value=await L(e)}catch(t){console.log(t)}c.value=!1}function x(e){n.value=e,v(e)}function B(e){h.value=e.src,f("change",e),d.value=!1}async function K(e){try{const t=e.map(u=>({group:n.value,name:u.name,attr:{w:u.width,h:u.height},src:u.image}));await H(t),B(t[0])}catch(t){console.log(t)}}function D(){var e;d.value=!0,n.value=(e=g.value[0])==null?void 0:e.key,v(n.value)}return r({open:D}),(e,t)=>{const u=y("b-scrollbar"),N=y("g-upload"),A=y("g-loading"),E=y("b-modal"),F=M("lazy");return a(),$(E,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=l=>d.value=l),title:"\u9009\u62E9\u56FE\u7247","append-to-body":"",top:"60px",width:"720px","custom-class":"schema-modal"},{default:z(()=>[m("div",J,[m("div",Q,[_(u,{native:""},{default:z(()=>[(a(!0),o(V,null,R(g.value,l=>(a(),o("div",{key:l.key,class:U(["group-item t-ellipsis",{active:n.value===l.key}]),onClick:I=>x(l.key)},O(l.value),11,W))),128))]),_:1})]),m("div",X,[_(u,{native:""},{default:z(()=>[c.value?(a(),$(A,{key:1,spinning:"",type:"square"})):(a(),o(V,{key:0},[C(w)?(a(),o("div",Y,[_(N,{onUpload:K})])):b("",!0),(a(!0),o(V,null,R(k.value,(l,I)=>(a(),o("div",{class:"comp-item",key:I,onClick:ce=>B(l)},[P(m("img",null,null,512),[[F,l.src]])],8,Z))),128))],64))]),_:1})])])]),_:1},8,["modelValue"])}}};var ae=S(ee,[["__scopeId","data-v-2cfb266c"]]);const te={class:"dv-gui g-select-image-wrap"},oe=["src"],se={key:0,class:"g-resize"},le={key:1,class:"g-resize"},ne={__name:"index",props:{modelValue:{type:String,default:""},showResize:{type:Boolean,default:!0},showClear:{type:Boolean,default:!1},ignoreGroupKeys:{type:Array,default:()=>[]}},emits:["update:modelValue","change","resize","clear"],setup(i,{emit:r}){const f=i,s=G({get:()=>f.modelValue,set:c=>r("update:modelValue",c)}),h=p(null);function d(){h.value.open()}function g(c){r("change",c)}function n(){r("resize")}function k(){s.value="",r("clear")}return(c,w)=>{const v=y("b-icon");return a(),o(V,null,[m("div",te,[m("div",{class:U(["g-img",{resize:i.showResize}]),onClick:d},[C(s)?(a(),o("img",{key:0,src:C(s)},null,8,oe)):b("",!0)],2),i.showResize?(a(),o("div",se,[_(v,{name:"expend",type:"button",title:"\u6062\u590D\u9ED8\u8BA4\u56FE\u7247\u5C3A\u5BF8",onClick:n})])):b("",!0),i.showClear?(a(),o("div",le,[_(v,{name:"undo",type:"button",title:"\u91CD\u7F6E",onClick:k})])):b("",!0)]),_(ae,{ref_key:"modalRef",ref:h,"ignore-group-keys":i.ignoreGroupKeys,modelValue:C(s),"onUpdate:modelValue":w[0]||(w[0]=x=>T(s)?s.value=x:null),onChange:g},null,8,["ignore-group-keys","modelValue"])],64)}}};var me=S(ne,[["__scopeId","data-v-30134738"]]);export{me as default};
