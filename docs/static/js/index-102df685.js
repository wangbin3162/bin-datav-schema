var it=Object.defineProperty,rt=Object.defineProperties;var ct=Object.getOwnPropertyDescriptors;var We=Object.getOwnPropertySymbols;var dt=Object.prototype.hasOwnProperty,ut=Object.prototype.propertyIsEnumerable;var Ie=(o,t,n)=>t in o?it(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,Q=(o,t)=>{for(var n in t||(t={}))dt.call(t,n)&&Ie(o,n,t[n]);if(We)for(var n of We(t))ut.call(t,n)&&Ie(o,n,t[n]);return o},Ne=(o,t)=>rt(o,ct(t));import{at as W,l as k,o as v,a as x,g as B,a5 as Te,aF as Oe,m as V,s as me,n as Se,H as g,f as Y,w as _,c as f,F as P,j as ne,b as a,e as $,t as K,B as De,k as ge,Y as Be,N as je,h as L,O as le,L as Xe,$ as mt,D as ve,U as ft,aB as _e,aC as be,aH as ht,E as ke,v as pt,d as Ke,u as ee,X as gt,a1 as M,G as vt,M as Ge,T as _t}from"./vendor-072ca5dc.js";import{u as R,z as ze,A as $e,s as bt,t as Le,i as yt,B as wt,o as Ve,C as G,D as q,M as oe,E as U,F,a as se,G as ae,H as J,g as xt,I as St,q as Ct,J as kt,f as Mt,w as Vt,j as Tt,K as Dt,_ as Bt,l as zt}from"./index-72e67f4d.js";import{M as ue,a as qe}from"./chunk-bin-ui-next-dc092d09.js";import{a as $t,g as Je,b as Lt}from"./database.api-2d43cd64.js";import{d as Rt,a as Wt}from"./file-helper-94af9014.js";import{s as It,l as Nt}from"./template.api-09743275.js";import{b as At}from"./config-1782dc25.js";import{b as Ut}from"./config-4b67b33c.js";import"./chunk-brace-a5f4a3e9.js";const Ft={name:"HeadLoading",setup(){const{schemaStore:o,storeToRefs:t}=R(),{toolbar:n}=t(o);return{loading:k(()=>n.value.loading)}}};function Pt(o,t,n,e,c,l){return v(),x("div",{class:B(["loading-indicator",{loading:e.loading}])},null,2)}var Yt=W(Ft,[["render",Pt],["__scopeId","data-v-5475ad30"]]);function Ze(){const o=Te(),{schemaStore:t,storeToRefs:n}=R(),{pageInfo:e,pageConfig:c,comps:l}=n(t);async function r(s="edit"){const d={id:e.value.id||o.query.id,name:e.value.name,pid:e.value.pid,status:s,layout:JSON.stringify(c.value),components:l.value.map(u=>ze(u.apiData)?{name:u.alias,componentType:u.componentType,componentContent:JSON.stringify(u),componentDataType:$e.static,modelId:"",x:[],y:[],drill:[],filters:[]}:{name:u.alias,componentType:u.componentType,componentDataType:u.apiData.type,modelId:u.apiData.config.modelId,componentContent:JSON.stringify(u),x:u.apiData.config.x,y:u.apiData.config.y,drill:[],filters:[]})};try{return await bt(d)}catch(u){Le("userSchemaStore/saveScreenData",u)}return""}async function i(){let s={};try{t.setGlobalLoading(!0);const d={pageInfo:{id:e.value.id,name:e.value.name||"\u770B\u677F\u9884\u89C8",pid:e.value.pid||"1"},pageConfig:c.value,comps:l.value};s=await $t(d)}catch{s={}}return t.setGlobalLoading(!1),s}return{saveScreenData:r,previewScreen:i}}const Ht={name:"save-screen",props:{modelValue:{type:Boolean},status:{type:String,default:"edit",validator:o=>["edit","audited"].includes(o)}},emits:["update:modelValue"],setup(o,t){const n=k({get:()=>o.modelValue,set:b=>t.emit("update:modelValue",b)}),{schemaStore:e,storeToRefs:c}=R(),{pageInfo:l}=c(e),{saveScreenData:r}=Ze(),i=Oe(),s=Te(),d=V([]),u=V(null),h=V(!1),p=k(()=>`${window.location.origin}/#/screen/${s.query.id}`);yt().then(b=>{d.value=b.data?[b.data]:[]});const m=k(()=>o.status==="edit"?"\u4FDD\u5B58\u770B\u677F":"\u53D1\u5E03\u770B\u677F"),y=()=>{u.value&&u.value.validate(async b=>{if(b){let T="";try{h.value=!0,T=await r(o.status)}catch(w){Le("save-screes/saveKanban",w)}h.value=!1,n.value=!1,ue.success({message:"\u4FDD\u5B58\u6210\u529F\uFF01",showClose:!0}),setTimeout(()=>{if(T&&!l.value.id){let N=i.resolve({path:"/schema/screen",query:{id:T}});window.location.replace(N.href)}},300)}})},S=()=>{Se(()=>{wt(p.value)&&ue.success("\u590D\u5236\u53D1\u5E03\u5730\u5740\u6210\u529F!")})};return me(()=>o.modelValue,b=>{b&&Se(()=>{u.value&&u.value.resetFields()})}),{formRef:u,pageInfo:l,dirTree:d,loading:h,visible:n,saveKanban:y,btnText:m,shareUrl:p,copyUrl:S}}},Et=$("\u590D\u5236\u9884\u89C8\u5730\u5740"),Ot={class:"t-center"};function jt(o,t,n,e,c,l){const r=g("b-input"),i=g("b-form-item"),s=g("g-input"),d=g("b-button"),u=g("b-form"),h=g("b-modal");return v(),Y(h,{modelValue:e.visible,"onUpdate:modelValue":t[2]||(t[2]=p=>e.visible=p),"append-to-body":"",title:e.btnText,top:"200px","custom-class":"schema-modal",onClose:t[3]||(t[3]=p=>e.visible=!1)},{default:_(()=>[f(u,{"label-width":"80px",ref:"formRef",model:e.pageInfo,"label-suffix":":"},{default:_(()=>[f(i,{label:"\u770B\u677F\u540D\u79F0",prop:"name",rules:{required:!0,message:"\u770B\u677F\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:_(()=>[f(r,{modelValue:e.pageInfo.name,"onUpdate:modelValue":t[0]||(t[0]=p=>e.pageInfo.name=p)},null,8,["modelValue"])]),_:1}),n.status==="audited"&&o.$route.query.id?(v(),x(P,{key:0},[f(i,{label:"\u9884\u89C8\u5730\u5740"},{default:_(()=>[f(s,{modelValue:e.shareUrl,"onUpdate:modelValue":t[1]||(t[1]=p=>e.shareUrl=p),readonly:"",type:"textarea",autosize:{minRows:3}},null,8,["modelValue"])]),_:1}),f(i,null,{default:_(()=>[f(d,{type:"text",onClick:e.copyUrl},{default:_(()=>[Et]),_:1},8,["onClick"])]),_:1})],64)):ne("",!0)]),_:1},8,["model"]),a("div",Ot,[f(d,{type:"primary",onClick:e.saveKanban,loading:e.loading,style:{width:"200px"}},{default:_(()=>[$(K(e.btnText),1)]),_:1},8,["onClick","loading"])])]),_:1},8,["modelValue","title"])}var Xt=W(Ht,[["render",jt]]);const Kt={name:"save-template",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(o,t){const{schemaStore:n,storeToRefs:e}=R(),{pageConfig:c,comps:l}=e(n),r=V(null),i=De({loading:!1,id:`temp_${Ve()}`,name:""}),s=k({get:()=>o.modelValue,set:p=>t.emit("update:modelValue",p)}),d=k(()=>({template:{id:i.id,name:i.name},pageConfig:c.value,comps:l.value})),u=()=>{r.value&&r.value.validate(async p=>{if(p){const m=d.value,y=JSON.stringify(m);Rt(y,`${m.template.id}.json`),ue.success({message:"\u6A21\u677F\u6587\u4EF6\u5DF2\u4FDD\u5B58\uFF01",showClose:!0})}})},h=async()=>{r.value&&r.value.validate(async p=>{if(p){try{i.loading=!0;const m=d.value,y=m.template.name,S=JSON.stringify(m);await It({name:y,content:S})}catch(m){Le("save-template/saveAsTemplate",m)}i.loading=!1,s.value=!1,ue.success({message:"\u6A21\u677F\u5DF2\u4FDD\u5B58\uFF01",showClose:!0})}})};return me(()=>o.modelValue,p=>{p&&(r.value&&r.value.resetFields(),i.id=`temp_${Ve()}`)}),{formRef:r,formStatus:i,visible:s,downloadCfg:u,saveAsTemplate:h}}},Gt={class:"t-center"},qt=$(" \u914D\u7F6E\u6587\u4EF6 "),Jt=$(" \u4FDD\u5B58\u6A21\u677F ");function Zt(o,t,n,e,c,l){const r=g("b-input"),i=g("b-form-item"),s=g("b-form"),d=g("b-button"),u=g("b-modal");return v(),Y(u,{modelValue:e.visible,"onUpdate:modelValue":t[1]||(t[1]=h=>e.visible=h),"append-to-body":"",title:"\u4FDD\u5B58\u4E3A\u6A21\u677F",top:"200px","custom-class":"schema-modal",onClose:t[2]||(t[2]=h=>e.visible=!1)},{default:_(()=>[f(s,{"label-width":"80px",ref:"formRef",model:e.formStatus,"label-suffix":":"},{default:_(()=>[f(i,{label:"\u6A21\u677F\u540D\u79F0",prop:"name",rules:{required:!0,message:"\u6A21\u677F\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:_(()=>[f(r,{modelValue:e.formStatus.name,"onUpdate:modelValue":t[0]||(t[0]=h=>e.formStatus.name=h)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),a("div",Gt,[f(d,{type:"primary",icon:"vertical-align-botto",transparent:"",style:{width:"120px"},onClick:e.downloadCfg},{default:_(()=>[qt]),_:1},8,["onClick"]),f(d,{type:"primary",icon:"save",style:{width:"120px"},loading:e.formStatus.loading,onClick:e.saveAsTemplate},{default:_(()=>[Jt]),_:1},8,["loading","onClick"])])]),_:1},8,["modelValue"])}var Qt=W(Kt,[["render",Zt]]);const eo={name:"header-bar",components:{SaveTemplate:Qt,SaveScreen:Xt,HeadLoading:Yt},props:{backUrl:{type:String},backTarget:{type:String,default:"_blank",validator:o=>["_self","_blank"].includes(o)},pageStatus:{type:Object,default:()=>({})}},setup(o){const t=Oe(),{schemaStore:n,storeToRefs:e}=R(),{pageInfo:c,toolbar:l}=e(n),{previewScreen:r}=Ze(),i=V(!1),s=V("edit"),d=V(!1);return{schemaStore:n,pageInfo:c,toolbar:l,saveVisible:i,saveStatus:s,tempVisible:d,handleBack:()=>{const S=o.backUrl||"/";if(o.backTarget==="_blank"){const b=t.resolve(S);window.open(b.href,o.backTarget)}else t.push(S)},handleSaveScreen:()=>{s.value="edit",i.value=!0},handPreview:async()=>{const S=await r();let b=t.resolve({path:`/screen/preview/${S.pageInfo.id}`});window.open(b.href,"_blank")},handlePublish:()=>{s.value="audited",i.value=!0},handleUpload:S=>S.type!=="application/json"?(ue.warning("\u8BF7\u9009\u62E9\u6B63\u786E\u7684json\u914D\u7F6E\u6587\u4EF6"),!1):(Wt(S).then(b=>{try{const T=JSON.parse(b),{comps:w,pageConfig:N}=T;n.loadScreenData({comps:w,pageConfig:N})}catch{console.warn("The imported file could not be converted to the correct JSON!")}}),!1)}}},to={class:"header-container"},oo={class:"left-actions"},ao={class:"screen-info"},no=a("span",null,"\u5206\u6790\u770B\u677F",-1),lo=a("span",{style:{padding:"0 6px 0 12px"}},"-",-1),so={class:"global-actions"},io={class:"head-btn"};function ro(o,t,n,e,c,l){const r=g("b-icon"),i=g("b-tooltip"),s=g("b-space"),d=g("b-upload"),u=g("head-loading"),h=g("save-screen"),p=g("save-template");return v(),x(P,null,[a("div",to,[a("div",oo,[f(s,{size:"mini"},{default:_(()=>[f(i,{content:"\u7EC4\u4EF6","open-delay":500},{default:_(()=>[a("div",{class:B(["head-btn",{active:e.toolbar.components}]),onClick:t[0]||(t[0]=m=>e.schemaStore.toggleCompsPanel())},[f(r,{name:"hourglass",class:B(["com-list-icon",{"is-rotate":!e.toolbar.components}])},null,8,["class"])],2)]),_:1}),f(i,{content:"\u56FE\u5C42","open-delay":500},{default:_(()=>[a("div",{class:B(["head-btn",{active:e.toolbar.layer}]),onClick:t[1]||(t[1]=m=>e.schemaStore.toggleLayerPanel())},[f(r,{name:"container"})],2)]),_:1}),f(i,{content:"\u53F3\u4FA7\u9762\u677F","open-delay":500},{default:_(()=>[a("div",{class:B(["head-btn",{active:e.toolbar.config}]),onClick:t[2]||(t[2]=m=>e.schemaStore.toggleConfigPanel())},[f(r,{name:"control"})],2)]),_:1}),f(i,{content:"\u5DE5\u5177\u7BB1","open-delay":500},{default:_(()=>[a("div",{class:B(["head-btn",{active:e.toolbar.toolbox}]),onClick:t[3]||(t[3]=m=>e.schemaStore.toggleToolbox())},[f(r,{name:"shopping"})],2)]),_:1})]),_:1})]),a("div",ao,[f(i,{content:"\u8FD4\u56DE","open-delay":500},{default:_(()=>[f(r,{name:"laptop",type:"button",onClick:e.handleBack},null,8,["onClick"])]),_:1}),no,lo,ge(a("input",{class:"header-input",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",maxlength:"50",type:"text","onUpdate:modelValue":t[4]||(t[4]=m=>e.pageInfo.name=m)},null,512),[[Be,e.pageInfo.name]])]),a("div",so,[f(s,{size:"mini"},{default:_(()=>[f(i,{content:"\u5BFC\u5165json (\u4F1A\u8986\u76D6\u6240\u6709\u5185\u5BB9\uFF01)","open-delay":500},{default:_(()=>[f(d,{action:"/","show-upload-list":!1,"before-upload":e.handleUpload},{default:_(()=>[a("div",io,[f(r,{name:"Import"})])]),_:1},8,["before-upload"])]),_:1}),f(i,{content:"\u4FDD\u5B58\u6A21\u677F","open-delay":500},{default:_(()=>[a("div",{class:"head-btn",onClick:t[5]||(t[5]=m=>e.tempVisible=!0)},[f(r,{name:"Storedprocedure"})])]),_:1}),f(i,{content:"\u4FDD\u5B58","open-delay":500},{default:_(()=>[a("div",{class:"head-btn",onClick:t[6]||(t[6]=(...m)=>e.handleSaveScreen&&e.handleSaveScreen(...m))},[f(r,{name:"save"})])]),_:1}),f(i,{content:"\u53D1\u5E03","open-delay":500},{default:_(()=>[a("div",{class:"head-btn",onClick:t[7]||(t[7]=(...m)=>e.handlePublish&&e.handlePublish(...m))},[f(r,{name:"send"})])]),_:1}),f(i,{content:"\u9884\u89C8","open-delay":500},{default:_(()=>[a("div",{class:"head-btn",onClick:t[8]||(t[8]=(...m)=>e.handPreview&&e.handPreview(...m))},[f(r,{name:"View"})])]),_:1})]),_:1})])]),f(u),f(h,{modelValue:e.saveVisible,"onUpdate:modelValue":t[9]||(t[9]=m=>e.saveVisible=m),status:e.saveStatus},null,8,["modelValue","status"]),f(p,{modelValue:e.tempVisible,"onUpdate:modelValue":t[10]||(t[10]=m=>e.tempVisible=m)},null,8,["modelValue"])],64)}var co=W(eo,[["render",ro]]);const pe=De({x:0,y:0});function Re(o={}){const{schemaStore:t,storeToRefs:n}=R(),{contextMenu:e,selectedCom:c}=n(t),l=k(()=>{var u;return(u=c.value)==null?void 0:u.locked}),r=k(()=>{var u;return(u=c.value)==null?void 0:u.hided}),i=k(()=>({display:e.value.show?"block":"none",left:`${pe.x+10}px`,top:`${pe.y+10}px`,transform:document.documentElement.clientHeight-pe.y<250?"translate(0px, -100%)":""})),s=u=>{u.preventDefault(),c.value&&(pe.x=u.clientX,pe.y=u.clientY,e.value.show=!0,G(document,"click",d))},d=()=>{q(document,"click",d),o&&o.beforeClose&&o.beforeClose(),e.value.show=!1};return{showMenu:s,isLocked:l,isHided:r,contextMenu:e,contextMenuStyle:i}}const uo={name:"layer-panel",setup(){const{schemaStore:o,storeToRefs:t}=R(),{comps:n,toolbar:e,hoveredComId:c,selectedCom:l,renamingComId:r}=t(o),{showMenu:i}=Re(),s=k(()=>!!l.value),d=k(()=>({opacity:l.value?1:.3})),u=k(()=>{var C;return{enable:!!l.value,checked:(C=l.value)==null?void 0:C.locked}}),h=k(()=>{var C;return{enable:!!l.value,checked:(C=l.value)==null?void 0:C.hided}}),p=k(()=>[...n.value].reverse()),m=C=>{l.value&&o.moveCom(l.value.id,C)};return{schemaStore:o,comps:n,toolbar:e,enableBtnClass:s,enableBtnStyle:d,moveUp:()=>m(oe.up),moveDown:()=>m(oe.down),moveTop:()=>m(oe.top),moveBottom:()=>m(oe.bottom),descComs:p,enableLockBtnClass:u,enableHideBtnClass:h,onEnter:C=>o.hoverCom(C),onLeave:()=>o.hoverCom(""),selectCom:C=>{const j=n.value.find(Z=>Z.id===C);j&&o.selectCom(j)},hoveredComId:c,selectedCom:l,renamingComId:r,showMenu:i,cancelSelectCom:()=>o.selectCom()}}},mo={class:"layer-panel"},fo={class:"layer-top"},ho=a("div",{class:"layer-num pl-10"},"\u56FE\u5C42",-1),po=a("i",{class:"b-iconfont b-icon-left",title:"\u6536\u8D77"},null,-1),go=[po],vo={class:"layer-toolbar layer-toolbar-top"},_o={class:"layer-manager-wrap"},bo=["title","onMousedown","onMouseenter","onDblclick"],yo=["onUpdate:modelValue"],wo={key:1,class:"layer-item-span"},xo={class:"layer-item-text"},So=["title","onClick"],Co=["title","onClick"];function ko(o,t,n,e,c,l){const r=g("b-icon"),i=je("focus");return v(),x("div",{class:B(["layer-panel-wp",{"is-hide":!e.toolbar.layer}])},[a("div",mo,[a("div",fo,[ho,a("div",{class:"layer-action",onClick:t[0]||(t[0]=s=>e.schemaStore.toggleLayerPanel(!1))},go)]),a("div",vo,[a("i",{title:"\u4E0A\u79FB\u4E00\u5C42",class:B(["b-iconfont b-icon-arrowup toolbar-icon standard",e.enableBtnClass]),style:L(e.enableBtnStyle),onClick:t[1]||(t[1]=(...s)=>e.moveUp&&e.moveUp(...s))},null,6),a("i",{title:"\u4E0B\u79FB\u4E00\u5C42",class:B(["b-iconfont b-icon-arrowdown toolbar-icon standard",e.enableBtnClass]),style:L(e.enableBtnStyle),onClick:t[2]||(t[2]=(...s)=>e.moveDown&&e.moveDown(...s))},null,6),a("i",{title:"\u7F6E\u9876",class:B(["b-iconfont b-icon-vertical-align-botto toolbar-icon standard",e.enableBtnClass]),style:L(Q({transform:"rotate(180deg)"},e.enableBtnStyle)),onClick:t[3]||(t[3]=(...s)=>e.moveTop&&e.moveTop(...s))},null,6),a("i",{title:"\u7F6E\u5E95",class:B(["b-iconfont b-icon-vertical-align-botto toolbar-icon standard",e.enableBtnClass]),style:L(e.enableBtnStyle),onClick:t[4]||(t[4]=(...s)=>e.moveBottom&&e.moveBottom(...s))},null,6)]),a("div",_o,[(v(!0),x(P,null,le(e.descComs,s=>(v(),x("div",{key:s.id,title:s.alias,class:B(["layer-manager-item",[{hided:s.hided,locked:s.locked,hovered:s.id===e.hoveredComId,selected:e.selectedCom&&s.id===e.selectedCom.id}]]),onMousedown:d=>e.schemaStore.selectCom(s.id),onMouseenter:d=>e.onEnter(s.id),onMouseleave:t[7]||(t[7]=(...d)=>e.onLeave&&e.onLeave(...d)),onDblclick:d=>e.schemaStore.renamingCom(s.id),onContextmenu:t[8]||(t[8]=d=>e.showMenu(d))},[f(r,{name:s.icon,size:"18"},null,8,["name"]),s.id===e.renamingComId?ge((v(),x("input",{key:0,"onUpdate:modelValue":d=>s.alias=d,class:"layer-item-input",onBlur:t[5]||(t[5]=d=>e.schemaStore.renamingCom("")),onKeydown:t[6]||(t[6]=Xe(d=>e.schemaStore.renamingCom(""),["enter"]))},null,40,yo)),[[Be,s.alias,void 0,{trim:!0}],[i]]):(v(),x("span",wo,[a("span",xo,K(s.alias),1)])),a("i",{class:B(["b-iconfont",`b-icon-${s.hided?"eye-close":"eye"}`,"show-toggle-btn"]),title:s.hided?"\u663E\u793A":"\u9690\u85CF",onClick:d=>s.hided=!s.hided},null,10,So),a("i",{class:B(["b-iconfont",`b-icon-${s.locked?"lock":"unlock"}`,"show-toggle-btn"]),title:s.locked?"\u89E3\u9501":"\u9501\u5B9A",onClick:d=>s.locked=!s.locked},null,10,Co)],42,bo))),128)),a("div",{class:"last-flex-item",onClick:t[9]||(t[9]=(...s)=>e.cancelSelectCom&&e.cancelSelectCom(...s))})])])],2)}var Mo=W(uo,[["render",ko]]);const Vo={name:"VBasicBar",alias:"\u57FA\u672C\u67F1\u56FE",img:U("basic-bar.jpg"),type:"bar",used:!0},To={name:"VHorizontalBar",alias:"\u57FA\u672C\u6761\u5F62\u56FE",img:U("hori-basic-bar.jpg"),type:"bar",used:!0},Do={name:"VBasicLine",alias:"\u57FA\u672C\u6298\u7EBF\u56FE",img:U("basic-line.jpg"),type:"line",used:!0},Bo={name:"VBasicArea",alias:"\u57FA\u672C\u533A\u57DF\u56FE",img:U("basic-area.jpg"),type:"line",used:!0},zo={name:"VBasicPie",alias:"\u57FA\u672C\u997C\u56FE",img:U("basic-pie.jpg"),type:"pie",used:!0},$o={name:"VBasicRing",alias:"\u57FA\u672C\u73AF\u56FE",img:U("basic-ring.jpg"),type:"pie",used:!0},Lo={name:"VBasicRadar",alias:"\u57FA\u672C\u96F7\u8FBE\u56FE",img:U("basic-radar.jpg"),type:"map",used:!0},Ro={name:"VBasicFunnel",alias:"\u57FA\u672C\u68AF\u5EA6\u56FE",img:U("basic-funnel.jpg"),type:"map",used:!0},Wo={name:"VBasicWordCloud",alias:"\u57FA\u672C\u8BCD\u4E91\u56FE",img:U("basic-wordcloud.jpg"),type:"map",used:!0},Io={name:"VBasicGauge",alias:"\u57FA\u672C\u4EEA\u8868\u76D8",img:U("basic-gauge.png"),type:"map",used:!0},No={name:"VMainTitle",alias:"\u901A\u7528\u6807\u9898",img:U("main-title.png"),type:"info",used:!0},Ao={name:"VNumberTitleFlop",alias:"\u6570\u5B57\u6307\u6807",img:U("number-title-flop.png"),type:"info",used:!0},Uo={name:"VTimer",alias:"\u65F6\u95F4\u5668",img:U("timer.png"),type:"info",used:!0},Fo={name:"VBgBox",alias:"\u80CC\u666F\u5757",img:U("bg-box.png"),type:"media",used:!0},Po={name:"VBorderBox",alias:"\u8FB9\u6846",img:U("border-box.png"),type:"media",used:!0},Yo={name:"VDecoration",alias:"\u88C5\u9970\u5668",img:U("decoration.png"),type:"media",used:!0},Ho={name:"VMainImg",alias:"\u5355\u5F20\u56FE\u7247",img:U("img.png"),type:"media",used:!0},Eo={name:"VScrollTable",alias:"\u57FA\u7840\u8868\u683C",img:U("scroll-table.jpg"),type:"table",used:!0},Ce=[{type:"bar",name:"\u67F1\u56FE",icon:"barchart",data:[Vo,To]},{type:"line",name:"\u7EBF\u56FE",icon:"linechart",data:[Do,Bo]},{type:"pie",name:"\u997C\u56FE",icon:"piechart",data:[zo,$o]},{type:"radar",name:"\u96F7\u8FBE\u56FE",icon:"radarchart",data:[Lo]},{type:"other",name:"\u5176\u4ED6\u56FE\u8868",icon:"ungroup",data:[Ro,Wo,Io]},{type:"table",name:"\u8868\u683C",icon:"table",data:[Eo]},{type:"info",name:"\u4FE1\u606F",icon:"info-circle",data:[No,Ao,Uo]},{type:"media",name:"\u5A92\u4F53",icon:"Youtube",data:[Fo,Po,Yo,Ho]}];function Oo(o){for(let t=0;t<Ce.length;t++){const n=Ce[t];for(let e=0;e<n.data.length;e++){const c=n.data[e];if(c.name===o)return{classification:n,com:c}}}return null}const Qe=()=>se.map(o=>({color:{type:"solid",value:o,from:ae.alpha(o,.8),to:ae.alpha(o,.2)}})),jo={alias:"\u57FA\u672C\u67F1\u56FE",icon:"barchart",type:F.com,componentType:"bar",attr:{w:500,h:300},config:{global:{fontFamily:"Microsoft Yahei",margin:{top:40,bottom:50,left:50,right:10},innerPadding:20,outerPadding:30,barWidth:"auto",borderRadius:0,background:{show:!0,color:"rgba(255, 255, 255, 0.1)"}},label:{show:!1,position:"top",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"},offsetX:0,offsetY:0},legend:{show:!0,position:"top-center",orient:"horizontal",textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"},symbol:{show:!0,icon:"auto",width:25,height:14,gap:10}},xAxis:{show:!0,type:"category",boundaryGap:!0,title:{show:!0,name:"X\u8F74",location:"center",display:{rotate:0,offset:30},textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"}},axisLine:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisTick:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisLabel:{show:!0,timeFormat:"MM/DD",interval:"auto",display:{rotate:0,margin:10},align:"center",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"}},grid:{show:!0,line:{type:"dashed",width:1,color:"rgba(233, 228, 228, 0.1)",dashedLength:4,dashedSpace:4}}},yAxis:{show:!0,extent:{min:"auto",max:"auto"},splitNumber:0,title:{show:!1,name:"Y\u8F74",location:"end",display:{rotate:0,offset:20},textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"}},axisLine:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisTick:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisLabel:{show:!0,valueFormat:"auto",boundaryGap:0,display:{rotate:0,margin:10},align:"right",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"}},grid:{show:!0,line:{type:"dashed",width:1,color:"rgba(233, 228, 228, 0.1)",dashedLength:4,dashedSpace:4}}},tooltip:{show:!0,textStyle:{fontSize:14,color:"#fff",fontWeight:"normal"},background:{padding:{h:5,v:5},color:"rgba(0, 0, 0, 0.65)"},pointer:{show:!0,line:{type:"dashed",width:1,color:"#f5dc69",dashedLength:4,dashedSpace:4}}},series:Qe()},apiData:J({staticPath:"bar/basic-bar"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[]}}},Xo={alias:"\u901A\u7528\u6807\u9898",icon:"file-word",type:F.com,attr:{w:300,h:48},config:{title:"\u6211\u662F\u6807\u9898\u6570\u636E",textStyle:{fontFamily:"Microsoft Yahei",fontSize:24,color:"#fff",fontWeight:"normal"},textAlign:"center",writingMode:"horizontal-tb",backgroundStyle:{show:!1,bgColor:"#008bff",borderRadius:15,borderColor:"#fff",borderStyle:"solid",borderWidth:1},ellipsis:!1,urlConfig:{url:"",isBlank:!1}},apiData:{},events:{}},Ko={alias:"\u6570\u5B57\u6307\u6807",icon:"orderedlist",type:F.com,attr:{w:300,h:74},config:{global:{fontFamily:"Microsoft Yahei",arrangement:"top",distance:0},title:{content:"\u6570\u5B57\u6307\u6807\u6807\u9898",textStyle:{fontSize:18,color:"#79daff",fontWeight:"normal",textAlign:"flex-start"}},counter:{textStyle:{fontFamily:"Microsoft Yahei",fontSize:36,color:"#0a73ff",fontWeight:"bolder",textAlign:"left"},value:1234567,duration:1e3,autoplay:!0,decimals:2,decimal:".",separator:",",prefix:"\uFFE5",suffix:""}},apiData:J({staticPath:"text/number-title-flop"}),events:{}},Go={alias:"\u88C5\u9970\u5668",icon:"pushpin",type:F.com,attr:{w:200,h:200},config:{img:"decoration10"},apiData:{},events:{}},qo={alias:"\u8FB9\u6846",icon:"gateway",type:F.com,attr:{w:300,h:180},config:{img:"box1"},apiData:{},events:{}},Jo={alias:"\u5355\u5F20\u56FE\u7247",icon:"image",type:F.com,attr:{w:300,h:180},config:{backgroundImage:xt("/background/bg1.jpg"),repeat:"no-repeat",radius:2,urlConfig:{url:"",ifBlank:!1}},apiData:{},events:{}},Zo={alias:"\u65F6\u95F4\u5668",icon:"time-circle",type:F.com,attr:{w:300,h:56},config:{iconStyle:{show:!0,size:1.2,color:"rgba(93,245,244,1)",marginRight:6},time:{textStyle:{fontFamily:"Microsoft Yahei",fontSize:18,color:"#fff",fontWeight:"normal"},format:"YYYY-MM-DD HH:mm:ss",duration:1e3,horizontal:"center",vertical:"center"}},apiData:{},events:{}},Qo={alias:"\u57FA\u672C\u6761\u5F62\u56FE",icon:"menu",type:F.com,componentType:"bar",attr:{w:500,h:300},config:{global:{fontFamily:"Microsoft Yahei",margin:{top:40,bottom:50,left:60,right:10},innerPadding:20,outerPadding:30,barWidth:"auto",borderRadius:0,background:{show:!0,color:"rgba(255, 255, 255, 0.1)"}},label:{show:!1,position:"top",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"},offsetX:0,offsetY:0},legend:{show:!0,position:"top-center",orient:"horizontal",textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"},symbol:{show:!0,icon:"auto",width:25,height:14,gap:10}},yAxis:{show:!0,type:"category",boundaryGap:!0,title:{show:!1,name:"Y\u8F74",location:"center",display:{rotate:0,offset:30},textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"}},axisLine:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisTick:{show:!1,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisLabel:{show:!0,timeFormat:"MM/DD",interval:"auto",display:{rotate:0,margin:20},align:"center",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"}},grid:{show:!0,line:{type:"dashed",width:1,color:"rgba(233, 228, 228, 0.1)",dashedLength:4,dashedSpace:4}}},xAxis:{show:!0,extent:{min:"auto",max:"auto"},splitNumber:0,title:{show:!1,name:"X\u8F74",location:"end",display:{rotate:0,offset:20},textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"}},axisLine:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisTick:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisLabel:{show:!0,valueFormat:"auto",boundaryGap:0,display:{rotate:0,margin:10},align:"center",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"}},grid:{show:!0,line:{type:"dashed",width:1,color:"rgba(233, 228, 228, 0.1)",dashedLength:4,dashedSpace:4}}},tooltip:{show:!0,textStyle:{fontSize:14,color:"#fff",fontWeight:"normal"},background:{padding:{h:5,v:5},color:"rgba(0, 0, 0, 0.65)"},pointer:{show:!0,line:{type:"dashed",width:1,color:"#f5dc69",dashedLength:4,dashedSpace:4}}},series:Qe()},apiData:J({staticPath:"bar/basic-bar"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[]}}},ea=()=>se.map(o=>({lineStyle:{width:2,color:o,type:"solid"},areaStyle:{from:ae.alpha(o,.8),to:ae.alpha(o,.2),opacity:.8}})),ta={alias:"\u57FA\u672C\u533A\u57DF\u56FE",icon:"linechart",type:F.com,componentType:"line",attr:{w:500,h:300},config:{global:{fontFamily:"Microsoft Yahei",margin:{top:40,bottom:50,left:50,right:10},smooth:!1},label:{show:!1,position:"top",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"},offsetX:0,offsetY:0},legend:{show:!0,position:"top-center",orient:"horizontal",textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"},symbol:{show:!0,icon:"auto",width:25,height:14,gap:10}},xAxis:{show:!0,type:"category",boundaryGap:!0,title:{show:!1,name:"X\u8F74",location:"center",display:{rotate:0,offset:30},textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"}},axisLine:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisTick:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisLabel:{show:!0,timeFormat:"MM/DD",interval:"auto",display:{rotate:0,margin:10},align:"center",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"}},grid:{show:!1,line:{type:"dashed",width:1,color:"rgba(233, 228, 228, 0.1)",dashedLength:4,dashedSpace:4}}},yAxis:{show:!0,extent:{min:"auto",max:"auto"},splitNumber:0,title:{show:!1,name:"Y\u8F74",location:"end",display:{rotate:0,offset:20},textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"}},axisLine:{show:!1,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisTick:{show:!1,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisLabel:{show:!0,valueFormat:"auto",boundaryGap:0,display:{rotate:0,margin:10},align:"center",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"}},grid:{show:!0,line:{type:"solid",width:1,color:"rgba(233, 228, 228, 0.1)",dashedLength:4,dashedSpace:4}}},tooltip:{show:!0,textStyle:{fontSize:14,color:"#fff",fontWeight:"normal"},background:{padding:{h:5,v:5},color:"rgba(0, 0, 0, 0.65)"},pointer:{show:!0,line:{type:"dashed",width:1,color:"#f5dc69",dashedLength:4,dashedSpace:4}}},series:ea()},apiData:J({staticPath:"line/basic-line"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[""]}}},oa={alias:"\u6EDA\u52A8\u8868\u683C",icon:"table",type:F.com,componentType:"scrollTable",attr:{w:500,h:260},config:{rowNum:5,headerBGC:"#00BAFF",oddRowBGC:"#003B51",evenRowBGC:"#0A2732",waitTime:2e3,headerHeight:35,indexHeader:"#",carousel:"single",hoverPause:!1,index:!0,indexWidth:50,indexAlign:"center",columnWidth:[],align:[]},apiData:J({staticPath:"table/scroll-table"}),events:{}},aa={alias:"\u57FA\u672C\u997C\u56FE",icon:"piechart",type:F.com,componentType:"pie",attr:{w:500,h:300},config:{global:{fontFamily:"Microsoft Yahei",center:["50%","50%"],radius:["0","75%"],roseType:!1,borderRadius:0},label:{show:!0,position:"outside",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"},formatter:"",alignTo:"none",bleedMargin:10,distanceToLabelLine:5},legend:{show:!0,position:"bottom-center",orient:"horizontal",textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"},symbol:{show:!0,icon:"auto",width:25,height:14,gap:10}},tooltip:{show:!0,textStyle:{fontSize:14,color:"#fff",fontWeight:"normal"},background:{padding:{h:5,v:5},color:"rgba(0, 0, 0, 0.65)"}}},apiData:J({staticPath:"pie/basic-pie"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[]}}},na={alias:"\u57FA\u672C\u73AF\u56FE",icon:"piechart",type:F.com,componentType:"pie",attr:{w:500,h:300},config:{global:{fontFamily:"Microsoft Yahei",center:["50%","50%"],radius:["50%","75%"],roseType:!1,borderRadius:5},label:{show:!0,position:"outside",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"},formatter:"",alignTo:"none",bleedMargin:10,distanceToLabelLine:5},legend:{show:!0,position:"bottom-center",orient:"horizontal",textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"},symbol:{show:!0,icon:"auto",width:25,height:14,gap:10}},tooltip:{show:!0,textStyle:{fontSize:14,color:"#fff",fontWeight:"normal"},background:{padding:{h:5,v:5},color:"rgba(0, 0, 0, 0.65)"}}},apiData:J({staticPath:"pie/basic-pie"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[]}}},la={alias:"\u57FA\u672C\u96F7\u8FBE\u56FE",icon:"radarchart",type:F.com,componentType:"radar",attr:{w:500,h:300},config:{global:{fontFamily:"Microsoft Yahei",center:["50%","50%"],radius:"75%",startAngle:90,shape:"polygon",splitNumber:4,axisLine:{show:!0,lineStyle:{color:"rgba(211, 253, 250, 0.8)"}},axisName:{show:!0,color:"rgba(211, 253, 250, 0.8)"},splitLine:{show:!0,lineStyle:{color:["rgba(211, 253, 250, 0.8)"]}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}},symbolSize:2,areaStyle:{opacity:.1}},label:{show:!1,position:"top",textStyle:{fontSize:10,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"},formatter:""},legend:{show:!1,position:"top-center",orient:"horizontal",textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"},symbol:{show:!0,icon:"auto",width:25,height:14,gap:10}},tooltip:{show:!1,textStyle:{fontSize:14,color:"#fff",fontWeight:"normal"},background:{padding:{h:5,v:5},color:"rgba(0, 0, 0, 0.65)"}},color:se},apiData:J({staticPath:"radar/basic-radar"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[]}}},sa=()=>se.map((o,t)=>({color:{type:"solid",value:o,from:ae.alpha(o,.8),to:ae.alpha(se[t+1],.2)}})),ia={alias:"\u68AF\u5EA6\u56FE",icon:"funnelchart",type:F.com,componentType:"funnel",attr:{w:500,h:300},config:{global:{minSize:"20%",maxSize:"80%",orient:"vertical",sort:"descending",gap:5,margin:{left:"20",top:"20",right:"20",bottom:"20"},funnelAlign:"center"},label:{show:!0,position:"left",textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"},formatter:""},labelLine:{show:!1,length:30,lineStyle:{color:null,width:1,type:"solid"}},tooltip:{show:!0,textStyle:{fontSize:14,color:"#fff",fontWeight:"normal"},background:{padding:{h:5,v:5},color:"rgba(0, 0, 0, 0.4)"}},legend:{show:!1,position:"middle-auto",orient:"vertical",top:"middle",right:"1%",bottom:"auto",left:"auto",symbol:{show:!0,icon:"circle",width:25,height:14,gap:10},textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal",rich:{name:{width:170,fontSize:13},per:{width:50,fontSize:13},value:{width:30,fontSize:13,color:"#999",align:"right"}}},formatter:"{name|\u81EA\u7136\u4EBA\u884C\u653F\u8BB8\u53EF}{per|26%} {value|50}",selectedMode:!0,color:se},series:sa()},apiData:J({staticPath:"funnel/basic-funnel"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[]}}},ra={alias:"\u8BCD\u4E91\u56FE",icon:"wordcloudchart",type:F.com,componentType:"other",attr:{w:500,h:300},config:{tooltip:{show:!0,textStyle:{fontSize:14,color:"",fontWeight:"normal"}},series:[{type:"wordCloud",sizeRange:[10,45],rotationRange:[0,0],rotationStep:45,gridSize:13,shape:"circle",drawOutOfBound:!1,grid:{left:"center",top:"middle"},width:"100%",height:"100%",textStyle:{color:"#fff",emphasis:{textStyle:{shadowBlur:10,shadowColor:"#ee6666"}}},data:[]}]},apiData:J({staticPath:"wordcloud/basic-wordcloud"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[]}}},ca=()=>se.map(o=>({color:{type:"solid",value:o,from:ae.alpha(o,.8),to:ae.alpha(o,.2)}})),da={alias:"\u4EEA\u8868\u76D8",icon:"dashboard",type:F.com,componentType:"gauge",attr:{w:500,h:300},config:{global:{center:["50%","50%"],radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,splitNumber:10},tooltip:{show:!0,textStyle:{fontSize:14,color:"#999",fontWeight:"bolder"},background:{padding:{h:5,v:5},color:"rgba(255, 255, 255, 0.65)"}},detail:{show:!0,formatter:"{value}%",color:null,fontWeight:"bolder",fontSize:30,width:100,overflow:"truncate",offsetCenter:["0%","95%"],valueAnimation:!0,unit:"%"},axisLine:{show:!0,roundCap:!0,lineStyle:{color:[[1,"#E6EBF8"]],width:10}},progress:{show:!0,overlap:!0,width:10,roundCap:!0,clip:!1},splitLine:{show:!0,length:"5%",distance:10,lineStyle:{color:"#63677A",width:3,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:6,distance:10,lineStyle:{color:"#fff",width:1,type:"solid"}},axisLabel:{show:!0,distance:15,color:"#fff",fontWeight:"normal",fontSize:12,width:100,overflow:"truncate"},pointer:{show:!0,showAbove:!0,icon:"triangle",offsetCenter:[0,0],length:"60%",width:6},anchor:{show:!1,showAbove:!0,size:6,offsetCenter:[0,0],icon:"circle",itemStyle:{color:"#fff",opacity:1}},title:{show:!0,offsetCenter:["0%","70%"],color:"#fff",fontWeight:"normal",fontSize:16,width:100,overflow:"truncate"},series:ca()},apiData:J({staticPath:"funnel/basic-funnel"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[]}}},ua={id:"",name:"",alias:"",type:"",locked:!1,hided:!1,attr:{x:0,y:0,w:100,h:100,rotate:0,opacity:1},apiData:{},events:{}};function A(o,t){const n=St(Ct(ua),t||{});return n.id=`${o}_${Ve()}`,n.name=`V${o}`,ze(n.apiData)||(n.apiData.comId=n.id),n}function et(o){switch(o.substr(1)){case"BasicBar":return A("BasicBar",jo);case"HorizontalBar":return A("HorizontalBar",Qo);case"BasicLine":return A("BasicLine",Ut);case"BasicArea":return A("BasicArea",ta);case"BasicPie":return A("BasicPie",aa);case"BasicRing":return A("BasicRing",na);case"BasicRadar":return A("BasicRadar",la);case"ScrollTable":return A("ScrollTable",oa);case"MainTitle":return A("MainTitle",Xo);case"NumberTitleFlop":return A("NumberTitleFlop",Ko);case"Timer":return A("Timer",Zo);case"BgBox":return A("BgBox",At);case"BorderBox":return A("BorderBox",qo);case"Decoration":return A("Decoration",Go);case"MainImg":return A("MainImg",Jo);case"BasicFunnel":return A("BasicFunnel",ia);case"BasicWordCloud":return A("BasicWordCloud",ra);case"BasicGauge":return A("BasicGauge",da);default:throw Error(`Unknown component type: ${o}.`)}}const ma={name:"components-panel",setup(){const{schemaStore:o,storeToRefs:t}=R(),{pageConfig:n,toolbar:e,selectedCom:c}=t(o),l=V(0),r=k(()=>Ce[l.value].data);return{toolbar:e,activeIndex:l,componentsList:Ce,comps:r,changeComp:p=>{o.toggleCompsPanel(!0),l.value=p},dragStart:(p,m)=>{p.dataTransfer.setData("text",m)},toAddCom:async(p,m)=>{if(m){const y=et(p);if(y.attr.x=Math.floor((n.value.width-y.attr.w)/2),y.attr.y=Math.floor((n.value.height-y.attr.h)/2),o.addCom({component:y}),o.selectCom(y),y.apiData&&y.apiData.type===$e.static&&y.apiData.staticPath){const{data:S}=await Je(y.id,y.apiData.staticPath);c.value.apiData.config.data=JSON.stringify(S)}}else console.log("\u6B63\u5728\u5F00\u53D1\u4E2D\u3002\u3002\u3002")},dragOver:p=>{p.preventDefault(),p.stopPropagation(),p.dataTransfer.dropEffect="none"},closePanel:()=>{e.value.components&&o.toggleCompsPanel(!1)}}}},fa={class:"components-panel-wp"},ha={class:"components-panel"},pa=a("div",{class:"panel-title"},[a("span",{class:"panel-text"},"\u7EC4\u4EF6")],-1),ga={class:"components-type"},va=["onClick"],_a={class:"com-tab-title"},ba={class:"p10"},ya=["title","draggable","onDragstart","onClick"],wa={class:"comp-item-text"};function xa(o,t,n,e,c,l){const r=g("b-icon"),i=g("b-scrollbar"),s=je("click-outside");return v(),x("div",fa,[a("div",ha,[pa,a("div",{class:"components-panel-content",onDragover:t[0]||(t[0]=(...d)=>e.dragOver&&e.dragOver(...d))},[a("div",ga,[f(i,{native:""},{default:_(()=>[(v(!0),x(P,null,le(e.componentsList,(d,u)=>(v(),x("div",{class:B(["components-item",{active:e.activeIndex===u}]),key:u,onClick:h=>e.changeComp(u)},[f(r,{class:"com-tab-icon",name:d.icon},null,8,["name"]),a("span",_a,K(d.name),1)],10,va))),128))]),_:1})]),ge((v(),x("div",{class:B(["components-list",{"is-hide":!e.toolbar.components}])},[f(i,{native:""},{default:_(()=>[a("div",ba,[(v(!0),x(P,null,le(e.comps,(d,u)=>(v(),x("div",{class:"comp-item",key:u,title:d.alias,draggable:d.used,onDragstart:h=>e.dragStart(h,d.name),onClick:h=>e.toAddCom(d.name,d.used)},[a("div",wa,K(d.alias),1),a("div",{class:"comp-item-img",style:L(`background-image: url(${d.img});`)},null,4)],40,ya))),128))])]),_:1})],2)),[[s,e.closePanel]])],32)])])}var Sa=W(ma,[["render",xa]]);const Ae=o=>`${o}px`,Ue=(o,t,n,e)=>{const c=o!=null?o:document.createElement("canvas");c.width=t*e,c.height=n*e,c.style.width=Ae(t),c.style.height=Ae(n);const l=c.getContext("2d");return l&&l.setTransform(e,0,0,e,0,0),c};class Fe{constructor(t,n){this.el=t,this.options=Q({direction:"TB",width:1e3,height:20,bgColor:"#0e1013",fontFamily:"sans-serif",fontSize:"10px",fontColor:"#90a0ae",strokeStyle:"rgba(161, 174, 179, 0.8)",lineWidth:.5,indicatorLineWidth:1,scale:1,offset:40,ratio:2},n),this.canvas=null,this.ctx=null,this.ruler={width:0,height:0},this.constructRuler()}constructRuler(){const{el:t,options:n}=this,{direction:e,width:c,height:l,ratio:r}=n,i=Math.max(e==="TB"?t.offsetWidth:t.offsetHeight,c),s=l;this.ruler.width=i,this.ruler.height=s;const d=Ue(null,i,s,r);kt(d,"canvas-ruler"),t.appendChild(d),this.canvas=d,this.ctx=d.getContext("2d"),this.drawRuler()}drawRuler(){const{ctx:t,options:n,ruler:e}=this,{width:c,height:l}=e;t.beginPath(),t.fillStyle=n.bgColor,t.fillRect(0,0,c,l),t.closePath(),t.beginPath(),t.font=`${n.fontSize} ${n.fontFamily}`,t.textAlign="left",t.fillStyle=n.fontColor,t.strokeStyle=n.strokeStyle,t.lineWidth=n.lineWidth,this.drawPoints(),t.stroke()}drawPoints(){const{ctx:t,options:n,ruler:e}=this,{width:c,height:l}=e,{offset:r,scale:i}=n,s=0,d=l/1.5,u=l/1.2;for(let h=0;h<=c;h+=1){const p=h-r;if(p<0)continue;let m=-1,y=-1;p%50===0?(m=Math.floor(p/i),y=s):p%25===0?y=d:p%5===0&&(y=u),y>=0&&(t.moveTo(h+.5,l+.5),t.lineTo(h+.5,y),m>-1&&t.fillText(`${m}`,h+2.5,l/1.5))}}setSize(t,n,e){const{el:c,options:l}=this;l.width=t,l.height=n,l.scale=e;const{direction:r,width:i,height:s,ratio:d}=l,u=Math.max(r==="TB"?c.offsetWidth:c.offsetHeight,i),h=s;this.ruler.width=u,this.ruler.height=h,Ue(this.canvas,u,h,d),this.drawRuler()}destroy(){const{el:t}=this;t.remove()}}const Ca={name:"ruler",setup(){const{schemaStore:o,storeToRefs:t}=R(),{canvas:n}=t(o),e=V(null),c=V(null),l=V(null),r=V(null),i=V(!0),s=V(0),d=V(0),u=document.documentElement.clientWidth;mt(()=>{if(e.value&&c.value){const p=Math.max(n.value.width,u);l.value?l.value.setSize(p,18,n.value.scale):l.value=new Fe(e.value,{direction:"TB",width:p,scale:n.value.scale}),r.value?r.value.setSize(n.value.height,18,n.value.scale):r.value=new Fe(c.value,{direction:"LR",width:n.value.height,scale:n.value.scale})}});const h=p=>{const m=p.target;s.value=m.scrollLeft,d.value=m.scrollTop};return ve(()=>{const p=document.getElementById("canvas-wp");p==null||p.addEventListener("scroll",h)}),ft(()=>{const p=document.getElementById("canvas-wp");p==null||p.removeEventListener("scroll",h)}),{visible:i,hRulerWpRef:e,vRulerWpRef:c,vScroll:d,hScroll:s}}},ka=o=>(_e("data-v-5f454e16"),o=o(),be(),o),Ma={class:"canvas-ruler-wp"},Va=ka(()=>a("div",{class:"ruler-corner"},null,-1));function Ta(o,t,n,e,c,l){return v(),x("div",Ma,[a("div",{ref:"hRulerWpRef",class:"ruler-wrapper h-container",style:L(`transform: translateX(-${e.hScroll}px);`)},null,4),a("div",{ref:"vRulerWpRef",class:"ruler-wrapper v-container",style:L(`transform: rotate(90deg) translateX(-${e.vScroll}px);`)},null,4),Va])}var Da=W(Ca,[["render",Ta],["__scopeId","data-v-5f454e16"]]);const de=ht();function tt(o){return o*Math.PI/180}function Pe(o){return Math.abs(Math.sin(tt(o)))}function Ye(o){return Math.abs(Math.cos(tt(o)))}function He(o){if(o=Q({},o),o.rotate!==0){const t=o.width*Ye(o.rotate)+o.height*Pe(o.rotate),n=(o.width-t)/2;o.left+=n,o.right=o.left+t;const e=o.height*Ye(o.rotate)+o.width*Pe(o.rotate),c=(e-o.height)/2;o.top-=c,o.bottom=o.top+e,o.width=t,o.height=e}else o.bottom=o.top+o.height,o.right=o.left+o.width;return o}const Ba=5,za={name:"mark-line",setup(){const{schemaStore:o,storeToRefs:t}=R(),{comps:n,selectedCom:e,canvas:c,toolbox:l}=t(o),r=V([]),i=V(["xt","xc","xb","yl","yc","yr"]),s=V({xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}),d=()=>{Object.keys(s.value).forEach(b=>{s.value[b]=!1})};function u({key:b,value:T}){const w={left:"x",top:"y"};o.setShapeSingleStyle({key:w[b],value:T})}const h=(b,T)=>{const w=r.value,N=e.value,D=n.value.filter(X=>!X.hided),H=c.value.scale,C=He(y(N.attr)),j=C.width/2,Z=C.height/2;d(),D.forEach(X=>{if(X.id===N.id||X.locked||X.hided)return;const{top:E,left:O,bottom:te,right:z,width:ie,height:ye}=He(y(X.attr)),re=ie/2,fe=ye/2,we={top:[{isNearly:S(C.top,E),lineNode:w.xt,line:"xt",dragShift:E,lineShift:E},{isNearly:S(C.bottom,E),lineNode:w.xt,line:"xt",dragShift:E-C.height,lineShift:E},{isNearly:S(C.top+Z,E+fe),lineNode:w.xc,line:"xc",dragShift:E+fe-Z,lineShift:E+fe},{isNearly:S(C.top,te),lineNode:w.xb,line:"xb",dragShift:te,lineShift:te},{isNearly:S(C.bottom,te),lineNode:w.xb,line:"xb",dragShift:te-C.height,lineShift:te}],left:[{isNearly:S(C.left,O),lineNode:w.yl,line:"yl",dragShift:O,lineShift:O},{isNearly:S(C.right,O),lineNode:w.yl,line:"yl",dragShift:O-C.width,lineShift:O},{isNearly:S(C.left+j,O+re),lineNode:w.yc,line:"yc",dragShift:O+re-j,lineShift:O+re},{isNearly:S(C.left,z),lineNode:w.yr,line:"yr",dragShift:z,lineShift:z},{isNearly:S(C.right,z),lineNode:w.yr,line:"yr",dragShift:z-C.width,lineShift:z}]},he=[],{rotate:Me}=C;Object.keys(we).forEach(xe=>{we[xe].forEach(ce=>{if(!ce.isNearly)return;const st=Me!==0?p(xe,ce,C):ce.dragShift;u({key:xe,value:st}),ce.lineNode.style[xe]=`${ce.lineShift*H+60}px`,he.push(ce.line)})}),he.length&&m(he,b,T)})},p=(b,T,w)=>{const{w:N,h:D}=e.value.attr;return Math.round(b==="top"?T.dragShift-(D-w.height)/2:T.dragShift-(N-w.width)/2)},m=(b,T,w)=>{w?b.includes("yr")?s.value.yr=!0:b.includes("yc")?s.value.yc=!0:b.includes("yl")&&(s.value.yl=!0):b.includes("yl")?s.value.yl=!0:b.includes("yc")?s.value.yc=!0:b.includes("yr")&&(s.value.yr=!0),T?b.includes("xb")?s.value.xb=!0:b.includes("xc")?s.value.xc=!0:b.includes("xt")&&(s.value.xt=!0):b.includes("xt")?s.value.xt=!0:b.includes("xc")?s.value.xc=!0:b.includes("xb")&&(s.value.xb=!0)},y=b=>({left:b.x,top:b.y,width:b.w,height:b.h,rotate:b.rotate}),S=(b,T)=>Math.abs(b-T)<=Ba;return ve(()=>{de.on("move",({isDownward:b,isRightward:T})=>{l.value.markLine&&h(b,T)}),de.on("unmove",()=>{d()})}),ke(()=>{de.off("move"),de.off("unmove")}),{lineRefs:r,lines:i,lineStatus:s}}},$a={class:"mark-line"};function La(o,t,n,e,c,l){return v(),x("div",$a,[(v(!0),x(P,null,le(e.lines,r=>ge((v(),x("div",{key:r,class:B(["line",[r.includes("x")?"xline":"yline",r]]),ref_for:!0,ref:i=>{e.lineRefs[r]=i}},null,2)),[[pt,e.lineStatus[r]||!1]])),128))])}var Ra=W(za,[["render",La],["__scopeId","data-v-00d4450a"]]);const{schemaStore:ot}=R(),Wa=[{direction:"lt",angle:0},{direction:"t",angle:45},{direction:"rt",angle:90},{direction:"r",angle:135},{direction:"rb",angle:180},{direction:"b",angle:225},{direction:"lb",angle:270},{direction:"l",angle:315}],Ee=[{start:338,end:23,cursor:"nwse-resize"},{start:23,end:68,cursor:"ns-resize"},{start:68,end:113,cursor:"nesw-resize"},{start:113,end:158,cursor:"ew-resize"},{start:158,end:203,cursor:"nwse-resize"},{start:203,end:248,cursor:"ns-resize"},{start:248,end:293,cursor:"nesw-resize"},{start:293,end:338,cursor:"ew-resize"}],Ia=o=>{const t=(o+360)%360,n={};let e=-1;return Wa.forEach(c=>{const l=(c.angle+t)%360,r=Ee.length,i=0;for(;i<r;){e=(e+1)%r;const s=Ee[e];if(l<23||l>=338){n[c.direction]="nwse-resize";break}if(s.start<=l&&l<s.end){n[c.direction]=s.cursor;break}}}),n};function Na(o,t,n,e,c,l){o==="t"?(l.h=Math.round(t.h+(n.y-e.y)/c),l.y=Math.round(t.y+(e.y-n.y)/c),l.h=Math.max(l.h,20)):o==="rt"?(l.h=Math.round(t.h+(n.y-e.y)/c),l.w=Math.round(t.w+(e.x-n.x)/c),l.y=Math.round(t.y+(e.y-n.y)/c),l.w=Math.max(l.w,20),l.h=Math.max(l.h,20)):o==="r"?(l.w=Math.round(t.w+(e.x-n.x)/c),l.w=Math.max(l.w,20)):o==="rb"?(l.h=Math.round(t.h+(e.y-n.y)/c),l.w=Math.round(t.w+(e.x-n.x)/c),l.w=Math.max(l.w,20),l.h=Math.max(l.h,20)):o==="b"?(l.h=Math.round(t.h+(e.y-n.y)/c),l.h=Math.max(l.h,20)):o==="lb"?(l.h=Math.round(t.h+(e.y-n.y)/c),l.w=Math.round(t.w+(n.x-e.x)/c),l.x=Math.round(t.x+(e.x-n.x)/c),l.w=Math.max(l.w,20),l.h=Math.max(l.h,20)):o==="l"?(l.w=Math.round(t.w+(n.x-e.x)/c),l.x=Math.round(t.x+(e.x-n.x)/c),l.w=Math.max(l.w,20)):o==="lt"&&(l.h=Math.round(t.h+(n.y-e.y)/c),l.w=Math.round(t.w+(n.x-e.x)/c),l.x=Math.round(t.x+(e.x-n.x)/c),l.y=Math.round(t.y+(e.y-n.y)/c),l.w=Math.max(l.w,20),l.h=Math.max(l.h,20))}const at=(o,t,n,e,c)=>{const l=Q({},n.attr),r=Object.create(null),i=o.clientX,s=o.clientY;let d=!1;const u=p=>{d=!0;const m=p.clientX,y=p.clientY;t?Na(t,l,{x:i,y:s},{x:m,y},e,r):(r.x=l.x+Math.round((m-i)/e/c)*c,r.y=l.y+Math.round((y-s)/e/c)*c),n.attr=Q(Q({},n.attr),r),Se().then(()=>{de.emit("move",{isDownward:y-s>0,isRightward:m-i>0})})},h=()=>{de.emit("unmove"),d&&ot.recordSnapshot(),q(document,"mousemove",u),q(document,"mouseup",h)};G(document,"mousemove",u),G(document,"mouseup",h)},Aa=(o,t,n,e)=>{at(o,null,t,n,e)},Ua=(o,t,n,e)=>{at(o,t,n,e)},Fa=(o,t,n)=>{const e=t.getBoundingClientRect(),c=e.left+e.width/2,l=e.top+e.height/2,r=Math.atan2(l-o.clientY,c-o.clientX)*180/Math.PI-n.attr.rotate;let i=!1;const s=u=>{i=!0;const h=Math.atan2(l-u.clientY,c-u.clientX)*180/Math.PI-r,p=Math.round(h%360);n.attr.rotate=p<0?p+360:p},d=()=>{i&&ot.recordSnapshot(),q(document,"mousemove",s),q(document,"mouseup",d)};G(document,"mousemove",s),G(document,"mouseup",d)},Pa={name:"refer-line",props:{attr:{type:Object,required:!0},scale:{type:Number,required:!0}},setup(o){const t=k(()=>({height:`${o.attr.y+60/o.scale}px`,borderLeftWidth:`${.9/o.scale}px`})),n=k(()=>({width:`${o.attr.x+60/o.scale}px`,borderTopWidth:`${.9/o.scale}px`})),e=k(()=>({fontSize:`${12/o.scale}px`,top:`-${6/o.scale}px`,left:`-${6/o.scale}px`}));return{topLineStyle:t,leftLineStyle:n,accountStyle:e}}},Ya={class:"nav-line"};function Ha(o,t,n,e,c,l){return v(),x("div",Ya,[a("div",{class:"nav-line-top",style:L(e.topLineStyle)},null,4),a("div",{class:"nav-line-left",style:L(e.leftLineStyle)},null,4),a("div",{class:"nav-line-account",style:L(e.accountStyle)},K(n.attr.x)+", "+K(n.attr.y),5)])}var Ea=W(Pa,[["render",Ha]]);const Oa={name:"dv-transform",components:{ReferLine:Ea},props:{data:{type:Object,required:!0}},setup(o){const t=gt(),{showMenu:n}=Re(),{schemaStore:e,storeToRefs:c}=R(),{canvas:l,comps:r,pageConfig:i,selectedCom:s,hoveredComId:d,toolbox:u,spaceDown:h}=c(e),p=k(()=>d.value===o.data.id),m=k(()=>!ze(s.value)&&s.value.id===o.data.id),y=k(()=>({locked:o.data.locked,selected:m.value})),S=k(()=>({top:0,left:0,width:`${o.data.attr.w}px`,height:`${o.data.attr.h}px`,transform:`translate(${o.data.attr.x}px, ${o.data.attr.y}px)`})),b=k(()=>({"is-hide":!m.value||o.data.locked})),T=k(()=>({cursor:"move",transform:`rotate(${o.data.attr.rotate}deg)`})),w=k(()=>({width:`${o.data.attr.w}px`,height:`${o.data.attr.h}px`})),N=k(()=>({display:o.data.hided?"none":"block"})),D=k(()=>Ia(o.data.attr.rotate)),H=k(()=>l.value.scale),C=k(()=>{const z=`scale(${1/H.value}, ${1/H.value})`;return{t:{name:"top",style:{cursor:D.value.t,transform:z}},rt:{name:"top-right",style:{cursor:D.value.rt},rotateStyle:{"transform-origin":"25% 75%",transform:z}},r:{name:"right",style:{cursor:D.value.r,transform:z}},rb:{name:"bottom-right",style:{cursor:D.value.rb},rotateStyle:{"transform-origin":"25% 25%",transform:z}},b:{name:"bottom",style:{cursor:D.value.b,transform:z}},lb:{name:"bottom-left",style:{cursor:D.value.lb},rotateStyle:{"transform-origin":"75% 25%",transform:z}},l:{name:"left",style:{cursor:D.value.l,transform:z}},lt:{name:"top-left",style:{cursor:D.value.lt},rotateStyle:{"transform-origin":"75% 75%",transform:z}}}}),j=()=>e.hoverCom(o.data.id),Z=()=>e.hoverCom(""),X=()=>{m.value||e.selectCom(o.data)};return{comps:r,selectedCom:s,hoveredComId:d,toolbox:u,isHovered:p,isSelected:m,hideStyle:N,transformClass:y,transformStyle:S,handlerClass:b,handlerStyle:T,wrapperStyle:w,onEnter:j,onLeave:Z,onMove:z=>{h.value||(z.stopPropagation(),z.preventDefault(),X(),Aa(z,o.data,H.value,i.value.grid))},onZoom:(z,ie)=>{X(),Ua(z,ie,o.data,H.value)},onRotate:z=>{Fa(z,t.vnode.el,o.data)},points:C,scale:H,showMenu:n}}},ja={class:"dv-com"},Xa=["onMousedown"],Ka=["onMousedown"],Ga=a("div",{class:"transform-bg"},null,-1);function qa(o,t,n,e,c,l){const r=g("refer-line");return v(),x("div",{class:B(["dv-transform",e.transformClass]),style:L(e.transformStyle)},[e.toolbox.referLine&&e.isSelected?(v(),Y(r,{key:0,attr:n.data.attr,scale:e.scale},null,8,["attr","scale"])):ne("",!0),a("div",{class:B(["dv-scale",{hovered:e.isHovered}]),style:L(e.hideStyle),onMouseenter:t[2]||(t[2]=(...i)=>e.onEnter&&e.onEnter(...i)),onMouseleave:t[3]||(t[3]=(...i)=>e.onLeave&&e.onLeave(...i)),onMousedown:t[4]||(t[4]=(...i)=>e.onMove&&e.onMove(...i))},[a("div",{class:B(["transform-handler",e.handlerClass]),style:L(e.handlerStyle)},[a("div",ja,[Ke(o.$slots,"default"),a("div",{class:"dv-event-disable",style:L(e.wrapperStyle),onContextmenu:t[0]||(t[0]=(...i)=>e.showMenu&&e.showMenu(...i))},null,36)]),(v(!0),x(P,null,le(e.points,(i,s)=>(v(),x(P,{key:s},[i.rotateStyle?(v(),x("i",{key:0,class:B(`${i.name}-handler`),"data-html2canvas-ignore":""},[a("span",{class:"rotate-handler",style:L(i.rotateStyle),onMousedown:t[1]||(t[1]=ee((...d)=>e.onRotate&&e.onRotate(...d),["prevent","stop"]))},[a("span",{class:"control-point",style:L(i.style),onMousedown:ee(d=>e.onZoom(d,s),["prevent","stop"])},null,44,Xa)],36)],2)):(v(),x("i",{key:1,class:B(`${i.name}-handler`),"data-html2canvas-ignore":""},[a("span",{class:"control-point",style:L(i.style),onMousedown:ee(d=>e.onZoom(d,s),["prevent","stop"])},null,44,Ka)],2))],64))),128)),Ga],6)],38),n.data.locked?(v(),x("i",{key:1,class:"b-iconfont b-icon-lock",title:"\u89E3\u9501",onClick:t[5]||(t[5]=ee(i=>e.selectedCom.locked=!1,["stop"]))})):ne("",!0)],6)}var Ja=W(Oa,[["render",qa]]);const Za=["onClick"],Qa=["onClick"],en={__name:"index",setup(o){const{schemaStore:t}=R(),n=k(()=>t.toolbar.config?{right:"332px"}:{right:0}),e=()=>t.undo(),c=()=>t.redo();return(l,r)=>(v(),x("div",{class:"action-bar-wrap",style:L(M(n))},[a("i",{class:"action-btn b-iconfont b-icon-aim",title:"\u6700\u4F73\u753B\u5E03\u6BD4\u4F8B",onClick:r[0]||(r[0]=ee(i=>M(t).autoCanvasScale(),["stop"]))}),a("i",{class:"action-btn b-iconfont b-icon-icon-test",title:"1:1\u753B\u5E03\u5927\u5C0F",onClick:r[1]||(r[1]=ee(i=>M(t).setCanvasScale(100),["stop"]))}),a("i",{class:"action-btn b-iconfont b-icon-rollback",title:"\u64A4\u9500",onClick:ee(e,["stop"])},null,8,Za),a("i",{class:"action-btn b-iconfont b-icon-rollback",title:"\u91CD\u505A",onClick:ee(c,["stop"]),style:{transform:"rotateY(180deg)"}},null,8,Qa)],4))}};var tn=W(en,[["__scopeId","data-v-1c712a36"]]);const on={name:"canvas-main",components:{Ruler:Da,ActionBar:tn,MarkLine:Ra,DvTransform:Ja},setup(){const{schemaStore:o,storeToRefs:t}=R(),{pageConfig:n,spaceDown:e,canvas:c,selectedCom:l,comps:r,toolbox:i,getPanelOffsetLeft:s,getPanelOffsetTop:d}=t(o),u=V(null),h=De({drag:!1,startX:0,startY:0}),p=k(()=>({width:`${c.value.width}px`,height:`${c.value.height}px`})),m=k(()=>({position:"absolute",width:`${n.value.width}px`,height:`${n.value.height}px`,transform:`scale(${c.value.scale}) translate(0px, 0px)`,backgroundImage:`url(${n.value.bgImage})`,backgroundColor:n.value.bgColor})),y=Mt(o.autoCanvasScale,50),S=async w=>{w.preventDefault();try{const N=w.dataTransfer.getData("text");if(N){const D=et(N),{scale:H}=c.value,C=(w.clientX-s.value+u.value.scrollLeft)/H,j=(w.clientY-d.value+u.value.scrollTop)/H;if(D.attr.x=Math.round(C-D.attr.w/2),D.attr.y=Math.round(j-D.attr.h/2),o.addCom({component:D}),o.selectCom(D),D.apiData&&D.apiData.type===$e.static&&D.apiData.staticPath){const{data:Z}=await Je(D.id,D.apiData.staticPath);l.value.apiData.config.data=JSON.stringify(Z)}}}catch(N){console.warn(N)}},b=w=>{w.preventDefault(),w.stopPropagation(),w.dataTransfer.dropEffect="copy"},T=w=>{e.value||o.selectCom(),h.drag=!0;const N=w.clientX,D=w.clientY,H=c.value.scale,{scrollLeft:C,scrollTop:j,clientWidth:Z,scrollWidth:X,clientHeight:E,scrollHeight:O}=u.value,te=Z<X||E<O,z={left:C,top:j},ie=re=>{if(!e.value||!h.drag||!te)return;const fe=re.clientX,we=re.clientY,he=Math.round((fe-N)/H),Me=Math.round((we-D)/H);u.value.scrollLeft=z.left-he,u.value.scrollTop=z.top-Me},ye=()=>{h.drag=!1,q(document,"mousemove",ie),q(document,"mouseup",ye)};G(document,"mousemove",ie),G(document,"mouseup",ye)};return ve(()=>{G(window,"resize",y),y()}),ke(()=>{q(window,"resize",y)}),Ne(Q({canvasWpRef:u},vt(h)),{screenShotStyle:p,canvasPanelStyle:m,comps:r,toolbox:i,cancelSelectCom:T,dropToAddCom:S,dragOver:b})}},an={class:"canvas-main"};function nn(o,t,n,e,c,l){const r=g("mark-line"),i=g("action-bar"),s=g("ruler"),d=g("dv-transform");return v(),x("div",an,[a("div",{id:"canvas-wp",ref:"canvasWpRef",class:"canvas-panel-wrap",onMousedown:t[2]||(t[2]=ee((...u)=>e.cancelSelectCom&&e.cancelSelectCom(...u),["stop"]))},[a("div",{class:"screen-shot",style:L(e.screenShotStyle)},[e.toolbox.markLine?(v(),Y(r,{key:0,style:L(e.screenShotStyle)},null,8,["style"])):ne("",!0),f(i),f(s),a("div",{id:"canvas-components",class:"canvas-panel",style:L(e.canvasPanelStyle),onDragover:t[0]||(t[0]=(...u)=>e.dragOver&&e.dragOver(...u)),onDrop:t[1]||(t[1]=(...u)=>e.dropToAddCom&&e.dropToAddCom(...u))},[(v(!0),x(P,null,le(e.comps,u=>(v(),Y(d,{key:u.id,data:u},{default:_(()=>[(v(),Y(Ge(u.name),{data:u,style:L({transform:"translateZ(0px)",opacity:u.attr.opacity})},null,8,["data","style"]))]),_:2},1032,["data"]))),128))],36)],4)],544)])}var ln=W(on,[["render",nn]]);const sn={name:"page-config",setup(){const{schemaStore:o,storeToRefs:t}=R(),{pageConfig:n}=t(o),e=V(""),c=()=>{n.value.bgColor="#0d2a42",n.value.bgImage=""},l=()=>o.autoCanvasScale(),r=i=>{if(i!=="custom"){const s=i.split("x"),d=+s[0],u=+s[1];o.setScreenSize({width:d,height:u})}};return me([()=>n.value.width,()=>n.value.height],()=>{const{width:i,height:s}=n.value;i===1920&&s===1080||i===2560&&s===1080||i===3440&&s===1080||i===3440&&s===1440||i===414&&s===736||i===375&&s===667||i===375&&s===812?e.value=`${i}x${s}`:e.value="custom"},{immediate:!0}),{screenLabel:e,onSizeChange:l,resetBGImage:c,pageConfig:n,pageMap:[{group:"web\u7AEF",data:Vt.map(i=>({value:`${i.width}x${i.height}`,label:i.label}))},{group:"\u79FB\u52A8\u8BBE\u5907",data:Tt.map(i=>({value:`${i.width}x${i.height}`,label:i.label}))},{group:"\u5176\u4ED6",data:[{value:"custom",label:"\u81EA\u5B9A\u4E49"}]}],sizeChange:r}}},rn=o=>(_e("data-v-75712752"),o=o(),be(),o),cn={class:"page-config-panel"},dn=rn(()=>a("div",{class:"page-config-top"},"\u9875\u9762\u8BBE\u7F6E",-1)),un={class:"page-config-content"},mn={class:"page-config-wp"},fn=$("\u6062\u590D\u9ED8\u8BA4\u80CC\u666F"),hn={class:"page-config-wp"};function pn(o,t,n,e,c,l){const r=g("g-group-select"),i=g("g-field"),s=g("g-input-number"),d=g("g-color-picker"),u=g("g-upload-img"),h=g("g-images-select"),p=g("b-button");return v(),x("div",cn,[dn,a("div",un,[a("div",mn,[f(i,{label:"\u5C4F\u5E55\u8BBE\u7F6E",flat:""},{default:_(()=>[f(r,{modelValue:e.screenLabel,"onUpdate:modelValue":t[0]||(t[0]=m=>e.screenLabel=m),data:e.pageMap,onChange:e.sizeChange},null,8,["modelValue","data","onChange"])]),_:1}),f(i,{label:"\u5C4F\u5E55\u5927\u5C0F",flat:""},{default:_(()=>[f(s,{modelValue:e.pageConfig.width,"onUpdate:modelValue":t[1]||(t[1]=m=>e.pageConfig.width=m),label:"\u5BBD\u5EA6",min:375,max:3840,inline:"",suffix:"px",onChange:e.onSizeChange},null,8,["modelValue","onChange"]),f(s,{modelValue:e.pageConfig.height,"onUpdate:modelValue":t[2]||(t[2]=m=>e.pageConfig.height=m),label:"\u9AD8\u5EA6",min:600,max:2160,inline:"",suffix:"px",onChange:e.onSizeChange},null,8,["modelValue","onChange"])]),_:1}),f(i,{label:"\u80CC\u666F\u989C\u8272"},{default:_(()=>[f(d,{modelValue:e.pageConfig.bgColor,"onUpdate:modelValue":t[3]||(t[3]=m=>e.pageConfig.bgColor=m)},null,8,["modelValue"])]),_:1}),f(i,{label:"\u80CC\u666F\u56FE",tooltip:"\u652F\u6301\u56FE\u7247\u5730\u5740\u3001\u9759\u6001\u8DEF\u5F84\u3001base64\u5B58\u50A8"},{default:_(()=>[f(u,{modelValue:e.pageConfig.bgImage,"onUpdate:modelValue":t[4]||(t[4]=m=>e.pageConfig.bgImage=m)},null,8,["modelValue"])]),_:1}),f(i,{label:"\u80CC\u666F\u9884\u8BBE",tooltip:"\u53EF\u4EE5\u52A0\u8F7D\u5BF9\u5E94\u9884\u8BBE\u7684\u56FE\u7247\u80CC\u666F"},{default:_(()=>[f(h,{modelValue:e.pageConfig.bgImage,"onUpdate:modelValue":t[5]||(t[5]=m=>e.pageConfig.bgImage=m),images:["bg"],"value-key":"src"},null,8,["modelValue"])]),_:1}),f(i,{label:"\u91CD\u7F6E"},{default:_(()=>[f(p,{type:"primary",size:"small",onClick:e.resetBGImage},{default:_(()=>[fn]),_:1},8,["onClick"])]),_:1})]),a("div",hn,[f(i,{label:"\u6805\u683C\u95F4\u8DDD",tooltip:"\u6BCF\u6B21\u79FB\u52A8\u7684\u8DDD\u79BB\uFF0C\u5355\u4F4Dpx"},{default:_(()=>[f(s,{modelValue:e.pageConfig.grid,"onUpdate:modelValue":t[6]||(t[6]=m=>e.pageConfig.grid=m),min:1,max:20,suffix:"px"},null,8,["modelValue"])]),_:1})])])])}var gn=W(sn,[["render",pn],["__scopeId","data-v-75712752"]]);const vn={name:"config-title",props:{comName:{type:String,required:!0},comAlias:{type:String,required:!0}},setup(o){const t=k(()=>{const e=Oo(o.comName);return e==null?void 0:e.com.name});return{toSearch:()=>{window.open("https://echarts.apache.org/zh/option.html#title","_blank")},comTitle:t}}},nt=o=>(_e("data-v-68e00668"),o=o(),be(),o),_n={class:"com-title-wp"},bn={class:"com-title"},yn={class:"title-name"},wn={class:"alias-name"},xn={class:"version-tag"},Sn=nt(()=>a("i",{class:"b-iconfont b-icon-search"},null,-1)),Cn=nt(()=>a("span",null,"\u641C\u7D22\u914D\u7F6E",-1)),kn=[Sn,Cn];function Mn(o,t,n,e,c,l){return v(),x("div",_n,[a("div",bn,[a("div",yn,[a("span",wn,K(n.comAlias),1)]),a("div",xn,[a("span",null,K(e.comTitle),1)])]),Ke(o.$slots,"default",{},()=>[a("div",{class:"search-config",onClick:t[0]||(t[0]=(...r)=>e.toSearch&&e.toSearch(...r)),title:"echarts option config"},kn)],!0)])}var lt=W(vn,[["render",Mn],["__scopeId","data-v-68e00668"]]);const Vn={name:"data-center-panel",components:{ConfigTitle:lt,SourcePanel:Dt(()=>Bt(()=>import("./source-panel-2e9bc758.js"),["static/js/source-panel-2e9bc758.js","static/css/source-panel-9456a5cd.css","static/js/index-72e67f4d.js","static/css/index-ffd9ef82.css","static/js/vendor-072ca5dc.js","static/css/vendor-2b79d43b.css","static/js/chunk-brace-a5f4a3e9.js","static/js/chunk-bin-ui-next-dc092d09.js","static/css/chunk-bin-ui-next-adf58ce0.css"]))},setup(){const{schemaStore:o,storeToRefs:t}=R(),{selectedCom:n}=t(o),e=k(()=>Object.keys(n.value.apiData));return{selectedCom:n,dataKeys:e}}},Tn={class:"data-center-panel"},Dn={class:"scroll-container"},Bn={key:1,style:{"min-height":"300px"},flex:"main:center cross:center"},zn=$("\u8BE5\u7EC4\u4EF6\u4E0D\u9700\u8981\u914D\u7F6E\u6570\u636E");function $n(o,t,n,e,c,l){const r=g("config-title"),i=g("source-panel"),s=g("b-empty"),d=g("b-scrollbar");return v(),x("div",Tn,[f(r,{"com-name":e.selectedCom.name,"com-alias":e.selectedCom.alias},null,8,["com-name","com-alias"]),a("div",Dn,[f(d,{native:""},{default:_(()=>[e.dataKeys.length>0?(v(),Y(i,{key:0})):(v(),x("div",Bn,[f(s,null,{default:_(()=>[zn]),_:1})]))]),_:1})])])}var Ln=W(Vn,[["render",$n]]);const Rn={class:"basic-setting-wp"},Wn={style:{width:"50%"}},In=$("\u91CD\u7F6E\u65CB\u8F6C"),Nn={__name:"basic-setting",props:{attr:{type:Object,required:!0}},emits:["update:attr"],setup(o,{emit:t}){const n=o,e=k({get:()=>n.attr,set:c=>t("update:attr",c)});return(c,l)=>{const r=g("g-input-number"),i=g("g-field"),s=g("b-button"),d=g("g-slider");return v(),x("div",Rn,[f(i,{label:"\u56FE\u8868\u5C3A\u5BF8",flat:""},{default:_(()=>[f(r,{modelValue:M(e).w,"onUpdate:modelValue":l[0]||(l[0]=u=>M(e).w=u),label:"\u5BBD\u5EA6",min:10,max:4e3,inline:"",suffix:"px"},null,8,["modelValue"]),f(r,{modelValue:M(e).h,"onUpdate:modelValue":l[1]||(l[1]=u=>M(e).h=u),label:"\u9AD8\u5EA6",min:10,max:4e3,inline:"",suffix:"px"},null,8,["modelValue"])]),_:1}),f(i,{label:"\u56FE\u8868\u4F4D\u7F6E",flat:""},{default:_(()=>[f(r,{modelValue:M(e).x,"onUpdate:modelValue":l[2]||(l[2]=u=>M(e).x=u),label:"X",inline:"",suffix:"px"},null,8,["modelValue"]),f(r,{modelValue:M(e).y,"onUpdate:modelValue":l[3]||(l[3]=u=>M(e).y=u),label:"Y",inline:"",suffix:"px"},null,8,["modelValue"])]),_:1}),f(i,{label:"\u65CB\u8F6C\u89D2\u5EA6",flat:""},{default:_(()=>[f(r,{modelValue:M(e).rotate,"onUpdate:modelValue":l[4]||(l[4]=u=>M(e).rotate=u),min:0,max:360,step:1,inline:""},null,8,["modelValue"]),a("div",Wn,[f(s,{size:"small",onClick:l[5]||(l[5]=u=>M(e).rotate=0)},{default:_(()=>[In]),_:1})])]),_:1}),f(i,{label:"\u900F\u660E\u5EA6"},{default:_(()=>[f(d,{modelValue:M(e).opacity,"onUpdate:modelValue":l[6]||(l[6]=u=>M(e).opacity=u),min:0,max:1,step:.05},null,8,["modelValue","step"])]),_:1})])}}},An={class:"setting-panel"},Un={class:"setting-panel-content"},Fn={class:"scroll-container"},Pn={__name:"index",setup(o){const{schemaStore:t,storeToRefs:n}=R(),{selectedCom:e}=n(t);return(c,l)=>{const r=g("b-scrollbar");return v(),x("div",An,[f(lt,{"com-name":M(e).name,"com-alias":M(e).alias},null,8,["com-name","com-alias"]),a("div",Un,[a("div",Fn,[f(r,null,{default:_(()=>[(v(),Y(Nn,{key:`${M(e).id}'_basic-setting`,attr:M(e).attr},null,8,["attr"])),(v(),Y(Ge(M(e).name+"Config"),{key:M(e).id,data:M(e)},null,8,["data"]))]),_:1})])])])}}},Yn={name:"config-panel",components:{PageConfig:gn,SettingPanel:Pn,DataCenterPanel:Ln},setup(){const{schemaStore:o,storeToRefs:t}=R(),{toolbar:n,selectedCom:e}=t(o),c=V(0),l=r=>{if(r===2){ue.warning("\u6682\u672A\u5F00\u653E!");return}c.value!==r&&(c.value=r)};return me(()=>e.value,()=>{c.value=0}),{toolbar:n,selectedCom:e,curTabIndex:c,changeTab:l}}},Hn={class:"config-panel"},En={key:1,class:"page-config-panel"},On={class:"page-config-top"},jn={class:"tabs-wrapper"},Xn={class:"page-config-content"},Kn={key:0,style:{height:"100%"}},Gn={key:1,style:{height:"100%"}};function qn(o,t,n,e,c,l){const r=g("page-config"),i=g("b-icon"),s=g("b-tooltip"),d=g("setting-panel"),u=g("data-center-panel");return v(),x("div",{class:B(["config-panel-wp",{"is-hide":!e.toolbar.config}])},[a("div",Hn,[e.selectedCom?(v(),x("div",En,[a("div",On,[a("div",jn,[a("div",{class:B(["tab-item",{active:e.curTabIndex===0}]),onClick:t[0]||(t[0]=h=>e.changeTab(0))},[f(s,{content:"\u914D\u7F6E"},{default:_(()=>[f(i,{name:"control",size:"20"})]),_:1})],2),a("div",{class:B(["tab-item",{active:e.curTabIndex===1}]),onClick:t[1]||(t[1]=h=>e.changeTab(1))},[f(s,{content:"\u6570\u636E"},{default:_(()=>[f(i,{name:"cloud-server",size:"22"})]),_:1})],2),a("div",{class:B(["tab-item",{active:e.curTabIndex===2}]),onClick:t[2]||(t[2]=h=>e.changeTab(2))},[f(s,{content:"\u4EA4\u4E92"},{default:_(()=>[f(i,{name:"deploymentunit",size:"18"})]),_:1})],2)])]),a("div",Xn,[e.curTabIndex===0?(v(),x("div",Kn,[(v(),Y(d,{key:e.selectedCom.id}))])):ne("",!0),e.curTabIndex===1?(v(),x("div",Gn,[(v(),Y(u,{key:e.selectedCom.id}))])):ne("",!0)])])):(v(),Y(r,{key:0}))])],2)}var Jn=W(Yn,[["render",qn]]);const Zn={class:"toolbox-panel",flex:"main:justify"},Qn={style:{width:"500px"},flex:""},el=a("i",{class:"action-btn b-iconfont b-icon-rollback"},null,-1),tl=$(" \u64A4\u9500 "),ol=a("i",{class:"action-btn b-iconfont b-icon-rollback",style:{transform:"rotateY(180deg)"}},null,-1),al=$(" \u91CD\u505A "),nl=a("div",null,null,-1),ll={class:"btn-box"},sl=$(" \u53C2\u8003\u7EBF\xA0\xA0 "),il={class:"btn-box"},rl=$(" \u5BF9\u9F50\u7EBF\xA0\xA0 "),cl={class:"ctrl-box"},dl=$(" \xA0\xA0 "),ul=$("\u6E05\u7A7A\u753B\u5E03"),ml={__name:"index",setup(o){const{schemaStore:t,storeToRefs:n}=R(),{toolbar:e,toolbox:c}=n(t),l=()=>{qe.confirm({type:"error",title:"\u786E\u8BA4\u6E05\u7A7A\u753B\u5E03\u5417\uFF1F\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01"}).then(()=>{t.clearScreen()}).catch(()=>{})},r=()=>t.undo(),i=()=>t.redo();return(s,d)=>{const u=g("b-button"),h=g("b-switch");return v(),x("div",{class:B(["toolbox-panel-wp",{"is-hide":!M(e).toolbox}])},[a("div",Zn,[a("div",Qn,[f(u,{size:"mini",onClick:r},{default:_(()=>[el,tl]),_:1}),f(u,{size:"mini",onClick:i},{default:_(()=>[ol,al]),_:1}),nl,a("div",ll,[sl,f(h,{modelValue:M(c).referLine,"onUpdate:modelValue":d[0]||(d[0]=p=>M(c).referLine=p),size:"small"},null,8,["modelValue"])]),a("div",il,[rl,f(h,{modelValue:M(c).markLine,"onUpdate:modelValue":d[1]||(d[1]=p=>M(c).markLine=p),size:"small"},null,8,["modelValue"])])]),a("div",cl,[dl,f(u,{size:"mini",icon:"clear",onClick:l},{default:_(()=>[ul]),_:1})])])],2)}}};const fl={name:"shortcut",props:{modelValue:{type:Boolean}},emits:["update:modelValue"]},hl=o=>(_e("data-v-7e8e628e"),o=o(),be(),o),pl=hl(()=>a("div",{class:"shortcut-wp"},[a("div",{class:"shortcut-box"},[a("div",{class:"key-title"},"\u57FA\u7840\u5FEB\u6377\u952E"),a("div",{class:"key-wrap"},[a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u5F00\u5173\u56FE\u5C42\u9762\u677F"),a("div",{class:"shortcut-value"},"Ctrl + \u2190")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u5F00\u5173\u914D\u7F6E\u9762\u677F"),a("div",{class:"shortcut-value"},"Ctrl + \u2192")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u5F00\u5173\u7EC4\u4EF6\u9762\u677F"),a("div",{class:"shortcut-value"},"Ctrl + \u2191")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u5F00\u5173\u5DE5\u5177\u680F"),a("div",{class:"shortcut-value"},"Ctrl + \u2193")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u590D\u5236\u9009\u4E2D\u7EC4\u4EF6"),a("div",{class:"shortcut-value"},"Ctrl + C")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u7C98\u8D34\u7EC4\u4EF6"),a("div",{class:"shortcut-value"},"Ctrl + V")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u64A4\u9500\u64CD\u4F5C"),a("div",{class:"shortcut-value"},"Ctrl + Z")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u4FDD\u5B58\u770B\u677F"),a("div",{class:"shortcut-value"},"Ctrl + S")])])]),a("div",{class:"shortcut-box"},[a("div",{class:"key-title"},"\u753B\u5E03\u64CD\u4F5C"),a("div",{class:"key-wrap"},[a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u753B\u5E03\u7F29\u653E\u6700\u4F73\u6BD4\u4F8B"),a("div",{class:"shortcut-value"},"Ctrl + A")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u753B\u5E03\u7F29\u653E\u4E3A1\uFF1A1"),a("div",{class:"shortcut-value"},"Ctrl + D")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u81EA\u7531\u7F29\u653E"),a("div",{class:"shortcut-value"},"Ctrl + \u9F20\u6807\u6EDA\u8F6E/\u6EDA\u52A8")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u79FB\u52A8\u753B\u5E03"),a("div",{class:"shortcut-value"},"Space + \u9F20\u6807\u5DE6\u952E/\u62D6\u52A8")])])]),a("div",{class:"shortcut-box"},[a("div",{class:"key-title"},"\u7EC4\u4EF6\u64CD\u4F5C"),a("div",{class:"key-wrap"},[a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u7EC4\u4EF6\u7F6E\u9876"),a("div",{class:"shortcut-value"},"Alt + Home")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u7EC4\u4EF6\u7F6E\u5E95"),a("div",{class:"shortcut-value"},"Alt + End")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u4E0A\u79FB\u4E00\u5C42"),a("div",{class:"shortcut-value"},"Alt + \u2191")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u4E0B\u79FB\u4E00\u5C42"),a("div",{class:"shortcut-value"},"Alt + \u2193")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u79FB\u52A8\u7EC4\u4EF61\u50CF\u7D20"),a("div",{class:"shortcut-value"},"\u2191 \u2193 \u2190 \u2192")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u79FB\u52A8\u7EC4\u4EF610\u50CF\u7D20"),a("div",{class:"shortcut-value"},"Shift + \u2191 \u2193 \u2190 \u2192")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u91CD\u547D\u540D"),a("div",{class:"shortcut-value"},"F2/\u53CC\u51FB\u56FE\u5C42")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u5220\u9664\u9009\u4E2D\u7EC4\u4EF6"),a("div",{class:"shortcut-value"},"Delete")])])])],-1));function gl(o,t,n,e,c,l){const r=g("b-modal");return v(),Y(r,{title:"\u5FEB\u6377\u952E\u6307\u5357","model-value":n.modelValue,"append-to-body":"","custom-class":"schema-modal",onClose:t[0]||(t[0]=i=>o.$emit("update:modelValue",!1))},{default:_(()=>[pl]),_:1},8,["model-value"])}var vl=W(fl,[["render",gl],["__scopeId","data-v-7e8e628e"]]);const _l={name:"footer-panel",components:{Shortcut:vl},setup(){const{schemaStore:o,storeToRefs:t}=R(),{pageConfig:n,canvas:e}=t(o),c=V([200,150,100,50]),l=V(20),r=V(20),i=V(!1),s=async d=>{d===-1?o.autoCanvasScale():o.setCanvasScale(d===0?l.value:d)};return me(()=>e.value.scale,d=>{const u=parseInt((d*100).toFixed(2));r.value=u,l.value=u}),{pageConfig:n,scaleList:c,inputScale:l,scale:r,submitScale:s,keycodeVisible:i}}},bl={class:"footer-panel"},yl={class:"screen-info",flex:"cross:center"},wl={class:"ml-8",style:{transform:"scale(0.9)"}},xl={flex:"cross:center"},Sl={class:"scale-input-wp"},Cl=a("span",{class:"percent"},"%",-1),kl=a("i",{class:"b-iconfont b-icon-down"},null,-1),Ml=$("\u81EA\u9002\u5E94"),Vl={class:"scale-slider-wp"};function Tl(o,t,n,e,c,l){const r=g("b-icon"),i=g("b-tooltip"),s=g("b-dropdown-item"),d=g("b-dropdown-menu"),u=g("b-dropdown"),h=g("b-slider"),p=g("shortcut");return v(),x(P,null,[a("div",bl,[a("div",yl,[f(i,{content:"\u5FEB\u6377\u952E\u63D0\u793A","open-delay":500},{default:_(()=>[f(r,{name:"read",size:"16",type:"button",onClick:t[0]||(t[0]=m=>e.keycodeVisible=!0)})]),_:1}),a("span",wl,K(e.pageConfig.width)+" \u50CF\u7D20 * "+K(e.pageConfig.height)+" \u50CF\u7D20",1)]),a("div",xl,[f(u,{trigger:"click",onCommand:e.submitScale},{dropdown:_(()=>[f(d,null,{default:_(()=>[(v(!0),x(P,null,le(e.scaleList,m=>(v(),Y(s,{key:m,name:m},{default:_(()=>[$(K(`${m}%`),1)]),_:2},1032,["name"]))),128)),f(s,{name:-1},{default:_(()=>[Ml]),_:1})]),_:1})]),default:_(()=>[a("div",Sl,[ge(a("input",{"onUpdate:modelValue":t[1]||(t[1]=m=>e.inputScale=m),type:"number",class:"scale-input",onKeydown:t[2]||(t[2]=Xe(m=>e.submitScale(0),["enter"]))},null,544),[[Be,e.inputScale]]),Cl,kl])]),_:1},8,["onCommand"]),a("div",Vl,[f(h,{modelValue:e.scale,"onUpdate:modelValue":t[3]||(t[3]=m=>e.scale=m),min:10,max:200,step:5,"show-tooltip":!1,onChange:e.submitScale},null,8,["modelValue","onChange"])])])]),f(p,{modelValue:e.keycodeVisible,"onUpdate:modelValue":t[4]||(t[4]=m=>e.keycodeVisible=m)},null,8,["modelValue"])],64)}var Dl=W(_l,[["render",Tl]]);const Bl={name:"context-menu",setup(){const{schemaStore:o,storeToRefs:t}=R(),{selectedCom:n}=t(o),{isLocked:e,isHided:c,contextMenu:l,contextMenuStyle:r}=Re(),i=w=>{n.value&&i(n.value.id)},s=()=>i(oe.up),d=()=>i(oe.down),u=()=>i(oe.top),h=()=>i(oe.bottom),p=()=>{n.value&&(n.value.locked=!n.value.locked)},m=()=>{n.value&&(n.value.hided=!n.value.hided)},y=()=>{const w=n.value;w&&qe.confirm({type:"error",title:"\u662F\u5426\u5220\u9664\u9009\u4E2D\u76841\u4E2A\u7EC4\u4EF6"}).then(()=>{o.deleteCom(w.id)}).catch(()=>{})},S=()=>{const w=n.value;w&&o.renamingCom(w.id)},b=()=>{const w=n.value;w&&o.copyCom(w.id)},T=w=>w.preventDefault();return ve(()=>{G(document,"contextmenu",T)}),ke(()=>{q(document,"contextmenu",T)}),{contextMenu:l,contextMenuStyle:r,isLocked:e,isHided:c,moveUp:s,moveDown:d,moveTop:u,moveBottom:h,toDeleteCom:y,renameCom:S,toCopyCom:b,lockCom:p,hideCom:m}}},I=o=>(_e("data-v-bdc42d38"),o=o(),be(),o),zl=I(()=>a("i",{class:"menu-icon b-iconfont b-icon-vertical-align-botto",style:{transform:"rotate(180deg)"}},null,-1)),$l=$(" \u7F6E\u9876 "),Ll=I(()=>a("span",{class:"key-code"},"Alt + Home",-1)),Rl=[zl,$l,Ll],Wl=I(()=>a("i",{class:"menu-icon b-iconfont b-icon-vertical-align-botto"},null,-1)),Il=$(" \u7F6E\u5E95 "),Nl=I(()=>a("span",{class:"key-code"},"Alt + End",-1)),Al=[Wl,Il,Nl],Ul=I(()=>a("i",{class:"menu-icon b-iconfont b-icon-arrowup"},null,-1)),Fl=$(" \u4E0A\u79FB\u4E00\u5C42 "),Pl=I(()=>a("span",{class:"key-code"},"Alt + \u2191",-1)),Yl=[Ul,Fl,Pl],Hl=I(()=>a("i",{class:"menu-icon b-iconfont b-icon-arrowdown"},null,-1)),El=$(" \u4E0B\u79FB\u4E00\u5C42 "),Ol=I(()=>a("span",{class:"key-code"},"Alt + \u2193",-1)),jl=[Hl,El,Ol],Xl=I(()=>a("div",{class:"context-menu-divider"},null,-1)),Kl=I(()=>a("i",{class:"menu-icon b-iconfont b-icon-unlock"},null,-1)),Gl=$(" \u89E3\u9501 "),ql=I(()=>a("i",{class:"menu-icon b-iconfont b-icon-lock"},null,-1)),Jl=$(" \u9501\u5B9A "),Zl=I(()=>a("i",{class:"menu-icon b-iconfont b-icon-eye"},null,-1)),Ql=$(" \u663E\u793A "),es=I(()=>a("i",{class:"menu-icon b-iconfont b-icon-eye-close"},null,-1)),ts=$(" \u9690\u85CF "),os=I(()=>a("div",{class:"context-menu-divider"},null,-1)),as=I(()=>a("i",{class:"menu-icon b-iconfont b-icon-edit"},null,-1)),ns=$(" \u91CD\u547D\u540D "),ls=I(()=>a("span",{class:"key-code"},"F2",-1)),ss=[as,ns,ls],is=I(()=>a("i",{class:"menu-icon b-iconfont b-icon-file-copy"},null,-1)),rs=$(" \u590D\u5236 "),cs=I(()=>a("span",{class:"key-code"},"Ctrl + C,V",-1)),ds=[is,rs,cs],us=I(()=>a("i",{class:"menu-icon b-iconfont b-icon-delete"},null,-1)),ms=$(" \u5220\u9664 "),fs=I(()=>a("span",{class:"key-code"},"Delete",-1)),hs=[us,ms,fs];function ps(o,t,n,e,c,l){return v(),Y(_t,{name:"zoom-in-top"},{default:_(()=>[e.contextMenu.show?(v(),x("div",{key:0,class:"context-menu-wrap",style:L(e.contextMenuStyle)},[a("div",{class:"context-menu-item",onClick:t[0]||(t[0]=(...r)=>e.moveTop&&e.moveTop(...r))},Rl),a("div",{class:"context-menu-item",onClick:t[1]||(t[1]=(...r)=>e.moveBottom&&e.moveBottom(...r))},Al),a("div",{class:"context-menu-item",onClick:t[2]||(t[2]=(...r)=>e.moveUp&&e.moveUp(...r))},Yl),a("div",{class:"context-menu-item",onClick:t[3]||(t[3]=(...r)=>e.moveDown&&e.moveDown(...r))},jl),Xl,a("div",{class:"context-menu-item",onClick:t[4]||(t[4]=(...r)=>e.lockCom&&e.lockCom(...r))},[e.isLocked?(v(),x(P,{key:0},[Kl,Gl],64)):(v(),x(P,{key:1},[ql,Jl],64))]),a("div",{class:"context-menu-item",onClick:t[5]||(t[5]=(...r)=>e.hideCom&&e.hideCom(...r))},[e.isHided?(v(),x(P,{key:0},[Zl,Ql],64)):(v(),x(P,{key:1},[es,ts],64))]),os,a("div",{class:"context-menu-item",onClick:t[6]||(t[6]=(...r)=>e.renameCom&&e.renameCom(...r))},ss),a("div",{class:"context-menu-item",onClick:t[7]||(t[7]=(...r)=>e.toCopyCom&&e.toCopyCom(...r))},ds),a("div",{class:"context-menu-item",onClick:t[8]||(t[8]=(...r)=>e.toDeleteCom&&e.toDeleteCom(...r))},hs)],4)):ne("",!0)]),_:1})}var gs=W(Bl,[["render",ps],["__scopeId","data-v-bdc42d38"]]);function vs(){const o=Te(),{schemaStore:t}=R(),n=V(!1),e=async l=>{try{n.value=!0;const r=await zt(l);if(r){const{id:i,name:s,pid:d,layout:u,components:h}=r,p={pageInfo:{id:i,name:s,pid:d},pageConfig:JSON.parse(u),comps:h.map(m=>JSON.parse(m.componentContent))};t.loadScreenData(p),await Se(),document.title=s}}catch(r){console.log(r)}n.value=!1},c=async()=>{try{n.value=!0;const l=await Lt();if(l.tpl.length>0){const r=await Nt(l.tpl);if(r){const i=JSON.parse(r.content),{comps:s,pageConfig:d}=i;t.loadScreenData({comps:s,pageConfig:d})}}else t.setScreenSize(l)}catch(l){console.log(l)}n.value=!1};return me(()=>o.path,async()=>{const{id:l}=o.query;l?await e(l):await c()},{immediate:!0}),{loading:n}}function _s(){const o=V(null),t=V(null),{schemaStore:n,storeToRefs:e}=R(),{canvas:c,selectedCom:l}=e(n);let r=null;const i=h=>{const p=h.target;if(!["input","textarea"].includes(p.tagName.toLowerCase())){const m=h.key.toLowerCase();m==="delete"?(t.value&&t.value.toDeleteCom(),h.preventDefault()):m==="f2"&&(t.value&&t.value.renameCom(),h.preventDefault());const y=l.value;h.altKey&&(s("altKey"),m==="arrowup"?t.value&&t.value.moveUp():m==="arrowdown"?t.value&&t.value.moveDown():m==="home"?t.value&&t.value.moveTop():m==="end"&&t.value&&t.value.moveBottom(),h.preventDefault()),h.ctrlKey&&(s("ctrlKey"),m==="arrowup"?(n.toggleCompsPanel(),h.preventDefault()):m==="arrowdown"?(n.toggleToolbox(),h.preventDefault()):m==="arrowleft"?(n.toggleLayerPanel(),h.preventDefault()):m==="arrowright"?(n.toggleConfigPanel(),h.preventDefault()):m==="a"?(n.autoCanvasScale(),h.preventDefault()):m==="d"?(n.setCanvasScale(100),h.preventDefault()):m==="c"?(r=l.value,h.preventDefault()):m==="v"?(r&&n.copyCom(r.id),h.preventDefault()):m==="s"?(o.value&&o.value.handleSaveScreen(),h.preventDefault()):m==="z"&&(n.undo(),h.preventDefault())),h.shiftKey&&s("shiftKey"),h.keyCode===32&&(s("spaceKey"),h.preventDefault());const S=h.shiftKey?10:1;y&&(m==="arrowleft"?(y.attr.x-=S,h.preventDefault()):m==="arrowright"?(y.attr.x+=S,h.preventDefault()):m==="arrowup"?(y.attr.y-=S,h.preventDefault()):m==="arrowdown"&&(y.attr.y+=S,h.preventDefault()))}},s=h=>{n.toggleKey({key:h,status:!0})},d=()=>{n.resetKeyCode()},u=h=>{const p=parseInt((c.value.scale*100).toFixed(2)),m=(h.wheelDelta>0?1:-1)*5,y=Math.min(Math.max(p+m,20),200);n.setCanvasScale(y)};return ve(()=>{G(document,"keydown",i),G(document,"keyup",d)}),ke(()=>{q(document,"keydown",i),q(document,"keyup",d)}),{headerRef:o,contextMenuRef:t,ctrlMouseWheel:u}}const bs={name:"ScreenEditor",components:{ContextMenu:gs,FooterPanel:Dl,ToolboxPanel:ml,CanvasMain:ln,ConfigPanel:Jn,ComponentsPanel:Sa,LayerPanel:Mo,HeaderBar:co},setup(){return Q(Q({},vs()),_s())}},ys={key:0,flex:"main:center cross:center",class:"full-wrapper"},ws={key:1,class:"editor-main-wrapper"},xs={class:"edit-main-wp"};function Ss(o,t,n,e,c,l){const r=g("header-bar"),i=g("svg-loading"),s=g("components-panel"),d=g("layer-panel"),u=g("toolbox-panel"),h=g("canvas-main"),p=g("footer-panel"),m=g("config-panel"),y=g("context-menu");return v(),x("div",{class:"schema-screen-container",onWheel:t[0]||(t[0]=ee((...S)=>o.ctrlMouseWheel&&o.ctrlMouseWheel(...S),["ctrl","prevent"]))},[f(r,{ref:"headerRef","back-url":"/dashboard"},null,512),o.loading?(v(),x("div",ys,[f(i,{name:"loading02"})])):(v(),x("div",ws,[f(s),f(d),a("div",xs,[f(u),f(h),f(p)]),f(m)])),f(y,{ref:"contextMenuRef"},null,512)],32)}var Rs=W(bs,[["render",Ss]]);export{Rs as default};
