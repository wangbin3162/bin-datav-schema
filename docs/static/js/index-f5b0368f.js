import{d as j,g as q,u as H,a as L}from"./images.api-1928ae0c.js";import{ax as S,l as z,m,H as v,O as M,o as t,f as B,w as x,b as p,c as y,a as s,F as V,P as R,g as U,t as O,a1 as w,j as C,k as P,a3 as T}from"./vendor-302fa4a4.js";import"./index-435da3e0.js";import"./chunk-bin-ui-next-e3768e6e.js";import"./chunk-brace-b1f520b9.js";const J={class:"images-modal-wrap"},Q={class:"group-wrap"},W=["onClick"],X={class:"img-wrap"},Y={key:0,class:"comp-item img-add"},Z=["onClick"],ee={__name:"image-select",props:{modelValue:{type:String,default:""},ignoreGroupKeys:{type:Array,default:()=>[]}},emits:["update:modelValue","change","resize"],setup(u,{expose:_,emit:f}){const l=u,h=z({get:()=>l.modelValue,set:e=>f("update:modelValue",e)}),r=m(!1),g=m([]),n=m(""),c=m([]),d=m(!1),b=z(()=>!j.includes(n.value));q().then(e=>{g.value=e.filter(a=>!l.ignoreGroupKeys.includes(a.key))});async function k(e){try{d.value=!0,c.value=await L(e)}catch(a){console.log(a)}d.value=!1}function $(e){n.value=e,k(e)}function G(e){h.value=e.src,f("change",e),r.value=!1}async function K(e){try{const a=e.map(i=>({group:n.value,name:i.name,attr:{w:i.width,h:i.height},src:i.image}));await H(a),G(a[0])}catch(a){console.log(a)}}function D(){var e;r.value=!0,n.value=(e=g.value[0])==null?void 0:e.key,k(n.value)}return _({open:D}),(e,a)=>{const i=v("b-scrollbar"),N=v("g-upload"),A=v("g-loading"),E=v("b-modal"),F=M("lazy");return t(),B(E,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=o=>r.value=o),title:"\u9009\u62E9\u56FE\u7247","append-to-body":"",top:"60px",width:"720px","custom-class":"schema-modal"},{default:x(()=>[p("div",J,[p("div",Q,[y(i,{native:""},{default:x(()=>[(t(!0),s(V,null,R(g.value,o=>(t(),s("div",{key:o.key,class:U(["group-item t-ellipsis",{active:n.value===o.key}]),onClick:I=>$(o.key)},O(o.value),11,W))),128))]),_:1})]),p("div",X,[y(i,{native:""},{default:x(()=>[d.value?(t(),B(A,{key:1,spinning:"",type:"square"})):(t(),s(V,{key:0},[w(b)?(t(),s("div",Y,[y(N,{onUpload:K})])):C("",!0),(t(!0),s(V,null,R(c.value,(o,I)=>(t(),s("div",{class:"comp-item",key:I,onClick:ne=>G(o)},[P(p("img",null,null,512),[[F,o.src]])],8,Z))),128))],64))]),_:1})])])]),_:1},8,["modelValue"])}}};var ae=S(ee,[["__scopeId","data-v-2cfb266c"]]);const te={class:"dv-gui g-select-image-wrap"},oe=["src"],se={key:0,class:"g-resize"},le={__name:"index",props:{modelValue:{type:String,default:""},showResize:{type:Boolean,default:!0},ignoreGroupKeys:{type:Array,default:()=>[]}},emits:["update:modelValue","change","resize"],setup(u,{emit:_}){const f=u,l=z({get:()=>f.modelValue,set:c=>_("update:modelValue",c)}),h=m(null);function r(){h.value.open()}function g(c){_("change",c)}function n(){_("resize")}return(c,d)=>{const b=v("b-icon");return t(),s(V,null,[p("div",te,[p("div",{class:U(["g-img",{resize:u.showResize}]),onClick:r},[w(l)?(t(),s("img",{key:0,src:w(l)},null,8,oe)):C("",!0)],2),u.showResize?(t(),s("div",se,[y(b,{name:"undo",type:"button",title:"\u6062\u590D\u9ED8\u8BA4\u56FE\u7247\u5C3A\u5BF8",onClick:n})])):C("",!0)]),y(ae,{ref_key:"modalRef",ref:h,"ignore-group-keys":u.ignoreGroupKeys,modelValue:w(l),"onUpdate:modelValue":d[0]||(d[0]=k=>T(l)?l.value=k:null),onChange:g},null,8,["ignore-group-keys","modelValue"])],64)}}};var me=S(le,[["__scopeId","data-v-8c526678"]]);export{me as default};
