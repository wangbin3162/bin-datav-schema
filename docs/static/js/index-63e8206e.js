var st=Object.defineProperty,it=Object.defineProperties;var ct=Object.getOwnPropertyDescriptors;var ze=Object.getOwnPropertySymbols;var rt=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;var Le=(o,t,n)=>t in o?st(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,K=(o,t)=>{for(var n in t||(t={}))rt.call(t,n)&&Le(o,n,t[n]);if(ze)for(var n of ze(t))dt.call(t,n)&&Le(o,n,t[n]);return o},ke=(o,t)=>it(o,ct(t));import{s as ut,l as mt,S as ft}from"./template.api-6c2d59da.js";import{as as R,a6 as Ve,g as S,o as _,A as w,D as B,aC as Fe,a5 as He,f as D,n as de,x as ye,J as v,c as P,w as b,u as m,F as H,a as ne,B as a,q as T,t as q,y as De,d as pe,Y as Be,L as Pe,E as L,K as le,H as Ee,$ as ht,j as ge,Q as pt,az as ve,aA as _e,aD as gt,k as Ce,z as vt,r as je,I as Z,X as _t,a1 as Q,G as bt,O as Oe,T as yt}from"./vendor-95729a87.js";import{u as N}from"./useSchemaStore-f69e9a12.js";import{i as wt,t as Xe,x as xt,q as Me,y as G,z as J,M as oe,A as E,C as O,a as Te,B as we,D as ae,g as Ct,E as St,u as kt,F as Ke,G as qe,H as Mt,I as Ge,f as Vt,w as Dt,j as Bt,J as Tt,K as $t,_ as zt,l as Lt}from"./index-e100dc50.js";import{M as re,a as Je}from"./chunk-bin-ui-next-c6363b96.js";import{d as It,a as Rt}from"./file-helper-94af9014.js";import{b as Wt}from"./config-b7549c7b.js";import{b as Nt}from"./config-28bd3680.js";import{g as Ze,a as At}from"./database.api-ac0587f8.js";import"./chunk-brace-269ffce0.js";const Ut={name:"HeadLoading",setup(){const o=Ve();return{loading:S(()=>o.state.schema.toolbar.loading)}}};function Yt(o,t,n,e,r,s){return _(),w("div",{class:B(["loading-indicator",{loading:e.loading}])},null,2)}var Ft=R(Ut,[["render",Yt],["__scopeId","data-v-5de99d01"]]);const Ht={name:"save-screen",props:{modelValue:{type:Boolean},status:{type:String,default:"edit",validator:o=>["edit","audited"].includes(o)}},emits:["update:modelValue"],setup(o,t){const{pageInfo:n,saveScreenData:e}=N(),r=Fe(),s=He(),i=D([]),l=D(null),c=D(!1),d=S(()=>`${window.location.origin}/#/screen/${s.query.id}`);wt().then(g=>{i.value=g.data?[g.data]:[]});const u=S(()=>o.status==="edit"?"\u4FDD\u5B58\u770B\u677F":"\u53D1\u5E03\u770B\u677F"),h=()=>{t.emit("update:modelValue",!1)},p=()=>{l.value&&l.value.validate(async g=>{if(g){let C="";try{c.value=!0,C=await e(o.status)}catch(k){Xe("save-screes/saveKanban",k)}c.value=!1,h(),setTimeout(()=>{if(C&&(re.success({message:"\u4FDD\u5B58\u6210\u529F\uFF01",showClose:!0}),!n.value.id)){let x=r.resolve({path:"/schema/screen",query:{id:C}});window.location.replace(x.href)}},300)}})},f=()=>{ye(()=>{xt(d.value)&&re.success("\u590D\u5236\u53D1\u5E03\u5730\u5740\u6210\u529F!")})};return de(()=>o.modelValue,g=>{g&&ye(()=>{l.value&&l.value.resetFields()})}),{formRef:l,pageInfo:n,dirTree:i,loading:c,closeDialog:h,saveKanban:p,btnText:u,shareUrl:d,copyUrl:f}}},Pt=T("\u590D\u5236\u9884\u89C8\u5730\u5740"),Et={class:"t-center"};function jt(o,t,n,e,r,s){const i=v("b-input"),l=v("b-form-item"),c=v("g-input"),d=v("b-button"),u=v("b-form"),h=v("b-modal");return _(),P(h,{modelValue:n.modelValue,"onUpdate:modelValue":t[2]||(t[2]=p=>n.modelValue=p),"append-to-body":"",title:e.btnText,top:"200px","custom-class":"schema-modal",onClose:e.closeDialog},{default:b(()=>[m(u,{"label-width":"80px",ref:"formRef",model:e.pageInfo,"label-suffix":":"},{default:b(()=>[m(l,{label:"\u770B\u677F\u540D\u79F0",prop:"name",rules:{required:!0,message:"\u770B\u677F\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:b(()=>[m(i,{modelValue:e.pageInfo.name,"onUpdate:modelValue":t[0]||(t[0]=p=>e.pageInfo.name=p)},null,8,["modelValue"])]),_:1}),n.status==="audited"&&o.$route.query.id?(_(),w(H,{key:0},[m(l,{label:"\u9884\u89C8\u5730\u5740"},{default:b(()=>[m(c,{modelValue:e.shareUrl,"onUpdate:modelValue":t[1]||(t[1]=p=>e.shareUrl=p),readonly:"",type:"textarea",autosize:{minRows:3}},null,8,["modelValue"])]),_:1}),m(l,null,{default:b(()=>[m(d,{type:"text",onClick:e.copyUrl},{default:b(()=>[Pt]),_:1},8,["onClick"])]),_:1})],64)):ne("",!0)]),_:1},8,["model"]),a("div",Et,[m(d,{type:"primary",onClick:e.saveKanban,loading:e.loading,style:{width:"200px"}},{default:b(()=>[T(q(e.btnText),1)]),_:1},8,["onClick","loading"])])]),_:1},8,["modelValue","title","onClose"])}var Ot=R(Ht,[["render",jt]]);const Xt={name:"save-template",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(o,t){const{pageConfig:n,comps:e}=N(),r=D(null),s=De({loading:!1,id:`temp_${Me()}`,name:""}),i=S(()=>({template:{id:s.id,name:s.name},pageConfig:n.value,comps:e.value})),l=()=>{t.emit("update:modelValue",!1)},c=()=>{r.value&&r.value.validate(async u=>{if(u){const h=i.value,p=JSON.stringify(h);It(p,`${h.template.id}.json`),re.success({message:"\u6A21\u677F\u6587\u4EF6\u5DF2\u4FDD\u5B58\uFF01",showClose:!0})}})},d=async()=>{r.value&&r.value.validate(async u=>{if(u){try{s.loading=!0;const h=i.value,p=h.template.name,f=JSON.stringify(h);await ut({name:p,content:f})}catch(h){Xe("save-template/saveAsTemplate",h)}s.loading=!1,l(),re.success({message:"\u6A21\u677F\u5DF2\u4FDD\u5B58\uFF01",showClose:!0})}})};return de(()=>o.modelValue,u=>{u&&(r.value&&r.value.resetFields(),s.id=`temp_${Me()}`)}),{formRef:r,formStatus:s,closeDialog:l,downloadCfg:c,saveAsTemplate:d}}},Kt={class:"t-center"},qt=T("\u914D\u7F6E\u6587\u4EF6 "),Gt=T("\u4FDD\u5B58\u6A21\u677F ");function Jt(o,t,n,e,r,s){const i=v("b-input"),l=v("b-form-item"),c=v("b-form"),d=v("b-button"),u=v("b-modal");return _(),P(u,{modelValue:n.modelValue,"onUpdate:modelValue":t[1]||(t[1]=h=>n.modelValue=h),"append-to-body":"",title:"\u4FDD\u5B58\u4E3A\u6A21\u677F",top:"200px","custom-class":"schema-modal",onClose:e.closeDialog},{default:b(()=>[m(c,{"label-width":"80px",ref:"formRef",model:e.formStatus,"label-suffix":":"},{default:b(()=>[m(l,{label:"\u6A21\u677F\u540D\u79F0",prop:"name",rules:{required:!0,message:"\u6A21\u677F\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:b(()=>[m(i,{modelValue:e.formStatus.name,"onUpdate:modelValue":t[0]||(t[0]=h=>e.formStatus.name=h)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),a("div",Kt,[m(d,{type:"primary",icon:"vertical-align-botto",transparent:"",style:{width:"120px"},onClick:e.downloadCfg},{default:b(()=>[qt]),_:1},8,["onClick"]),m(d,{type:"primary",icon:"save",style:{width:"120px"},loading:e.formStatus.loading,onClick:e.saveAsTemplate},{default:b(()=>[Gt]),_:1},8,["loading","onClick"])])]),_:1},8,["modelValue","onClose"])}var Zt=R(Xt,[["render",Jt]]);const Qt={name:"header-bar",components:{SaveTemplate:Zt,SaveScreen:Ot,HeadLoading:Ft},props:{backUrl:{type:String},backTarget:{type:String,default:"_blank",validator:o=>["_self","_blank"].includes(o)},pageStatus:{type:Object,default:()=>({})}},setup(o){const t=Fe(),n=N(),e=D(!1),r=D("edit"),s=D(!1),i=()=>{const h=o.backUrl||"/";if(o.backTarget==="_blank"){const p=t.resolve(h);window.open(p.href,o.backTarget)}else t.push(h)},l=h=>h.type!=="application/json"?(re.warning("\u8BF7\u9009\u62E9\u6B63\u786E\u7684json\u914D\u7F6E\u6587\u4EF6"),!1):(Rt(h).then(p=>{try{const f=JSON.parse(p),{comps:g,pageConfig:C}=f;n.loadScreenData({comps:g,pageConfig:C})}catch{console.warn("The imported file could not be converted to the correct JSON!")}}),!1),c=()=>{r.value="edit",e.value=!0},d=()=>{r.value="audited",e.value=!0},u=async()=>{const h=await n.previewScreen();let p=t.resolve({path:`/screen/preview/${h.pageInfo.id}`});window.open(p.href,"_blank")};return ke(K({},n),{saveVisible:e,saveStatus:r,tempVisible:s,handleBack:i,handleSaveScreen:c,handPreview:u,handlePublish:d,handleUpload:l})}},eo={class:"header-container"},to={class:"left-actions"},oo={class:"screen-info"},ao=a("span",null,"\u5206\u6790\u770B\u677F",-1),no=a("span",{style:{padding:"0 6px 0 12px"}},"-",-1),lo={class:"global-actions"},so={class:"head-btn"};function io(o,t,n,e,r,s){const i=v("b-icon"),l=v("b-tooltip"),c=v("b-space"),d=v("b-upload"),u=v("head-loading"),h=v("save-screen"),p=v("save-template");return _(),w(H,null,[a("div",eo,[a("div",to,[m(c,{size:"mini"},{default:b(()=>[m(l,{content:"\u7EC4\u4EF6","open-delay":500},{default:b(()=>[a("div",{class:B(["head-btn",{active:o.toolbar.components}]),onClick:t[0]||(t[0]=f=>o.toggleCompsPanel())},[m(i,{name:"hourglass",class:B(["com-list-icon",{"is-rotate":!o.toolbar.components}])},null,8,["class"])],2)]),_:1}),m(l,{content:"\u56FE\u5C42","open-delay":500},{default:b(()=>[a("div",{class:B(["head-btn",{active:o.toolbar.layer}]),onClick:t[1]||(t[1]=f=>o.toggleLayerPanel())},[m(i,{name:"container"})],2)]),_:1}),m(l,{content:"\u53F3\u4FA7\u9762\u677F","open-delay":500},{default:b(()=>[a("div",{class:B(["head-btn",{active:o.toolbar.config}]),onClick:t[2]||(t[2]=f=>o.toggleConfigPanel())},[m(i,{name:"control"})],2)]),_:1}),m(l,{content:"\u5DE5\u5177\u7BB1","open-delay":500},{default:b(()=>[a("div",{class:B(["head-btn",{active:o.toolbar.toolbox}]),onClick:t[3]||(t[3]=f=>o.toggleToolbox())},[m(i,{name:"shopping"})],2)]),_:1})]),_:1})]),a("div",oo,[m(l,{content:"\u8FD4\u56DE","open-delay":500},{default:b(()=>[m(i,{name:"laptop",type:"button",onClick:e.handleBack},null,8,["onClick"])]),_:1}),ao,no,pe(a("input",{class:"header-input",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",maxlength:"50",type:"text","onUpdate:modelValue":t[4]||(t[4]=f=>o.pageInfo.name=f)},null,512),[[Be,o.pageInfo.name]])]),a("div",lo,[m(c,{size:"mini"},{default:b(()=>[m(l,{content:"\u5BFC\u5165json (\u4F1A\u8986\u76D6\u6240\u6709\u5185\u5BB9\uFF01)","open-delay":500},{default:b(()=>[m(d,{action:"/","show-upload-list":!1,"before-upload":e.handleUpload},{default:b(()=>[a("div",so,[m(i,{name:"Import"})])]),_:1},8,["before-upload"])]),_:1}),m(l,{content:"\u4FDD\u5B58\u6A21\u677F","open-delay":500},{default:b(()=>[a("div",{class:"head-btn",onClick:t[5]||(t[5]=f=>e.tempVisible=!0)},[m(i,{name:"Storedprocedure"})])]),_:1}),m(l,{content:"\u4FDD\u5B58","open-delay":500},{default:b(()=>[a("div",{class:"head-btn",onClick:t[6]||(t[6]=(...f)=>e.handleSaveScreen&&e.handleSaveScreen(...f))},[m(i,{name:"save"})])]),_:1}),m(l,{content:"\u53D1\u5E03","open-delay":500},{default:b(()=>[a("div",{class:"head-btn",onClick:t[7]||(t[7]=(...f)=>e.handlePublish&&e.handlePublish(...f))},[m(i,{name:"send"})])]),_:1}),m(l,{content:"\u9884\u89C8","open-delay":500},{default:b(()=>[a("div",{class:"head-btn",onClick:t[8]||(t[8]=(...f)=>e.handPreview&&e.handPreview(...f))},[m(i,{name:"View"})])]),_:1})]),_:1})])]),m(u),m(h,{modelValue:e.saveVisible,"onUpdate:modelValue":t[9]||(t[9]=f=>e.saveVisible=f),status:e.saveStatus},null,8,["modelValue","status"]),m(p,{modelValue:e.tempVisible,"onUpdate:modelValue":t[10]||(t[10]=f=>e.tempVisible=f)},null,8,["modelValue"])],64)}var co=R(Qt,[["render",io]]);const he=De({x:0,y:0});function $e(o={}){const t=Ve(),n=S(()=>t.state.schema),e=S(()=>n.value.contextMenuInfo),r=S(()=>n.value.selectedCom),s=S(()=>{var p;return(p=r.value)==null?void 0:p.locked}),i=S(()=>{var p;return(p=r.value)==null?void 0:p.hided}),l=S(()=>n.value.renamingId),c=S(()=>({display:e.value.show?"block":"none",left:`${he.x+10}px`,top:`${he.y+10}px`,transform:document.documentElement.clientHeight-he.y<250?"translate(0px, -100%)":""})),d=p=>{p.preventDefault(),r.value&&(he.x=p.clientX,he.y=p.clientY,e.value.show=!0,G(document,"click",u))},u=()=>{J(document,"click",u),o&&o.beforeClose&&o.beforeClose(),e.value.show=!1};return{contextMenu:e,showMenu:d,renamingId:l,renamingCom:p=>{t.dispatch("schema/renamingCom",p)},selectedCom:r,isLocked:s,isHided:i,contextMenuStyle:c}}const ro={name:"layer-panel",setup(){const{toolbar:o,toggleLayerPanel:t,comps:n,selectedCom:e,hoveredCom:r,onCompHovered:s,onCompSelected:i,onCompMoved:l}=N(),{showMenu:c,renamingId:d,renamingCom:u}=$e(),h=S(()=>!!e.value),p=S(()=>({opacity:e.value?1:.3})),f=S(()=>{var V;return{enable:!!e.value,checked:(V=e.value)==null?void 0:V.locked}}),g=S(()=>{var V;return{enable:!!e.value,checked:(V=e.value)==null?void 0:V.hided}}),C=S(()=>[...n.value].reverse()),k=V=>{e.value&&l(e.value.id,V)};return{comps:n,toolbar:o,toggleLayerPanel:t,enableBtnClass:h,enableBtnStyle:p,moveUp:()=>k(oe.up),moveDown:()=>k(oe.down),moveTop:()=>k(oe.top),moveBottom:()=>k(oe.bottom),descComs:C,enableLockBtnClass:f,enableHideBtnClass:g,onEnter:V=>{s(V)},onLeave:()=>{s("")},selectCom:V=>{const U=n.value.find(X=>X.id===V);U&&i(U)},hoveredCom:r,selectedCom:e,showMenu:c,cancelSelectCom:()=>{i()},renamingId:d,renamingCom:u}}},uo={class:"layer-panel"},mo={class:"layer-top"},fo=a("div",{class:"layer-num pl-10"},"\u56FE\u5C42",-1),ho=a("i",{class:"b-iconfont b-icon-left",title:"\u6536\u8D77"},null,-1),po=[ho],go={class:"layer-toolbar layer-toolbar-top"},vo={class:"layer-manager-wrap"},_o=["title","onMousedown","onMouseenter","onDblclick"],bo=["onUpdate:modelValue"],yo={key:1,class:"layer-item-span"},wo={class:"layer-item-text"},xo=["title","onClick"],Co=["title","onClick"];function So(o,t,n,e,r,s){const i=v("b-icon"),l=Pe("focus");return _(),w("div",{class:B(["layer-panel-wp",{"is-hide":!e.toolbar.layer}])},[a("div",uo,[a("div",mo,[fo,a("div",{class:"layer-action",onClick:t[0]||(t[0]=c=>e.toggleLayerPanel(!1))},po)]),a("div",go,[a("i",{title:"\u4E0A\u79FB\u4E00\u5C42",class:B(["b-iconfont b-icon-arrowup toolbar-icon standard",e.enableBtnClass]),style:L(e.enableBtnStyle),onClick:t[1]||(t[1]=(...c)=>e.moveUp&&e.moveUp(...c))},null,6),a("i",{title:"\u4E0B\u79FB\u4E00\u5C42",class:B(["b-iconfont b-icon-arrowdown toolbar-icon standard",e.enableBtnClass]),style:L(e.enableBtnStyle),onClick:t[2]||(t[2]=(...c)=>e.moveDown&&e.moveDown(...c))},null,6),a("i",{title:"\u7F6E\u9876",class:B(["b-iconfont b-icon-vertical-align-botto toolbar-icon standard",e.enableBtnClass]),style:L(K({transform:"rotate(180deg)"},e.enableBtnStyle)),onClick:t[3]||(t[3]=(...c)=>e.moveTop&&e.moveTop(...c))},null,6),a("i",{title:"\u7F6E\u5E95",class:B(["b-iconfont b-icon-vertical-align-botto toolbar-icon standard",e.enableBtnClass]),style:L(e.enableBtnStyle),onClick:t[4]||(t[4]=(...c)=>e.moveBottom&&e.moveBottom(...c))},null,6)]),a("div",vo,[(_(!0),w(H,null,le(e.descComs,c=>(_(),w("div",{key:c.id,title:c.alias,class:B(["layer-manager-item",[{hided:c.hided,locked:c.locked,hovered:c.id===e.hoveredCom,selected:e.selectedCom&&c.id===e.selectedCom.id}]]),onMousedown:d=>e.selectCom(c.id),onMouseenter:d=>e.onEnter(c.id),onMouseleave:t[7]||(t[7]=(...d)=>e.onLeave&&e.onLeave(...d)),onDblclick:d=>e.renamingCom(c.id),onContextmenu:t[8]||(t[8]=d=>e.showMenu(d))},[m(i,{name:c.icon,size:"18"},null,8,["name"]),c.id===e.renamingId?pe((_(),w("input",{key:0,"onUpdate:modelValue":d=>c.alias=d,class:"layer-item-input",onBlur:t[5]||(t[5]=d=>e.renamingCom("")),onKeydown:t[6]||(t[6]=Ee(d=>e.renamingCom(""),["enter"]))},null,40,bo)),[[Be,c.alias,void 0,{trim:!0}],[l]]):(_(),w("span",yo,[a("span",wo,q(c.alias),1)])),a("i",{class:B(["b-iconfont",`b-icon-${c.hided?"eye-close":"eye"}`,"show-toggle-btn"]),title:c.hided?"\u663E\u793A":"\u9690\u85CF",onClick:d=>c.hided=!c.hided},null,10,xo),a("i",{class:B(["b-iconfont",`b-icon-${c.locked?"lock":"unlock"}`,"show-toggle-btn"]),title:c.locked?"\u89E3\u9501":"\u9501\u5B9A",onClick:d=>c.locked=!c.locked},null,10,Co)],42,_o))),128)),a("div",{class:"last-flex-item",onClick:t[9]||(t[9]=(...c)=>e.cancelSelectCom&&e.cancelSelectCom(...c))})])])],2)}var ko=R(ro,[["render",So]]);const Mo={name:"VBasicBar",alias:"\u57FA\u672C\u67F1\u56FE",img:E("basic-bar.jpg"),type:"bar",used:!0},Vo={name:"VHorizontalBar",alias:"\u57FA\u672C\u6761\u5F62\u56FE",img:E("hori-basic-bar.jpg"),type:"bar",used:!0},Do={name:"VBasicLine",alias:"\u57FA\u672C\u6298\u7EBF\u56FE",img:E("basic-line.jpg"),type:"line",used:!0},Bo={name:"VBasicArea",alias:"\u57FA\u672C\u533A\u57DF\u56FE",img:E("basic-area.jpg"),type:"line",used:!0},To={name:"VBasicPie",alias:"\u57FA\u672C\u997C\u56FE",img:E("basic-pie.jpg"),type:"pie",used:!0},$o={name:"VBasicRing",alias:"\u57FA\u672C\u73AF\u56FE",img:E("basic-ring.jpg"),type:"pie",used:!0},zo={name:"VBasicRadar",alias:"\u57FA\u672C\u96F7\u8FBE\u56FE",img:E("basic-radar.jpg"),type:"map",used:!0},Lo={name:"VMainTitle",alias:"\u901A\u7528\u6807\u9898",img:E("main-title.png"),type:"info",used:!0},Io={name:"VNumberTitleFlop",alias:"\u6570\u5B57\u6307\u6807",img:E("number-title-flop.png"),type:"info",used:!0},Ro={name:"VTimer",alias:"\u65F6\u95F4\u5668",img:E("timer.png"),type:"info",used:!0},Wo={name:"VBgBox",alias:"\u80CC\u666F\u5757",img:E("bg-box.png"),type:"media",used:!0},No={name:"VBorderBox",alias:"\u8FB9\u6846",img:E("border-box.png"),type:"media",used:!0},Ao={name:"VDecoration",alias:"\u88C5\u9970\u5668",img:E("decoration.png"),type:"media",used:!0},Uo={name:"VMainImg",alias:"\u5355\u5F20\u56FE\u7247",img:E("img.png"),type:"media",used:!0},Yo={name:"VScrollTable",alias:"\u57FA\u7840\u8868\u683C",img:E("scroll-table.jpg"),type:"table",used:!0},xe=[{type:"bar",name:"\u67F1\u56FE",icon:"barchart",data:[Mo,Vo]},{type:"line",name:"\u7EBF\u56FE",icon:"linechart",data:[Do,Bo]},{type:"pie",name:"\u997C\u56FE",icon:"piechart",data:[To,$o]},{type:"radar",name:"\u96F7\u8FBE\u56FE",icon:"radarchart",data:[zo]},{type:"table",name:"\u8868\u683C",icon:"table",data:[Yo]},{type:"info",name:"\u4FE1\u606F",icon:"info-circle",data:[Lo,Io,Ro]},{type:"media",name:"\u5A92\u4F53",icon:"Youtube",data:[Wo,No,Ao,Uo]}];function Fo(o){for(let t=0;t<xe.length;t++){const n=xe[t];for(let e=0;e<n.data.length;e++){const r=n.data[e];if(r.name===o)return{classification:n,com:r}}}return null}const Qe=()=>Te.map(o=>({color:{type:"solid",value:o,from:we.alpha(o,.8),to:we.alpha(o,.2)}})),Ho={alias:"\u57FA\u672C\u67F1\u56FE",icon:"barchart",type:O.com,componentType:"bar",attr:{w:500,h:300},config:{global:{fontFamily:"Microsoft Yahei",margin:{top:40,bottom:50,left:50,right:10},innerPadding:20,outerPadding:30,barWidth:"auto",borderRadius:0,background:{show:!0,color:"rgba(255, 255, 255, 0.1)"}},label:{show:!1,position:"top",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"},offsetX:0,offsetY:0},legend:{show:!0,position:"top-center",orient:"horizontal",textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"},symbol:{show:!0,icon:"auto",width:25,height:14,gap:10}},xAxis:{show:!0,type:"category",boundaryGap:!0,title:{show:!0,name:"X\u8F74",location:"center",display:{rotate:0,offset:30},textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"}},axisLine:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisTick:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisLabel:{show:!0,timeFormat:"MM/DD",interval:"auto",display:{rotate:0,margin:10},align:"center",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"}},grid:{show:!0,line:{type:"dashed",width:1,color:"rgba(233, 228, 228, 0.1)",dashedLength:4,dashedSpace:4}}},yAxis:{show:!0,extent:{min:"auto",max:"auto"},splitNumber:0,title:{show:!1,name:"Y\u8F74",location:"end",display:{rotate:0,offset:20},textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"}},axisLine:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisTick:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisLabel:{show:!0,valueFormat:"auto",boundaryGap:0,display:{rotate:0,margin:10},align:"right",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"}},grid:{show:!0,line:{type:"dashed",width:1,color:"rgba(233, 228, 228, 0.1)",dashedLength:4,dashedSpace:4}}},tooltip:{show:!0,textStyle:{fontSize:14,color:"#fff",fontWeight:"normal"},background:{padding:{h:5,v:5},color:"rgba(0, 0, 0, 0.65)"},pointer:{show:!0,line:{type:"dashed",width:1,color:"#f5dc69",dashedLength:4,dashedSpace:4}}},series:Qe()},apiData:ae({staticPath:"bar/basic-bar"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[]}}},Po={alias:"\u901A\u7528\u6807\u9898",icon:"file-word",type:O.com,attr:{w:300,h:48},config:{title:"\u6211\u662F\u6807\u9898\u6570\u636E",textStyle:{fontFamily:"Microsoft Yahei",fontSize:24,color:"#fff",fontWeight:"normal"},textAlign:"center",writingMode:"horizontal-tb",backgroundStyle:{show:!1,bgColor:"#008bff",borderRadius:15,borderColor:"#fff",borderStyle:"solid",borderWidth:1},ellipsis:!1,urlConfig:{url:"",isBlank:!1}},apiData:{},events:{}},Eo={alias:"\u6570\u5B57\u6307\u6807",icon:"orderedlist",type:O.com,attr:{w:300,h:74},config:{global:{fontFamily:"Microsoft Yahei",arrangement:"top",distance:0},title:{content:"\u6570\u5B57\u6307\u6807\u6807\u9898",textStyle:{fontSize:18,color:"#79daff",fontWeight:"normal",textAlign:"flex-start"}},counter:{textStyle:{fontFamily:"Microsoft Yahei",fontSize:36,color:"#0a73ff",fontWeight:"bolder",textAlign:"left"},value:1234567,duration:1e3,autoplay:!0,decimals:2,decimal:".",separator:",",prefix:"\uFFE5",suffix:""}},apiData:ae({staticPath:"text/number-title-flop"}),events:{}},jo={alias:"\u88C5\u9970\u5668",icon:"pushpin",type:O.com,attr:{w:200,h:200},config:{img:"decoration10"},apiData:{},events:{}},Oo={alias:"\u8FB9\u6846",icon:"gateway",type:O.com,attr:{w:300,h:180},config:{img:"box1"},apiData:{},events:{}},Xo={alias:"\u5355\u5F20\u56FE\u7247",icon:"image",type:O.com,attr:{w:300,h:180},config:{backgroundImage:Ct("/background/bg1.jpg"),repeat:"no-repeat",radius:2,urlConfig:{url:"",ifBlank:!1}},apiData:{},events:{}},Ko={alias:"\u65F6\u95F4\u5668",icon:"time-circle",type:O.com,attr:{w:300,h:56},config:{iconStyle:{show:!0,size:1.2,color:"rgba(93,245,244,1)",marginRight:6},time:{textStyle:{fontFamily:"Microsoft Yahei",fontSize:18,color:"#fff",fontWeight:"normal"},format:"YYYY-MM-DD HH:mm:ss",duration:1e3,horizontal:"center",vertical:"center"}},apiData:{},events:{}},qo={alias:"\u57FA\u672C\u6761\u5F62\u56FE",icon:"menu",type:O.com,componentType:"bar",attr:{w:500,h:300},config:{global:{fontFamily:"Microsoft Yahei",margin:{top:40,bottom:50,left:60,right:10},innerPadding:20,outerPadding:30,barWidth:"auto",borderRadius:0,background:{show:!0,color:"rgba(255, 255, 255, 0.1)"}},label:{show:!1,position:"top",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"},offsetX:0,offsetY:0},legend:{show:!0,position:"top-center",orient:"horizontal",textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"},symbol:{show:!0,icon:"auto",width:25,height:14,gap:10}},yAxis:{show:!0,type:"category",boundaryGap:!0,title:{show:!1,name:"Y\u8F74",location:"center",display:{rotate:0,offset:30},textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"}},axisLine:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisTick:{show:!1,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisLabel:{show:!0,timeFormat:"MM/DD",interval:"auto",display:{rotate:0,margin:20},align:"center",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"}},grid:{show:!0,line:{type:"dashed",width:1,color:"rgba(233, 228, 228, 0.1)",dashedLength:4,dashedSpace:4}}},xAxis:{show:!0,extent:{min:"auto",max:"auto"},splitNumber:0,title:{show:!1,name:"X\u8F74",location:"end",display:{rotate:0,offset:20},textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"}},axisLine:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisTick:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisLabel:{show:!0,valueFormat:"auto",boundaryGap:0,display:{rotate:0,margin:10},align:"center",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"}},grid:{show:!0,line:{type:"dashed",width:1,color:"rgba(233, 228, 228, 0.1)",dashedLength:4,dashedSpace:4}}},tooltip:{show:!0,textStyle:{fontSize:14,color:"#fff",fontWeight:"normal"},background:{padding:{h:5,v:5},color:"rgba(0, 0, 0, 0.65)"},pointer:{show:!0,line:{type:"dashed",width:1,color:"#f5dc69",dashedLength:4,dashedSpace:4}}},series:Qe()},apiData:ae({staticPath:"bar/basic-bar"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[]}}},Go=()=>Te.map(o=>({lineStyle:{width:2,color:o,type:"solid"},areaStyle:{from:we.alpha(o,.8),to:we.alpha(o,.2),opacity:.8}})),Jo={alias:"\u57FA\u672C\u533A\u57DF\u56FE",icon:"linechart",type:O.com,componentType:"line",attr:{w:500,h:300},config:{global:{fontFamily:"Microsoft Yahei",margin:{top:40,bottom:50,left:50,right:10},smooth:!1},label:{show:!1,position:"top",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"},offsetX:0,offsetY:0},legend:{show:!0,position:"top-center",orient:"horizontal",textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"},symbol:{show:!0,icon:"auto",width:25,height:14,gap:10}},xAxis:{show:!0,type:"category",boundaryGap:!0,title:{show:!1,name:"X\u8F74",location:"center",display:{rotate:0,offset:30},textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"}},axisLine:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisTick:{show:!0,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisLabel:{show:!0,timeFormat:"MM/DD",interval:"auto",display:{rotate:0,margin:10},align:"center",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"}},grid:{show:!1,line:{type:"dashed",width:1,color:"rgba(233, 228, 228, 0.1)",dashedLength:4,dashedSpace:4}}},yAxis:{show:!0,extent:{min:"auto",max:"auto"},splitNumber:0,title:{show:!1,name:"Y\u8F74",location:"end",display:{rotate:0,offset:20},textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"}},axisLine:{show:!1,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisTick:{show:!1,type:"solid",width:1,color:"rgba(255, 255, 255, 0.5)"},axisLabel:{show:!0,valueFormat:"auto",boundaryGap:0,display:{rotate:0,margin:10},align:"center",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"}},grid:{show:!0,line:{type:"solid",width:1,color:"rgba(233, 228, 228, 0.1)",dashedLength:4,dashedSpace:4}}},tooltip:{show:!0,textStyle:{fontSize:14,color:"#fff",fontWeight:"normal"},background:{padding:{h:5,v:5},color:"rgba(0, 0, 0, 0.65)"},pointer:{show:!0,line:{type:"dashed",width:1,color:"#f5dc69",dashedLength:4,dashedSpace:4}}},series:Go()},apiData:ae({staticPath:"line/basic-line"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[""]}}},Zo={alias:"\u6EDA\u52A8\u8868\u683C",icon:"table",type:O.com,componentType:"scrollTable",attr:{w:500,h:260},config:{rowNum:5,headerBGC:"#00BAFF",oddRowBGC:"#003B51",evenRowBGC:"#0A2732",waitTime:2e3,headerHeight:35,indexHeader:"#",carousel:"single",hoverPause:!1,index:!0,indexWidth:50,indexAlign:"center",columnWidth:[],align:[]},apiData:ae({staticPath:"table/scroll-table"}),events:{}},Qo={alias:"\u57FA\u672C\u997C\u56FE",icon:"piechart",type:O.com,componentType:"pie",attr:{w:500,h:300},config:{global:{fontFamily:"Microsoft Yahei",center:["50%","50%"],radius:["0","75%"],roseType:!1,borderRadius:0},label:{show:!0,position:"outside",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"},formatter:"",alignTo:"none",bleedMargin:10,distanceToLabelLine:5},legend:{show:!0,position:"bottom-center",orient:"horizontal",textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"},symbol:{show:!0,icon:"auto",width:25,height:14,gap:10}},tooltip:{show:!0,textStyle:{fontSize:14,color:"#fff",fontWeight:"normal"},background:{padding:{h:5,v:5},color:"rgba(0, 0, 0, 0.65)"}}},apiData:ae({staticPath:"pie/basic-pie"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[]}}},ea={alias:"\u57FA\u672C\u73AF\u56FE",icon:"piechart",type:O.com,componentType:"pie",attr:{w:500,h:300},config:{global:{fontFamily:"Microsoft Yahei",center:["50%","50%"],radius:["50%","75%"],roseType:!1,borderRadius:5},label:{show:!0,position:"outside",textStyle:{fontSize:12,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"},formatter:"",alignTo:"none",bleedMargin:10,distanceToLabelLine:5},legend:{show:!0,position:"bottom-center",orient:"horizontal",textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"},symbol:{show:!0,icon:"auto",width:25,height:14,gap:10}},tooltip:{show:!0,textStyle:{fontSize:14,color:"#fff",fontWeight:"normal"},background:{padding:{h:5,v:5},color:"rgba(0, 0, 0, 0.65)"}}},apiData:ae({staticPath:"pie/basic-pie"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[]}}},ta={alias:"\u57FA\u672C\u96F7\u8FBE\u56FE",icon:"radarchart",type:O.com,componentType:"radar",attr:{w:500,h:300},config:{global:{fontFamily:"Microsoft Yahei",center:["50%","50%"],radius:"75%",startAngle:90,shape:"polygon",splitNumber:4,axisLine:{show:!0,lineStyle:{color:"rgba(211, 253, 250, 0.8)"}},axisName:{show:!0,color:"rgba(211, 253, 250, 0.8)"},splitLine:{show:!0,lineStyle:{color:["rgba(211, 253, 250, 0.8)"]}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}},symbolSize:2,areaStyle:{opacity:.1}},label:{show:!1,position:"top",textStyle:{fontSize:10,color:"rgba(255, 255, 255, 0.6)",fontWeight:"normal"},formatter:""},legend:{show:!1,position:"top-center",orient:"horizontal",textStyle:{fontSize:12,color:"#90a0ae",fontWeight:"normal"},symbol:{show:!0,icon:"auto",width:25,height:14,gap:10}},tooltip:{show:!1,textStyle:{fontSize:14,color:"#fff",fontWeight:"normal"},background:{padding:{h:5,v:5},color:"rgba(0, 0, 0, 0.65)"}},color:Te},apiData:ae({staticPath:"radar/basic-radar"}),events:{click:{description:"\u5F53\u70B9\u51FB\u6570\u636E\u9879\u65F6",fields:[]}}},oa={id:"",name:"",alias:"",type:"",locked:!1,hided:!1,attr:{x:0,y:0,w:100,h:100,rotate:0,opacity:1},apiData:{},events:{}};function F(o,t){const n=St(kt(oa),t||{});return n.id=`${o}_${Me()}`,n.name=`V${o}`,Ke(n.apiData)||(n.apiData.comId=n.id),n}function et(o){switch(o.substr(1)){case"BasicBar":return F("BasicBar",Ho);case"HorizontalBar":return F("HorizontalBar",qo);case"BasicLine":return F("BasicLine",Nt);case"BasicArea":return F("BasicArea",Jo);case"BasicPie":return F("BasicPie",Qo);case"BasicRing":return F("BasicRing",ea);case"BasicRadar":return F("BasicRadar",ta);case"ScrollTable":return F("ScrollTable",Zo);case"MainTitle":return F("MainTitle",Po);case"NumberTitleFlop":return F("NumberTitleFlop",Eo);case"Timer":return F("Timer",Ko);case"BgBox":return F("BgBox",Wt);case"BorderBox":return F("BorderBox",Oo);case"Decoration":return F("Decoration",jo);case"MainImg":return F("MainImg",Xo);default:throw Error(`Unknown component type: ${o}.`)}}const aa={name:"components-panel",setup(){const{toggleCompsPanel:o,pageConfig:t,toolbar:n,addCom:e,onCompSelected:r,selectedCom:s}=N(),i=D(0),l=S(()=>xe[i.value].data);return{toolbar:n,toggleCompsPanel:o,activeIndex:i,componentsList:xe,comps:l,changeComp:f=>{o(!0),i.value=f},dragStart:(f,g)=>{f.dataTransfer.setData("text",g)},toAddCom:async(f,g)=>{if(g){const C=et(f);if(C.attr.x=Math.floor((t.value.width-C.attr.w)/2),C.attr.y=Math.floor((t.value.height-C.attr.h)/2),await e({component:C}),await r(C),C.apiData&&C.apiData.type===qe.static&&C.apiData.staticPath){const{data:k}=await Ze(C.id,C.apiData.staticPath);s.value.apiData.config.data=JSON.stringify(k)}}else console.log("\u6B63\u5728\u5F00\u53D1\u4E2D\u3002\u3002\u3002")},dragOver:f=>{f.preventDefault(),f.stopPropagation(),f.dataTransfer.dropEffect="none"},closePanel:()=>{n.value.components&&o(!1)}}}},na={class:"components-panel-wp"},la={class:"components-panel"},sa=a("div",{class:"panel-title"},[a("span",{class:"panel-text"},"\u7EC4\u4EF6")],-1),ia={class:"components-type"},ca=["onClick"],ra={class:"com-tab-title"},da={class:"p10"},ua=["title","draggable","onDragstart","onClick"],ma={class:"comp-item-text"};function fa(o,t,n,e,r,s){const i=v("b-icon"),l=v("b-scrollbar"),c=Pe("click-outside");return _(),w("div",na,[a("div",la,[sa,a("div",{class:"components-panel-content",onDragover:t[0]||(t[0]=(...d)=>e.dragOver&&e.dragOver(...d))},[a("div",ia,[m(l,{native:""},{default:b(()=>[(_(!0),w(H,null,le(e.componentsList,(d,u)=>(_(),w("div",{class:B(["components-item",{active:e.activeIndex===u}]),key:u,onClick:h=>e.changeComp(u)},[m(i,{class:"com-tab-icon",name:d.icon},null,8,["name"]),a("span",ra,q(d.name),1)],10,ca))),128))]),_:1})]),pe((_(),w("div",{class:B(["components-list",{"is-hide":!e.toolbar.components}])},[m(l,{native:""},{default:b(()=>[a("div",da,[(_(!0),w(H,null,le(e.comps,(d,u)=>(_(),w("div",{class:"comp-item",key:u,title:d.alias,draggable:d.used,onDragstart:h=>e.dragStart(h,d.name),onClick:h=>e.toAddCom(d.name,d.used)},[a("div",ma,q(d.alias),1),a("div",{class:"comp-item-img",style:L(`background-image: url(${d.img});`)},null,4)],40,ua))),128))])]),_:1})],2)),[[c,e.closePanel]])],32)])])}var ha=R(aa,[["render",fa]]);const Ie=o=>`${o}px`,Re=(o,t,n,e)=>{const r=o!=null?o:document.createElement("canvas");r.width=t*e,r.height=n*e,r.style.width=Ie(t),r.style.height=Ie(n);const s=r.getContext("2d");return s&&s.setTransform(e,0,0,e,0,0),r};class We{constructor(t,n){this.el=t,this.options=K({direction:"TB",width:1e3,height:20,bgColor:"#0e1013",fontFamily:"sans-serif",fontSize:"10px",fontColor:"#90a0ae",strokeStyle:"rgba(161, 174, 179, 0.8)",lineWidth:.5,indicatorLineWidth:1,scale:1,offset:40,ratio:2},n),this.canvas=null,this.ctx=null,this.ruler={width:0,height:0},this.constructRuler()}constructRuler(){const{el:t,options:n}=this,{direction:e,width:r,height:s,ratio:i}=n,l=Math.max(e==="TB"?t.offsetWidth:t.offsetHeight,r),c=s;this.ruler.width=l,this.ruler.height=c;const d=Re(null,l,c,i);Mt(d,"canvas-ruler"),t.appendChild(d),this.canvas=d,this.ctx=d.getContext("2d"),this.drawRuler()}drawRuler(){const{ctx:t,options:n,ruler:e}=this,{width:r,height:s}=e;t.beginPath(),t.fillStyle=n.bgColor,t.fillRect(0,0,r,s),t.closePath(),t.beginPath(),t.font=`${n.fontSize} ${n.fontFamily}`,t.textAlign="left",t.fillStyle=n.fontColor,t.strokeStyle=n.strokeStyle,t.lineWidth=n.lineWidth,this.drawPoints(),t.stroke()}drawPoints(){const{ctx:t,options:n,ruler:e}=this,{width:r,height:s}=e,{offset:i,scale:l}=n,c=0,d=s/1.5,u=s/1.2;for(let h=0;h<=r;h+=1){const p=h-i;if(p<0)continue;let f=-1,g=-1;p%50===0?(f=Math.floor(p/l),g=c):p%25===0?g=d:p%5===0&&(g=u),g>=0&&(t.moveTo(h+.5,s+.5),t.lineTo(h+.5,g),f>-1&&t.fillText(`${f}`,h+2.5,s/1.5))}}setSize(t,n,e){const{el:r,options:s}=this;s.width=t,s.height=n,s.scale=e;const{direction:i,width:l,height:c,ratio:d}=s,u=Math.max(i==="TB"?r.offsetWidth:r.offsetHeight,l),h=c;this.ruler.width=u,this.ruler.height=h,Re(this.canvas,u,h,d),this.drawRuler()}destroy(){const{el:t}=this;t.remove()}}const pa={name:"ruler",setup(){const{canvas:o}=N(),t=D(null),n=D(null),e=D(null),r=D(null),s=D(!0),i=D(0),l=D(0),c=document.documentElement.clientWidth;ht(()=>{if(t.value&&n.value){const u=Math.max(o.value.width,c);e.value?e.value.setSize(u,18,o.value.scale):e.value=new We(t.value,{direction:"TB",width:u,scale:o.value.scale}),r.value?r.value.setSize(o.value.height,18,o.value.scale):r.value=new We(n.value,{direction:"LR",width:o.value.height,scale:o.value.scale})}});const d=u=>{const h=u.target;i.value=h.scrollLeft,l.value=h.scrollTop};return ge(()=>{const u=document.getElementById("canvas-wp");u==null||u.addEventListener("scroll",d)}),pt(()=>{const u=document.getElementById("canvas-wp");u==null||u.removeEventListener("scroll",d)}),{visible:s,hRulerWpRef:t,vRulerWpRef:n,vScroll:l,hScroll:i}}},ga=o=>(ve("data-v-322352be"),o=o(),_e(),o),va={class:"canvas-ruler-wp"},_a=ga(()=>a("div",{class:"ruler-corner"},null,-1));function ba(o,t,n,e,r,s){return _(),w("div",va,[a("div",{ref:"hRulerWpRef",class:"ruler-wrapper h-container",style:L(`transform: translateX(-${e.hScroll}px);`)},null,4),a("div",{ref:"vRulerWpRef",class:"ruler-wrapper v-container",style:L(`transform: rotate(90deg) translateX(-${e.vScroll}px);`)},null,4),_a])}var ya=R(pa,[["render",ba],["__scopeId","data-v-322352be"]]);const ce=gt();function tt(o){return o*Math.PI/180}function Ne(o){return Math.abs(Math.sin(tt(o)))}function Ae(o){return Math.abs(Math.cos(tt(o)))}function Ue(o){if(o=K({},o),o.rotate!==0){const t=o.width*Ae(o.rotate)+o.height*Ne(o.rotate),n=(o.width-t)/2;o.left+=n,o.right=o.left+t;const e=o.height*Ae(o.rotate)+o.width*Ne(o.rotate),r=(e-o.height)/2;o.top-=r,o.bottom=o.top+e,o.width=t,o.height=e}else o.bottom=o.top+o.height,o.right=o.left+o.width;return o}const wa=5,xa={name:"mark-line",setup(){const{comps:o,selectedCom:t,canvas:n,setSingleComAttr:e,toolbox:r}=N(),s=D([]),i=D(["xt","xc","xb","yl","yc","yr"]),l=D({xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}),c=()=>{Object.keys(l.value).forEach(g=>{l.value[g]=!1})},d=(g,C)=>{const k=s.value,x=t.value,j=o.value.filter(Y=>!Y.hided),M=n.value.scale,y=Ue(p(x.attr)),$=y.width/2,z=y.height/2;c(),j.forEach(Y=>{if(Y.id===x.id||Y.locked||Y.hided)return;const{top:A,left:V,bottom:U,right:X,width:ue,height:me}=Ue(p(Y.attr)),I=ue/2,ee=me/2,fe={top:[{isNearly:f(y.top,A),lineNode:k.xt,line:"xt",dragShift:A,lineShift:A},{isNearly:f(y.bottom,A),lineNode:k.xt,line:"xt",dragShift:A-y.height,lineShift:A},{isNearly:f(y.top+z,A+ee),lineNode:k.xc,line:"xc",dragShift:A+ee-z,lineShift:A+ee},{isNearly:f(y.top,U),lineNode:k.xb,line:"xb",dragShift:U,lineShift:U},{isNearly:f(y.bottom,U),lineNode:k.xb,line:"xb",dragShift:U-y.height,lineShift:U}],left:[{isNearly:f(y.left,V),lineNode:k.yl,line:"yl",dragShift:V,lineShift:V},{isNearly:f(y.right,V),lineNode:k.yl,line:"yl",dragShift:V-y.width,lineShift:V},{isNearly:f(y.left+$,V+I),lineNode:k.yc,line:"yc",dragShift:V+I-$,lineShift:V+I},{isNearly:f(y.left,X),lineNode:k.yr,line:"yr",dragShift:X,lineShift:X},{isNearly:f(y.right,X),lineNode:k.yr,line:"yr",dragShift:X-y.width,lineShift:X}]},se=[],{rotate:be}=y;Object.keys(fe).forEach(ie=>{fe[ie].forEach(te=>{if(!te.isNearly)return;const Se=be!==0?u(ie,te,y):te.dragShift;console.log(A,V,U,X,ue,me),e({key:ie,value:Se}),te.lineNode.style[ie]=`${te.lineShift*M+60}px`,se.push(te.line)})}),se.length&&h(se,g,C)})},u=(g,C,k)=>{const{w:x,h:j}=t.value.attr;return Math.round(g==="top"?C.dragShift-(j-k.height)/2:C.dragShift-(x-k.width)/2)},h=(g,C,k)=>{k?g.includes("yr")?l.value.yr=!0:g.includes("yc")?l.value.yc=!0:g.includes("yl")&&(l.value.yl=!0):g.includes("yl")?l.value.yl=!0:g.includes("yc")?l.value.yc=!0:g.includes("yr")&&(l.value.yr=!0),C?g.includes("xb")?l.value.xb=!0:g.includes("xc")?l.value.xc=!0:g.includes("xt")&&(l.value.xt=!0):g.includes("xt")?l.value.xt=!0:g.includes("xc")?l.value.xc=!0:g.includes("xb")&&(l.value.xb=!0)},p=g=>({left:g.x,top:g.y,width:g.w,height:g.h,rotate:g.rotate}),f=(g,C)=>Math.abs(g-C)<=wa;return ge(()=>{ce.on("move",({isDownward:g,isRightward:C})=>{r.value.markLine&&d(g,C)}),ce.on("unmove",()=>{c()})}),Ce(()=>{ce.off("move"),ce.off("unmove")}),{lineRefs:s,lines:i,lineStatus:l}}},Ca={class:"mark-line"};function Sa(o,t,n,e,r,s){return _(),w("div",Ca,[(_(!0),w(H,null,le(e.lines,i=>pe((_(),w("div",{key:i,class:B(["line",[i.includes("x")?"xline":"yline",i]]),ref_for:!0,ref:l=>{e.lineRefs[i]=l}},null,2)),[[vt,e.lineStatus[i]||!1]])),128))])}var ka=R(xa,[["render",Sa],["__scopeId","data-v-a8389026"]]);const Ma=[{direction:"lt",angle:0},{direction:"t",angle:45},{direction:"rt",angle:90},{direction:"r",angle:135},{direction:"rb",angle:180},{direction:"b",angle:225},{direction:"lb",angle:270},{direction:"l",angle:315}],Ye=[{start:338,end:23,cursor:"nwse-resize"},{start:23,end:68,cursor:"ns-resize"},{start:68,end:113,cursor:"nesw-resize"},{start:113,end:158,cursor:"ew-resize"},{start:158,end:203,cursor:"nwse-resize"},{start:203,end:248,cursor:"ns-resize"},{start:248,end:293,cursor:"nesw-resize"},{start:293,end:338,cursor:"ew-resize"}],Va=o=>{const t=(o+360)%360,n={};let e=-1;return Ma.forEach(r=>{const s=(r.angle+t)%360,i=Ye.length,l=0;for(;l<i;){e=(e+1)%i;const c=Ye[e];if(s<23||s>=338){n[r.direction]="nwse-resize";break}if(c.start<=s&&s<c.end){n[r.direction]=c.cursor;break}}}),n};function Da(o,t,n,e,r,s){o==="t"?(s.h=Math.round(t.h+(n.y-e.y)/r),s.y=Math.round(t.y+(e.y-n.y)/r),s.h=Math.max(s.h,20)):o==="rt"?(s.h=Math.round(t.h+(n.y-e.y)/r),s.w=Math.round(t.w+(e.x-n.x)/r),s.y=Math.round(t.y+(e.y-n.y)/r),s.w=Math.max(s.w,20),s.h=Math.max(s.h,20)):o==="r"?(s.w=Math.round(t.w+(e.x-n.x)/r),s.w=Math.max(s.w,20)):o==="rb"?(s.h=Math.round(t.h+(e.y-n.y)/r),s.w=Math.round(t.w+(e.x-n.x)/r),s.w=Math.max(s.w,20),s.h=Math.max(s.h,20)):o==="b"?(s.h=Math.round(t.h+(e.y-n.y)/r),s.h=Math.max(s.h,20)):o==="lb"?(s.h=Math.round(t.h+(e.y-n.y)/r),s.w=Math.round(t.w+(n.x-e.x)/r),s.x=Math.round(t.x+(e.x-n.x)/r),s.w=Math.max(s.w,20),s.h=Math.max(s.h,20)):o==="l"?(s.w=Math.round(t.w+(n.x-e.x)/r),s.x=Math.round(t.x+(e.x-n.x)/r),s.w=Math.max(s.w,20)):o==="lt"&&(s.h=Math.round(t.h+(n.y-e.y)/r),s.w=Math.round(t.w+(n.x-e.x)/r),s.x=Math.round(t.x+(e.x-n.x)/r),s.y=Math.round(t.y+(e.y-n.y)/r),s.w=Math.max(s.w,20),s.h=Math.max(s.h,20))}const ot=(o,t,n,e,r)=>{const s=K({},n.attr),i=Object.create(null),l=o.clientX,c=o.clientY;let d=!1;const u=p=>{d=!0;const f=p.clientX,g=p.clientY;t?Da(t,s,{x:l,y:c},{x:f,y:g},e,i):(i.x=s.x+Math.round((f-l)/e/r)*r,i.y=s.y+Math.round((g-c)/e/r)*r),n.attr=K(K({},n.attr),i),ye().then(()=>{ce.emit("move",{isDownward:g-c>0,isRightward:f-l>0})})},h=()=>{ce.emit("unmove"),d&&Ge.dispatch("schema/recordSnapshot"),J(document,"mousemove",u),J(document,"mouseup",h)};G(document,"mousemove",u),G(document,"mouseup",h)},Ba=(o,t,n,e)=>{ot(o,null,t,n,e)},Ta=(o,t,n,e)=>{ot(o,t,n,e)},$a=(o,t,n)=>{const e=t.getBoundingClientRect(),r=e.left+e.width/2,s=e.top+e.height/2,i=Math.atan2(s-o.clientY,r-o.clientX)*180/Math.PI-n.attr.rotate;let l=!1;const c=u=>{l=!0;const h=Math.atan2(s-u.clientY,r-u.clientX)*180/Math.PI-i,p=Math.round(h%360);n.attr.rotate=p<0?p+360:p},d=()=>{l&&Ge.dispatch("schema/recordSnapshot"),J(document,"mousemove",c),J(document,"mouseup",d)};G(document,"mousemove",c),G(document,"mouseup",d)},za={name:"refer-line",props:{attr:{type:Object,required:!0},scale:{type:Number,required:!0}},setup(o){const t=S(()=>({height:`${o.attr.y+60/o.scale}px`,borderLeftWidth:`${.9/o.scale}px`})),n=S(()=>({width:`${o.attr.x+60/o.scale}px`,borderTopWidth:`${.9/o.scale}px`})),e=S(()=>({fontSize:`${12/o.scale}px`,top:`-${6/o.scale}px`,left:`-${6/o.scale}px`}));return{topLineStyle:t,leftLineStyle:n,accountStyle:e}}},La={class:"nav-line"};function Ia(o,t,n,e,r,s){return _(),w("div",La,[a("div",{class:"nav-line-top",style:L(e.topLineStyle)},null,4),a("div",{class:"nav-line-left",style:L(e.leftLineStyle)},null,4),a("div",{class:"nav-line-account",style:L(e.accountStyle)},q(n.attr.x)+", "+q(n.attr.y),5)])}var Ra=R(za,[["render",Ia]]);const Wa={name:"dv-transform",components:{ReferLine:Ra},props:{data:{type:Object,required:!0}},setup(o){const t=_t(),{canvas:n,store:e,comps:r,pageConfig:s,selectedCom:i,hoveredCom:l,onCompHovered:c,onCompSelected:d,toolbox:u}=N(),{showMenu:h}=$e(),p=S(()=>l.value===o.data.id),f=S(()=>!Ke(i.value)&&i.value.id===o.data.id),g=S(()=>e.state.schema.shortcuts.spaceKey),C=S(()=>({locked:o.data.locked,selected:f.value})),k=S(()=>({top:0,left:0,width:`${o.data.attr.w}px`,height:`${o.data.attr.h}px`,transform:`translate(${o.data.attr.x}px, ${o.data.attr.y}px)`})),x=S(()=>({"is-hide":!f.value||o.data.locked})),j=S(()=>({cursor:"move",transform:`rotate(${o.data.attr.rotate}deg)`})),M=S(()=>({width:`${o.data.attr.w}px`,height:`${o.data.attr.h}px`})),y=S(()=>({display:o.data.hided?"none":"block"})),$=S(()=>Va(o.data.attr.rotate)),z=S(()=>n.value.scale),Y=S(()=>{const I=`scale(${1/z.value}, ${1/z.value})`;return{t:{name:"top",style:{cursor:$.value.t,transform:I}},rt:{name:"top-right",style:{cursor:$.value.rt},rotateStyle:{"transform-origin":"25% 75%",transform:I}},r:{name:"right",style:{cursor:$.value.r,transform:I}},rb:{name:"bottom-right",style:{cursor:$.value.rb},rotateStyle:{"transform-origin":"25% 25%",transform:I}},b:{name:"bottom",style:{cursor:$.value.b,transform:I}},lb:{name:"bottom-left",style:{cursor:$.value.lb},rotateStyle:{"transform-origin":"75% 25%",transform:I}},l:{name:"left",style:{cursor:$.value.l,transform:I}},lt:{name:"top-left",style:{cursor:$.value.lt},rotateStyle:{"transform-origin":"75% 75%",transform:I}}}}),A=()=>{c(o.data.id)},V=()=>{c("")},U=()=>{f.value||d(o.data)};return{comps:r,selectedCom:i,hoveredCom:l,toolbox:u,isHovered:p,isSelected:f,hideStyle:y,transformClass:C,transformStyle:k,handlerClass:x,handlerStyle:j,wrapperStyle:M,onEnter:A,onLeave:V,onMove:I=>{g.value||(I.stopPropagation(),I.preventDefault(),U(),Ba(I,o.data,z.value,s.value.grid))},onZoom:(I,ee)=>{U(),Ta(I,ee,o.data,z.value)},onRotate:I=>{$a(I,t.vnode.el,o.data)},points:Y,scale:z,showMenu:h}}},Na={class:"dv-com"},Aa=["onMousedown"],Ua=["onMousedown"],Ya=a("div",{class:"transform-bg"},null,-1);function Fa(o,t,n,e,r,s){const i=v("refer-line");return _(),w("div",{class:B(["dv-transform",e.transformClass]),style:L(e.transformStyle)},[e.toolbox.referLine&&e.isSelected?(_(),P(i,{key:0,attr:n.data.attr,scale:e.scale},null,8,["attr","scale"])):ne("",!0),a("div",{class:B(["dv-scale",{hovered:e.isHovered}]),style:L(e.hideStyle),onMouseenter:t[2]||(t[2]=(...l)=>e.onEnter&&e.onEnter(...l)),onMouseleave:t[3]||(t[3]=(...l)=>e.onLeave&&e.onLeave(...l)),onMousedown:t[4]||(t[4]=(...l)=>e.onMove&&e.onMove(...l))},[a("div",{class:B(["transform-handler",e.handlerClass]),style:L(e.handlerStyle)},[a("div",Na,[je(o.$slots,"default"),a("div",{class:"dv-event-disable",style:L(e.wrapperStyle),onContextmenu:t[0]||(t[0]=(...l)=>e.showMenu&&e.showMenu(...l))},null,36)]),(_(!0),w(H,null,le(e.points,(l,c)=>(_(),w(H,{key:c},[l.rotateStyle?(_(),w("i",{key:0,class:B(`${l.name}-handler`),"data-html2canvas-ignore":""},[a("span",{class:"rotate-handler",style:L(l.rotateStyle),onMousedown:t[1]||(t[1]=Z((...d)=>e.onRotate&&e.onRotate(...d),["prevent","stop"]))},[a("span",{class:"control-point",style:L(l.style),onMousedown:Z(d=>e.onZoom(d,c),["prevent","stop"])},null,44,Aa)],36)],2)):(_(),w("i",{key:1,class:B(`${l.name}-handler`),"data-html2canvas-ignore":""},[a("span",{class:"control-point",style:L(l.style),onMousedown:Z(d=>e.onZoom(d,c),["prevent","stop"])},null,44,Ua)],2))],64))),128)),Ya],6)],38),n.data.locked?(_(),w("i",{key:1,class:"b-iconfont b-icon-lock",title:"\u89E3\u9501",onClick:t[5]||(t[5]=Z(l=>n.data.locked=!1,["stop"]))})):ne("",!0)],6)}var Ha=R(Wa,[["render",Fa]]);const Pa=["onClick"],Ea=["onClick"],ja={setup(o){const{toolbar:t,store:n,autoCanvasScale:e,setCanvasScale:r}=N(),s=S(()=>t.value.config?{right:"332px"}:{right:0}),i=()=>n.dispatch("schema/undo"),l=()=>n.dispatch("schema/redo");return(c,d)=>(_(),w("div",{class:"action-bar-wrap",style:L(Q(s))},[a("i",{class:"action-btn b-iconfont b-icon-aim",title:"\u6700\u4F73\u753B\u5E03\u6BD4\u4F8B",onClick:d[0]||(d[0]=Z((...u)=>Q(e)&&Q(e)(...u),["stop"]))}),a("i",{class:"action-btn b-iconfont b-icon-icon-test",title:"1:1\u753B\u5E03\u5927\u5C0F",onClick:d[1]||(d[1]=Z(u=>Q(r)(100),["stop"]))}),a("i",{class:"action-btn b-iconfont b-icon-rollback",title:"\u64A4\u9500",onClick:Z(i,["stop"])},null,8,Pa),a("i",{class:"action-btn b-iconfont b-icon-rollback",title:"\u91CD\u505A",onClick:Z(l,["stop"]),style:{transform:"rotateY(180deg)"}},null,8,Ea)],4))}};var Oa=R(ja,[["__scopeId","data-v-a2f7c9c8"]]);const Xa={name:"canvas-main",components:{MarkLine:ka,DvTransform:Ha,Ruler:ya,ActionBar:Oa},setup(){const{store:o,canvas:t,pageConfig:n,autoCanvasScale:e,comps:r,onCompSelected:s,getPanelOffsetLeft:i,getPanelOffsetTop:l,selectedCom:c,addCom:d,toolbox:u}=N(),h=D(null),p=De({drag:!1,startX:0,startY:0}),f=S(()=>o.state.schema.shortcuts.spaceKey),g=S(()=>({width:`${t.value.width}px`,height:`${t.value.height}px`})),C=S(()=>({position:"absolute",width:`${n.value.width}px`,height:`${n.value.height}px`,transform:`scale(${t.value.scale}) translate(0px, 0px)`,backgroundImage:`url(${n.value.bgImage})`,backgroundColor:n.value.bgColor})),k=Vt(e,50),x=async y=>{y.preventDefault();try{const $=y.dataTransfer.getData("text");if($){const z=et($),{scale:Y}=t.value,A=(y.clientX-i.value+h.value.scrollLeft)/Y,V=(y.clientY-l.value+h.value.scrollTop)/Y;if(z.attr.x=Math.round(A-z.attr.w/2),z.attr.y=Math.round(V-z.attr.h/2),await d({component:z}),await s(z),z.apiData&&z.apiData.type===qe.static&&z.apiData.staticPath){const{data:U}=await Ze(z.id,z.apiData.staticPath);c.value.apiData.config.data=JSON.stringify(U)}}}catch($){console.warn($)}},j=y=>{y.preventDefault(),y.stopPropagation(),y.dataTransfer.dropEffect="copy"},M=y=>{f.value||s(),p.drag=!0;const $=y.clientX,z=y.clientY,Y=t.value.scale,{scrollLeft:A,scrollTop:V,clientWidth:U,scrollWidth:X,clientHeight:ue,scrollHeight:me}=h.value,I=U<X||ue<me,ee={left:A,top:V},fe=be=>{if(!f.value||!p.drag||!I)return;const ie=be.clientX,te=be.clientY,Se=Math.round((ie-$)/Y),lt=Math.round((te-z)/Y);h.value.scrollLeft=ee.left-Se,h.value.scrollTop=ee.top-lt},se=()=>{p.drag=!1,J(document,"mousemove",fe),J(document,"mouseup",se)};G(document,"mousemove",fe),G(document,"mouseup",se)};return ge(()=>{G(window,"resize",k),k()}),Ce(()=>{J(window,"resize",k)}),ke(K({canvasWpRef:h},bt(p)),{screenShotStyle:g,canvasPanelStyle:C,comps:r,toolbox:u,cancelSelectCom:M,dropToAddCom:x,dragOver:j})}},Ka={class:"canvas-main"};function qa(o,t,n,e,r,s){const i=v("mark-line"),l=v("action-bar"),c=v("ruler"),d=v("dv-transform");return _(),w("div",Ka,[a("div",{id:"canvas-wp",ref:"canvasWpRef",class:"canvas-panel-wrap",onMousedown:t[2]||(t[2]=Z((...u)=>e.cancelSelectCom&&e.cancelSelectCom(...u),["stop"]))},[a("div",{class:"screen-shot",style:L(e.screenShotStyle)},[e.toolbox.markLine?(_(),P(i,{key:0,style:L(e.screenShotStyle)},null,8,["style"])):ne("",!0),m(l),m(c),a("div",{id:"canvas-components",class:"canvas-panel",style:L(e.canvasPanelStyle),onDragover:t[0]||(t[0]=(...u)=>e.dragOver&&e.dragOver(...u)),onDrop:t[1]||(t[1]=(...u)=>e.dropToAddCom&&e.dropToAddCom(...u))},[(_(!0),w(H,null,le(e.comps,u=>(_(),P(d,{key:u.id,data:u},{default:b(()=>[(_(),P(Oe(u.name),{data:u,style:L({transform:"translateZ(0px)",opacity:u.attr.opacity})},null,8,["data","style"]))]),_:2},1032,["data"]))),128))],36)],4)],544)])}var Ga=R(Xa,[["render",qa]]);const Ja={name:"page-config",setup(){const{pageConfig:o,autoCanvasScale:t,setScreenSize:n}=N(),e=D(""),r=()=>{o.value.bgColor="#0d2a42",o.value.bgImage=Tt("/background/background0.png")},s=async()=>{await t()},i=l=>{if(l!=="custom"){const c=l.split("x"),d=+c[0],u=+c[1];n({width:d,height:u})}};return de([()=>o.value.width,()=>o.value.height],()=>{const{width:l,height:c}=o.value;l===1920&&c===1080||l===2560&&c===1080||l===3440&&c===1080||l===3440&&c===1440||l===414&&c===736||l===375&&c===667||l===375&&c===812?e.value=`${l}x${c}`:e.value="custom"},{immediate:!0}),{screenLabel:e,onSizeChange:s,resetBGImage:r,pageConfig:o,pageMap:[{group:"web\u7AEF",data:Dt.map(l=>({value:`${l.width}x${l.height}`,label:l.label}))},{group:"\u79FB\u52A8\u8BBE\u5907",data:Bt.map(l=>({value:`${l.width}x${l.height}`,label:l.label}))},{group:"\u5176\u4ED6",data:[{value:"custom",label:"\u81EA\u5B9A\u4E49"}]}],sizeChange:i}}},Za=o=>(ve("data-v-13f843c0"),o=o(),_e(),o),Qa={class:"page-config-panel"},en=Za(()=>a("div",{class:"page-config-top"},"\u9875\u9762\u8BBE\u7F6E",-1)),tn={class:"page-config-content"},on={class:"page-config-wp"},an=T("\u6062\u590D\u9ED8\u8BA4\u80CC\u666F"),nn={class:"page-config-wp"};function ln(o,t,n,e,r,s){const i=v("g-group-select"),l=v("g-field"),c=v("g-input-number"),d=v("g-color-picker"),u=v("g-upload-img"),h=v("g-images-select"),p=v("b-button");return _(),w("div",Qa,[en,a("div",tn,[a("div",on,[m(l,{label:"\u5C4F\u5E55\u8BBE\u7F6E",flat:""},{default:b(()=>[m(i,{modelValue:e.screenLabel,"onUpdate:modelValue":t[0]||(t[0]=f=>e.screenLabel=f),data:e.pageMap,onChange:e.sizeChange},null,8,["modelValue","data","onChange"])]),_:1}),m(l,{label:"\u5C4F\u5E55\u5927\u5C0F",flat:""},{default:b(()=>[m(c,{modelValue:e.pageConfig.width,"onUpdate:modelValue":t[1]||(t[1]=f=>e.pageConfig.width=f),label:"\u5BBD\u5EA6",min:375,max:3840,inline:"",suffix:"px",onChange:e.onSizeChange},null,8,["modelValue","onChange"]),m(c,{modelValue:e.pageConfig.height,"onUpdate:modelValue":t[2]||(t[2]=f=>e.pageConfig.height=f),label:"\u9AD8\u5EA6",min:600,max:2160,inline:"",suffix:"px",onChange:e.onSizeChange},null,8,["modelValue","onChange"])]),_:1}),m(l,{label:"\u80CC\u666F\u989C\u8272"},{default:b(()=>[m(d,{modelValue:e.pageConfig.bgColor,"onUpdate:modelValue":t[3]||(t[3]=f=>e.pageConfig.bgColor=f)},null,8,["modelValue"])]),_:1}),m(l,{label:"\u80CC\u666F\u56FE",tooltip:"\u652F\u6301\u56FE\u7247\u5730\u5740\u3001\u9759\u6001\u8DEF\u5F84\u3001base64\u5B58\u50A8"},{default:b(()=>[m(u,{modelValue:e.pageConfig.bgImage,"onUpdate:modelValue":t[4]||(t[4]=f=>e.pageConfig.bgImage=f)},null,8,["modelValue"])]),_:1}),m(l,{label:"\u80CC\u666F\u9884\u8BBE",tooltip:"\u53EF\u4EE5\u52A0\u8F7D\u5BF9\u5E94\u9884\u8BBE\u7684\u56FE\u7247\u80CC\u666F"},{default:b(()=>[m(h,{modelValue:e.pageConfig.bgImage,"onUpdate:modelValue":t[5]||(t[5]=f=>e.pageConfig.bgImage=f),images:["bg"],"value-key":"src"},null,8,["modelValue"])]),_:1}),m(l,{label:"\u91CD\u7F6E"},{default:b(()=>[m(p,{type:"primary",size:"small",onClick:e.resetBGImage},{default:b(()=>[an]),_:1},8,["onClick"])]),_:1})]),a("div",nn,[m(l,{label:"\u6805\u683C\u95F4\u8DDD",tooltip:"\u6BCF\u6B21\u79FB\u52A8\u7684\u8DDD\u79BB\uFF0C\u5355\u4F4Dpx"},{default:b(()=>[m(c,{modelValue:e.pageConfig.grid,"onUpdate:modelValue":t[6]||(t[6]=f=>e.pageConfig.grid=f),min:1,max:20,suffix:"px"},null,8,["modelValue"])]),_:1})])])])}var sn=R(Ja,[["render",ln],["__scopeId","data-v-13f843c0"]]);const cn={name:"config-title",props:{comName:{type:String,required:!0},comAlias:{type:String,required:!0}},setup(o){const t=S(()=>{const e=Fo(o.comName);return e==null?void 0:e.com.name});return{toSearch:()=>{window.open("https://echarts.apache.org/zh/option.html#title","_blank")},comTitle:t}}},at=o=>(ve("data-v-68e00668"),o=o(),_e(),o),rn={class:"com-title-wp"},dn={class:"com-title"},un={class:"title-name"},mn={class:"alias-name"},fn={class:"version-tag"},hn=at(()=>a("i",{class:"b-iconfont b-icon-search"},null,-1)),pn=at(()=>a("span",null,"\u641C\u7D22\u914D\u7F6E",-1)),gn=[hn,pn];function vn(o,t,n,e,r,s){return _(),w("div",rn,[a("div",dn,[a("div",un,[a("span",mn,q(n.comAlias),1)]),a("div",fn,[a("span",null,q(e.comTitle),1)])]),je(o.$slots,"default",{},()=>[a("div",{class:"search-config",onClick:t[0]||(t[0]=(...i)=>e.toSearch&&e.toSearch(...i)),title:"echarts option config"},gn)],!0)])}var nt=R(cn,[["render",vn],["__scopeId","data-v-68e00668"]]);const _n={name:"data-center-panel",components:{ConfigTitle:nt,SourcePanel:$t(()=>zt(()=>import("./source-panel-40bfeec4.js"),["static/js/source-panel-40bfeec4.js","static/css/source-panel-b97bf40d.css","static/js/index-e100dc50.js","static/css/index-8383f490.css","static/js/vendor-95729a87.js","static/css/vendor-2b79d43b.css","static/js/chunk-brace-269ffce0.js","static/js/chunk-bin-ui-next-c6363b96.js","static/css/chunk-bin-ui-next-ad90ea53.css","static/js/useSchemaStore-f69e9a12.js","static/js/database.api-ac0587f8.js"]))},setup(){const{selectedCom:o}=N(),t=S(()=>Object.keys(o.value.apiData));return{com:o,dataKeys:t}}},bn={class:"data-center-panel"},yn={class:"scroll-container"},wn={key:1,style:{"min-height":"300px"},flex:"main:center cross:center"},xn=T("\u8BE5\u7EC4\u4EF6\u4E0D\u9700\u8981\u914D\u7F6E\u6570\u636E");function Cn(o,t,n,e,r,s){const i=v("config-title"),l=v("source-panel"),c=v("b-empty"),d=v("b-scrollbar");return _(),w("div",bn,[m(i,{"com-name":e.com.name,"com-alias":e.com.alias},null,8,["com-name","com-alias"]),a("div",yn,[m(d,{native:""},{default:b(()=>[e.dataKeys.length>0?(_(),P(l,{key:0})):(_(),w("div",wn,[m(c,null,{default:b(()=>[xn]),_:1})]))]),_:1})])])}var Sn=R(_n,[["render",Cn]]);const kn={name:"basic-setting",props:{attr:{type:Object,required:!0}}},Mn={class:"basic-setting-wp"},Vn={style:{width:"50%"}},Dn=T("\u91CD\u7F6E\u65CB\u8F6C");function Bn(o,t,n,e,r,s){const i=v("g-input-number"),l=v("g-field"),c=v("b-button"),d=v("g-slider");return _(),w("div",Mn,[m(l,{label:"\u56FE\u8868\u5C3A\u5BF8",flat:""},{default:b(()=>[m(i,{modelValue:n.attr.w,"onUpdate:modelValue":t[0]||(t[0]=u=>n.attr.w=u),label:"\u5BBD\u5EA6",min:10,max:4e3,inline:"",suffix:"px"},null,8,["modelValue"]),m(i,{modelValue:n.attr.h,"onUpdate:modelValue":t[1]||(t[1]=u=>n.attr.h=u),label:"\u9AD8\u5EA6",min:10,max:4e3,inline:"",suffix:"px"},null,8,["modelValue"])]),_:1}),m(l,{label:"\u56FE\u8868\u4F4D\u7F6E",flat:""},{default:b(()=>[m(i,{modelValue:n.attr.x,"onUpdate:modelValue":t[2]||(t[2]=u=>n.attr.x=u),label:"X",inline:"",suffix:"px"},null,8,["modelValue"]),m(i,{modelValue:n.attr.y,"onUpdate:modelValue":t[3]||(t[3]=u=>n.attr.y=u),label:"Y",inline:"",suffix:"px"},null,8,["modelValue"])]),_:1}),m(l,{label:"\u65CB\u8F6C\u89D2\u5EA6",flat:""},{default:b(()=>[m(i,{modelValue:n.attr.rotate,"onUpdate:modelValue":t[4]||(t[4]=u=>n.attr.rotate=u),min:0,max:360,step:1,inline:""},null,8,["modelValue"]),a("div",Vn,[m(c,{size:"small",onClick:t[5]||(t[5]=u=>n.attr.rotate=0)},{default:b(()=>[Dn]),_:1})])]),_:1}),m(l,{label:"\u900F\u660E\u5EA6"},{default:b(()=>[m(d,{modelValue:n.attr.opacity,"onUpdate:modelValue":t[6]||(t[6]=u=>n.attr.opacity=u),min:0,max:1,step:.05},null,8,["modelValue","step"])]),_:1})])}var Tn=R(kn,[["render",Bn]]);const $n={name:"setting-panel",components:{BasicSetting:Tn,ConfigTitle:nt},setup(){const{selectedCom:o}=N();return{selectedCom:o}}},zn={class:"setting-panel"},Ln={class:"setting-panel-content"},In={class:"scroll-container"};function Rn(o,t,n,e,r,s){const i=v("config-title"),l=v("basic-setting"),c=v("b-scrollbar");return _(),w("div",zn,[m(i,{"com-name":e.selectedCom.name,"com-alias":e.selectedCom.alias},null,8,["com-name","com-alias"]),a("div",Ln,[a("div",In,[m(c,null,{default:b(()=>[(_(),P(l,{key:`${e.selectedCom.id}'_basic-setting`,attr:e.selectedCom.attr},null,8,["attr"])),(_(),P(Oe(e.selectedCom.name+"Config"),{key:e.selectedCom.id,data:e.selectedCom},null,8,["data"]))]),_:1})])])])}var Wn=R($n,[["render",Rn]]);const Nn={name:"config-panel",components:{SettingPanel:Wn,DataCenterPanel:Sn,PageConfig:sn},setup(){const{toolbar:o,selectedCom:t,toggleConfigPanel:n}=N(),e=D(0),r=s=>{if(s===2){re.warning("\u6682\u672A\u5F00\u653E!");return}e.value!==s&&(e.value=s)};return de(()=>t.value,()=>{e.value=0}),{toolbar:o,selectedCom:t,toggleConfigPanel:n,curTabIndex:e,changeTab:r}}},An={class:"config-panel"},Un={key:1,class:"page-config-panel"},Yn={class:"page-config-top"},Fn={class:"tabs-wrapper"},Hn={class:"page-config-content"},Pn={key:0,style:{height:"100%"}},En={key:1,style:{height:"100%"}};function jn(o,t,n,e,r,s){const i=v("page-config"),l=v("b-icon"),c=v("b-tooltip"),d=v("setting-panel"),u=v("data-center-panel");return _(),w("div",{class:B(["config-panel-wp",{"is-hide":!e.toolbar.config}])},[a("div",An,[e.selectedCom?(_(),w("div",Un,[a("div",Yn,[a("div",Fn,[a("div",{class:B(["tab-item",{active:e.curTabIndex===0}]),onClick:t[0]||(t[0]=h=>e.changeTab(0))},[m(c,{content:"\u914D\u7F6E"},{default:b(()=>[m(l,{name:"control",size:"20"})]),_:1})],2),a("div",{class:B(["tab-item",{active:e.curTabIndex===1}]),onClick:t[1]||(t[1]=h=>e.changeTab(1))},[m(c,{content:"\u6570\u636E"},{default:b(()=>[m(l,{name:"cloud-server",size:"22"})]),_:1})],2),a("div",{class:B(["tab-item",{active:e.curTabIndex===2}]),onClick:t[2]||(t[2]=h=>e.changeTab(2))},[m(c,{content:"\u4EA4\u4E92"},{default:b(()=>[m(l,{name:"deploymentunit",size:"18"})]),_:1})],2)])]),a("div",Hn,[e.curTabIndex===0?(_(),w("div",Pn,[(_(),P(d,{key:e.selectedCom.id}))])):ne("",!0),e.curTabIndex===1?(_(),w("div",En,[(_(),P(u,{key:e.selectedCom.id}))])):ne("",!0)])])):(_(),P(i,{key:0}))])],2)}var On=R(Nn,[["render",jn]]);const Xn={class:"toolbox-panel",flex:"main:justify"},Kn={style:{width:"500px"},flex:""},qn=a("i",{class:"action-btn b-iconfont b-icon-rollback"},null,-1),Gn=T(" \u64A4\u9500 "),Jn=a("i",{class:"action-btn b-iconfont b-icon-rollback",style:{transform:"rotateY(180deg)"}},null,-1),Zn=T(" \u91CD\u505A "),Qn=a("div",null,null,-1),el={class:"btn-box"},tl=T("\u53C2\u8003\u7EBF\xA0\xA0 "),ol={class:"btn-box"},al=T("\u5BF9\u9F50\u7EBF\xA0\xA0 "),nl={class:"ctrl-box"},ll=T("\xA0\xA0 "),sl=T("\u6E05\u7A7A\u753B\u5E03"),il={setup(o){const{store:t,toolbar:n,toolbox:e}=N(),r=()=>{Je.confirm({type:"error",title:"\u786E\u8BA4\u6E05\u7A7A\u753B\u5E03\u5417\uFF1F\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01"}).then(()=>{t.dispatch("schema/clearScreen")}).catch(()=>{})},s=()=>t.dispatch("schema/undo"),i=()=>t.dispatch("schema/redo");return(l,c)=>{const d=v("b-button"),u=v("b-switch");return _(),w("div",{class:B(["toolbox-panel-wp",{"is-hide":!Q(n).toolbox}])},[a("div",Xn,[a("div",Kn,[m(d,{size:"mini",onClick:s},{default:b(()=>[qn,Gn]),_:1}),m(d,{size:"mini",onClick:i},{default:b(()=>[Jn,Zn]),_:1}),Qn,a("div",el,[tl,m(u,{modelValue:Q(e).referLine,"onUpdate:modelValue":c[0]||(c[0]=h=>Q(e).referLine=h),size:"small"},null,8,["modelValue"])]),a("div",ol,[al,m(u,{modelValue:Q(e).markLine,"onUpdate:modelValue":c[1]||(c[1]=h=>Q(e).markLine=h),size:"small"},null,8,["modelValue"])])]),a("div",nl,[ll,m(d,{size:"mini",icon:"clear",onClick:r},{default:b(()=>[sl]),_:1})])])],2)}}};const cl={name:"shortcut",props:{modelValue:{type:Boolean}},emits:["update:modelValue"]},rl=o=>(ve("data-v-4843f0c7"),o=o(),_e(),o),dl=rl(()=>a("div",{class:"shortcut-wp"},[a("div",{class:"shortcut-box"},[a("div",{class:"key-title"},"\u57FA\u7840\u5FEB\u6377\u952E"),a("div",{class:"key-wrap"},[a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u5F00\u5173\u56FE\u5C42\u9762\u677F"),a("div",{class:"shortcut-value"},"Ctrl + \u2190")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u5F00\u5173\u914D\u7F6E\u9762\u677F"),a("div",{class:"shortcut-value"},"Ctrl + \u2192")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u5F00\u5173\u7EC4\u4EF6\u9762\u677F"),a("div",{class:"shortcut-value"},"Ctrl + \u2191")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u5F00\u5173\u5DE5\u5177\u680F"),a("div",{class:"shortcut-value"},"Ctrl + \u2193")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u590D\u5236\u9009\u4E2D\u7EC4\u4EF6"),a("div",{class:"shortcut-value"},"Ctrl + C")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u7C98\u8D34\u7EC4\u4EF6"),a("div",{class:"shortcut-value"},"Ctrl + V")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u64A4\u9500\u64CD\u4F5C"),a("div",{class:"shortcut-value"},"Ctrl + Z")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u4FDD\u5B58\u770B\u677F"),a("div",{class:"shortcut-value"},"Ctrl + S")])])]),a("div",{class:"shortcut-box"},[a("div",{class:"key-title"},"\u753B\u5E03\u64CD\u4F5C"),a("div",{class:"key-wrap"},[a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u753B\u5E03\u7F29\u653E\u6700\u4F73\u6BD4\u4F8B"),a("div",{class:"shortcut-value"},"Ctrl + A")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u753B\u5E03\u7F29\u653E\u4E3A1\uFF1A1"),a("div",{class:"shortcut-value"},"Ctrl + D")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u81EA\u7531\u7F29\u653E"),a("div",{class:"shortcut-value"},"Ctrl + \u9F20\u6807\u6EDA\u8F6E/\u6EDA\u52A8")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u79FB\u52A8\u753B\u5E03"),a("div",{class:"shortcut-value"},"Space + \u9F20\u6807\u5DE6\u952E/\u62D6\u52A8")])])]),a("div",{class:"shortcut-box"},[a("div",{class:"key-title"},"\u7EC4\u4EF6\u64CD\u4F5C"),a("div",{class:"key-wrap"},[a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u7EC4\u4EF6\u7F6E\u9876"),a("div",{class:"shortcut-value"},"Alt + Home")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u7EC4\u4EF6\u7F6E\u5E95"),a("div",{class:"shortcut-value"},"Alt + End")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u4E0A\u79FB\u4E00\u5C42"),a("div",{class:"shortcut-value"},"Alt + \u2191")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u4E0B\u79FB\u4E00\u5C42"),a("div",{class:"shortcut-value"},"Alt + \u2193")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u79FB\u52A8\u7EC4\u4EF61\u50CF\u7D20"),a("div",{class:"shortcut-value"},"\u2191 \u2193 \u2190 \u2192")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u79FB\u52A8\u7EC4\u4EF610\u50CF\u7D20"),a("div",{class:"shortcut-value"},"Shift + \u2191 \u2193 \u2190 \u2192")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u91CD\u547D\u540D"),a("div",{class:"shortcut-value"},"F2/\u53CC\u51FB\u56FE\u5C42")]),a("div",{class:"shortcut-item"},[a("div",{class:"shortcut-title"},"\u5220\u9664\u9009\u4E2D\u7EC4\u4EF6"),a("div",{class:"shortcut-value"},"Delete")])])])],-1));function ul(o,t,n,e,r,s){const i=v("b-modal");return _(),P(i,{title:"\u5FEB\u6377\u952E\u6307\u5357","model-value":n.modelValue,"append-to-body":"","custom-class":"schema-modal",onClose:t[0]||(t[0]=l=>o.$emit("update:modelValue",!1))},{default:b(()=>[dl]),_:1},8,["model-value"])}var ml=R(cl,[["render",ul],["__scopeId","data-v-4843f0c7"]]);const fl={name:"footer-panel",components:{Shortcut:ml},setup(){const{pageConfig:o,canvas:t,autoCanvasScale:n,setCanvasScale:e}=N(),r=D([200,150,100,50]),s=D(20),i=D(20),l=D(!1),c=async d=>{d===-1?await n():await e(d===0?s.value:d)};return de(()=>t.value.scale,d=>{const u=parseInt((d*100).toFixed(2));i.value=u,s.value=u}),{pageConfig:o,scaleList:r,inputScale:s,scale:i,submitScale:c,keycodeVisible:l}}},hl={class:"footer-panel"},pl={class:"screen-info",flex:"cross:center"},gl={class:"ml-8",style:{transform:"scale(0.9)"}},vl={flex:"cross:center"},_l={class:"scale-input-wp"},bl=a("span",{class:"percent"},"%",-1),yl=a("i",{class:"b-iconfont b-icon-down"},null,-1),wl=T("\u81EA\u9002\u5E94"),xl={class:"scale-slider-wp"};function Cl(o,t,n,e,r,s){const i=v("b-icon"),l=v("b-tooltip"),c=v("b-dropdown-item"),d=v("b-dropdown-menu"),u=v("b-dropdown"),h=v("b-slider"),p=v("shortcut");return _(),w(H,null,[a("div",hl,[a("div",pl,[m(l,{content:"\u5FEB\u6377\u952E\u63D0\u793A","open-delay":500},{default:b(()=>[m(i,{name:"read",size:"16",type:"button",onClick:t[0]||(t[0]=f=>e.keycodeVisible=!0)})]),_:1}),a("span",gl,q(e.pageConfig.width)+" \u50CF\u7D20 * "+q(e.pageConfig.height)+" \u50CF\u7D20",1)]),a("div",vl,[m(u,{trigger:"click",onCommand:e.submitScale},{dropdown:b(()=>[m(d,null,{default:b(()=>[(_(!0),w(H,null,le(e.scaleList,f=>(_(),P(c,{key:f,name:f},{default:b(()=>[T(q(`${f}%`),1)]),_:2},1032,["name"]))),128)),m(c,{name:-1},{default:b(()=>[wl]),_:1})]),_:1})]),default:b(()=>[a("div",_l,[pe(a("input",{"onUpdate:modelValue":t[1]||(t[1]=f=>e.inputScale=f),type:"number",class:"scale-input",onKeydown:t[2]||(t[2]=Ee(f=>e.submitScale(0),["enter"]))},null,544),[[Be,e.inputScale]]),bl,yl])]),_:1},8,["onCommand"]),a("div",xl,[m(h,{modelValue:e.scale,"onUpdate:modelValue":t[3]||(t[3]=f=>e.scale=f),min:10,max:200,step:5,"show-tooltip":!1,onChange:e.submitScale},null,8,["modelValue","onChange"])])])]),m(p,{modelValue:e.keycodeVisible,"onUpdate:modelValue":t[4]||(t[4]=f=>e.keycodeVisible=f)},null,8,["modelValue"])],64)}var Sl=R(fl,[["render",Cl]]);const kl={name:"context-menu",setup(){const{onCompMoved:o,deleteCom:t,copyCom:n}=N(),{contextMenu:e,selectedCom:r,isLocked:s,isHided:i,contextMenuStyle:l,renamingCom:c}=$e(),d=y=>{r.value&&o(r.value.id,y)},u=()=>d(oe.up),h=()=>d(oe.down),p=()=>d(oe.top),f=()=>d(oe.bottom),g=()=>{r.value&&(r.value.locked=!r.value.locked)},C=()=>{r.value&&(r.value.hided=!r.value.hided)},k=()=>{const y=r.value;y&&Je.confirm({type:"error",title:"\u662F\u5426\u5220\u9664\u9009\u4E2D\u76841\u4E2A\u7EC4\u4EF6"}).then(()=>{t(y.id)}).catch(()=>{})},x=()=>{const y=r.value;y&&c(y.id)},j=()=>{const y=r.value;y&&n(y.id)},M=y=>y.preventDefault();return ge(()=>{G(document,"contextmenu",M)}),Ce(()=>{J(document,"contextmenu",M)}),{contextMenu:e,contextMenuStyle:l,isLocked:s,isHided:i,moveUp:u,moveDown:h,moveTop:p,moveBottom:f,toDeleteCom:k,renameCom:x,toCopyCom:j,lockCom:g,hideCom:C}}},W=o=>(ve("data-v-5f8d1aa3"),o=o(),_e(),o),Ml=W(()=>a("i",{class:"menu-icon b-iconfont b-icon-vertical-align-botto",style:{transform:"rotate(180deg)"}},null,-1)),Vl=T("\u7F6E\u9876 "),Dl=W(()=>a("span",{class:"key-code"},"Alt + Home",-1)),Bl=[Ml,Vl,Dl],Tl=W(()=>a("i",{class:"menu-icon b-iconfont b-icon-vertical-align-botto"},null,-1)),$l=T("\u7F6E\u5E95 "),zl=W(()=>a("span",{class:"key-code"},"Alt + End",-1)),Ll=[Tl,$l,zl],Il=W(()=>a("i",{class:"menu-icon b-iconfont b-icon-arrowup"},null,-1)),Rl=T("\u4E0A\u79FB\u4E00\u5C42 "),Wl=W(()=>a("span",{class:"key-code"},"Alt + \u2191",-1)),Nl=[Il,Rl,Wl],Al=W(()=>a("i",{class:"menu-icon b-iconfont b-icon-arrowdown"},null,-1)),Ul=T("\u4E0B\u79FB\u4E00\u5C42 "),Yl=W(()=>a("span",{class:"key-code"},"Alt + \u2193",-1)),Fl=[Al,Ul,Yl],Hl=W(()=>a("div",{class:"context-menu-divider"},null,-1)),Pl=W(()=>a("i",{class:"menu-icon b-iconfont b-icon-unlock"},null,-1)),El=T("\u89E3\u9501 "),jl=W(()=>a("i",{class:"menu-icon b-iconfont b-icon-lock"},null,-1)),Ol=T("\u9501\u5B9A "),Xl=W(()=>a("i",{class:"menu-icon b-iconfont b-icon-eye"},null,-1)),Kl=T("\u663E\u793A "),ql=W(()=>a("i",{class:"menu-icon b-iconfont b-icon-eye-close"},null,-1)),Gl=T("\u9690\u85CF "),Jl=W(()=>a("div",{class:"context-menu-divider"},null,-1)),Zl=W(()=>a("i",{class:"menu-icon b-iconfont b-icon-edit"},null,-1)),Ql=T("\u91CD\u547D\u540D "),es=W(()=>a("span",{class:"key-code"},"F2",-1)),ts=[Zl,Ql,es],os=W(()=>a("i",{class:"menu-icon b-iconfont b-icon-file-copy"},null,-1)),as=T("\u590D\u5236 "),ns=W(()=>a("span",{class:"key-code"},"Ctrl + C,V",-1)),ls=[os,as,ns],ss=W(()=>a("i",{class:"menu-icon b-iconfont b-icon-delete"},null,-1)),is=T("\u5220\u9664 "),cs=W(()=>a("span",{class:"key-code"},"Delete",-1)),rs=[ss,is,cs];function ds(o,t,n,e,r,s){return _(),P(yt,{name:"zoom-in-top"},{default:b(()=>[e.contextMenu.show?(_(),w("div",{key:0,class:"context-menu-wrap",style:L(e.contextMenuStyle)},[a("div",{class:"context-menu-item",onClick:t[0]||(t[0]=(...i)=>e.moveTop&&e.moveTop(...i))},Bl),a("div",{class:"context-menu-item",onClick:t[1]||(t[1]=(...i)=>e.moveBottom&&e.moveBottom(...i))},Ll),a("div",{class:"context-menu-item",onClick:t[2]||(t[2]=(...i)=>e.moveUp&&e.moveUp(...i))},Nl),a("div",{class:"context-menu-item",onClick:t[3]||(t[3]=(...i)=>e.moveDown&&e.moveDown(...i))},Fl),Hl,a("div",{class:"context-menu-item",onClick:t[4]||(t[4]=(...i)=>e.lockCom&&e.lockCom(...i))},[e.isLocked?(_(),w(H,{key:0},[Pl,El],64)):(_(),w(H,{key:1},[jl,Ol],64))]),a("div",{class:"context-menu-item",onClick:t[5]||(t[5]=(...i)=>e.hideCom&&e.hideCom(...i))},[e.isHided?(_(),w(H,{key:0},[Xl,Kl],64)):(_(),w(H,{key:1},[ql,Gl],64))]),Jl,a("div",{class:"context-menu-item",onClick:t[6]||(t[6]=(...i)=>e.renameCom&&e.renameCom(...i))},ts),a("div",{class:"context-menu-item",onClick:t[7]||(t[7]=(...i)=>e.toCopyCom&&e.toCopyCom(...i))},ls),a("div",{class:"context-menu-item",onClick:t[8]||(t[8]=(...i)=>e.toDeleteCom&&e.toDeleteCom(...i))},rs)],4)):ne("",!0)]),_:1})}var us=R(kl,[["render",ds],["__scopeId","data-v-5f8d1aa3"]]);function ms(){const o=He(),{loadScreenData:t,setScreenSize:n}=N(),e=D(!1),r=async i=>{try{e.value=!0;const l=await Lt(i);if(l){const{id:c,name:d,pid:u,layout:h,components:p}=l,f={pageInfo:{id:c,name:d,pid:u},pageConfig:JSON.parse(h),comps:p.map(g=>JSON.parse(g.componentContent))};await t(f),await ye(),document.title=d}}catch(l){console.log(l)}e.value=!1},s=async()=>{try{e.value=!0;const i=await At();if(i.tpl.length>0){const l=await mt(i.tpl);if(l){const c=JSON.parse(l.content),{comps:d,pageConfig:u}=c;await t({comps:d,pageConfig:u})}}else await n(i)}catch(i){console.log(i)}e.value=!1};return de(()=>o.path,async()=>{const{id:i}=o.query;i?await r(i):await s()},{immediate:!0}),{loading:e}}function fs(){const o=D(null),t=D(null),{canvas:n,selectedCom:e,autoCanvasScale:r,setCanvasScale:s,toggleLayerPanel:i,toggleCompsPanel:l,toggleConfigPanel:c,toggleToolbox:d,copyCom:u}=N(),h=Ve();let p=null;const f=x=>{const j=x.target;if(!["input","textarea"].includes(j.tagName.toLowerCase())){const M=x.key.toLowerCase();M==="delete"?(t.value&&t.value.toDeleteCom(),x.preventDefault()):M==="f2"&&(t.value&&t.value.renameCom(),x.preventDefault());const y=e.value;x.altKey&&(g("altKey"),M==="arrowup"?t.value&&t.value.moveUp():M==="arrowdown"?t.value&&t.value.moveDown():M==="home"?t.value&&t.value.moveTop():M==="end"&&t.value&&t.value.moveBottom(),x.preventDefault()),x.ctrlKey&&(g("ctrlKey"),M==="arrowup"?(l(),x.preventDefault()):M==="arrowdown"?(d(),x.preventDefault()):M==="arrowleft"?(i(),x.preventDefault()):M==="arrowright"?(c(),x.preventDefault()):M==="a"?(r(),x.preventDefault()):M==="d"?(s(100),x.preventDefault()):M==="c"?(p=e.value,x.preventDefault()):M==="v"?(p&&u(p.id),x.preventDefault()):M==="s"?(o.value&&o.value.handleSaveScreen(),x.preventDefault()):M==="z"&&(h.dispatch("schema/undo"),x.preventDefault())),x.shiftKey&&g("shiftKey"),x.keyCode===32&&(g("spaceKey"),x.preventDefault());const $=x.shiftKey?10:1;y&&(M==="arrowleft"?(y.attr.x-=$,x.preventDefault()):M==="arrowright"?(y.attr.x+=$,x.preventDefault()):M==="arrowup"?(y.attr.y-=$,x.preventDefault()):M==="arrowdown"&&(y.attr.y+=$,x.preventDefault()))}},g=x=>{h.dispatch("schema/toggleKey",{key:x,status:!0})},C=()=>{h.dispatch("schema/resetKeyCode")},k=x=>{const j=parseInt((n.value.scale*100).toFixed(2)),M=(x.wheelDelta>0?1:-1)*5,y=Math.min(Math.max(j+M,20),200);s(y)};return ge(()=>{G(document,"keydown",f),G(document,"keyup",C)}),Ce(()=>{J(document,"keydown",f),J(document,"keyup",C)}),{headerRef:o,contextMenuRef:t,ctrlMouseWheel:k}}const hs={name:"ScreenEditor",components:{ContextMenu:us,FooterPanel:Sl,ToolboxPanel:il,CanvasMain:Ga,ConfigPanel:On,ComponentsPanel:ha,LayerPanel:ko,HeaderBar:co,SvgLoading:ft},setup(){return K(K({},ms()),fs())}},ps={key:0,flex:"main:center cross:center",class:"full-wrapper"},gs={key:1,class:"editor-main-wrapper"},vs={class:"edit-main-wp"};function _s(o,t,n,e,r,s){const i=v("header-bar"),l=v("svg-loading"),c=v("components-panel"),d=v("layer-panel"),u=v("toolbox-panel"),h=v("canvas-main"),p=v("footer-panel"),f=v("config-panel"),g=v("context-menu");return _(),w("div",{class:"schema-screen-container",onWheel:t[0]||(t[0]=Z((...C)=>o.ctrlMouseWheel&&o.ctrlMouseWheel(...C),["ctrl","prevent"]))},[m(i,{ref:"headerRef","back-url":"/dashboard"},null,512),o.loading?(_(),w("div",ps,[m(l,{name:"loading02"})])):(_(),w("div",gs,[m(c),m(d),a("div",vs,[m(u),m(h),m(p)]),m(f)])),m(g,{ref:"contextMenuRef"},null,512)],32)}var Ts=R(hs,[["render",_s]]);export{Ts as default};
