import{j as z,b as p,c as V,q as H,ad as W,ah as Pe,ai as $t,r as T,w as Ce,R as C,k as G,l as g,M as s,x as j,p as te,N as f,e as J,F as Y,s as je,a as Te,aQ as Yt,h as e,d as le,ao as Ht,L as Wt,J as qt,Q as we,P as re,z as me,O as Ee,i as Vt,A as Ge,am as Zt,aK as Je,ae as ve,af as _e,n as K,a1 as St,X as Qt,ar as ea,_ as ta,f as $e,o as aa,g as Le,K as oa,m as Dt,Y as la,aR as na,aj as sa,T as ia,y as ut}from"./vendor-c1103bdb.js";import{x as Q,n as ke,y as Ve,A as qe,s as ca,t as de,b as ua,k as ra,z as Ze,B as Z,D as rt,a as Se,u as da,f as Qe,E as ge,F as he,G as Mt,H as dt,J as mt,K as pt,L as ce,M as ue,N as ye,O as ma,P as vt,Q as _t,d as pa,R as It,w as va,e as _a,S as fa,T as ne,U as Rt,V as ga,W as ha,X as ya,Y as Tt,Z as ba,$ as xa,a0 as ft,l as ka}from"./index-71bcd248.js";import{n as q,c as Ue,S as wa,R as Ca}from"./chunk-bin-ui-design-9314e876.js";import{a as $a,g as Et,b as Va}from"./database.api-5878d93e.js";import{s as Ye,a as Sa,b as Da}from"./cross-tab-msg-ed14d683.js";import{a as Ma,d as Ia,b as Ra}from"./file-helper-d9722f4a.js";import{d as et,b as Ta,u as Lt,r as Ea,a as La,g as Ua,m as Ba,c as Na,e as Oa}from"./images.api-4400d6b9.js";import{a as Aa,b as za,g as ja,T as Pa,D as Ga,A as Me}from"./animations-4c752358.js";import"./chunk-brace-0dab6832.js";import"./chunk-bin-datav-6a4e943a.js";import"./chunk-particles.vue3-91e644a5.js";import"./chunk-three-06bdd351.js";import"./chunk-gsap-ecfb8fd4.js";import"./chunk-mockjs-03499d26.js";const Ja=Object.assign({name:"HeadLoading"},{__name:"head-loading",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{toolbar:o}=c(t),a=z(()=>o.value.loading);return(n,r)=>(p(),V("div",{class:H(["loading-indicator",{loading:a.value}])},null,2))}});var Fa=W(Ja,[["__scopeId","data-v-4ac96941"]]);function tt(){const l=Pe(),{schemaStore:t,storeToRefs:c}=Q(),{pageInfo:o,pageConfig:a,comps:n}=c(t);function r(){const h=ke(),b={template:{id:`tmp_${h}`,name:`\u6A21\u677F_${h}`},pageConfig:a.value,comps:n.value};return{templateName:`\u6A21\u677F_${h}`,pageJson:JSON.stringify(b)}}async function _(h="edit"){const{pageJson:b}=r(),x={id:o.value.id||l.query.id,name:o.value.name,pid:l.query.isShow?"1":o.value.pid,status:h,layout:JSON.stringify(a.value),components:n.value.map(m=>Ve(m.apiData)?{name:m.alias,componentType:m.componentType,componentContent:JSON.stringify(m),componentDataType:qe.static,modelId:"",x:[],y:[],drill:[],filters:[]}:{name:m.alias,componentType:m.componentType,componentDataType:m.apiData.type,modelId:m.apiData.config.modelId,componentContent:JSON.stringify(m),x:m.apiData.config.x,y:m.apiData.config.y,drill:[],filters:[]}),pageJson:b};try{return await ca(x)}catch(m){de("userSchemaStore/saveScreenData",m)}return""}async function k(){let h={};try{t.setGlobalLoading(!0);const b={pageInfo:{id:o.value.id,name:o.value.name||"\u5927\u5C4F\u9884\u89C8",pid:o.value.pid||"1"},pageConfig:a.value,comps:n.value};h=await $a(b)}catch{h={}}return t.setGlobalLoading(!1),h}return{saveScreenData:_,previewScreen:k,buildPageJson:r}}function se(l){const{schemaStore:t}=Q();t.setGlobalLoading(l)}const gt=60*1e3,Xa=Object.assign({name:"SaveScreen"},{__name:"save-screen",props:{modelValue:{type:Boolean},status:{type:String,default:"edit",validator:l=>["edit","audited"].includes(l)}},emits:["update:modelValue"],setup(l,{emit:t}){const c=t,o=l,a=z({get:()=>o.modelValue,set:d=>c("update:modelValue",d)}),{schemaStore:n,storeToRefs:r}=Q(),{pageInfo:_}=r(n),{saveScreenData:k}=tt(),h=$t(),b=Pe(),x=T([]),m=T(null),v=T(!1),w=z(()=>window.location.origin+ra(`/#/screen/${b.query.id}`));ua().then(d=>{x.value=d.data?[d.data]:[]});const $=z(()=>o.status==="edit"?"\u4FDD\u5B58\u5927\u5C4F":"\u53D1\u5E03\u5927\u5C4F");function y(){(_.value.id||b.query.id)&&k("edit").then(()=>Ye("save-success")),setTimeout(y,gt)}setTimeout(y,gt);const i=()=>{m.value.validate(async d=>{if(d){let u="";try{se(!0),v.value=!0,u=await k(o.status)}catch(A){de("save-screes/saveKanban",A)}se(!1),_.value.id=u,v.value=!1,a.value=!1,q.success({message:`${$.value}\u6210\u529F\uFF01`,showClose:!0}),Ye("save-success");let I=h.resolve({path:"/schema/screen",query:{id:u,isShow:b.query.isShow}});window.location.replace(I.href)}})},S=()=>{je(()=>{Ze(w.value)&&q.success("\u590D\u5236\u53D1\u5E03\u5730\u5740\u6210\u529F!")})};return Ce(()=>o.modelValue,d=>{d&&je(()=>{m.value&&m.value.resetFields()})}),(d,u)=>{const I=C("b-tree-select"),A=C("b-form-item"),M=C("b-input"),R=C("g-input"),U=C("b-button"),P=C("b-form"),B=C("b-modal");return p(),G(B,{modelValue:a.value,"onUpdate:modelValue":u[3]||(u[3]=N=>a.value=N),"append-to-body":"",title:$.value,top:"200px","custom-class":"schema-modal",onClose:u[4]||(u[4]=N=>a.value=!1)},{footer:g(()=>[s(U,{type:"primary",icon:"save",onClick:i,loading:v.value},{default:g(()=>[j(te($.value),1)]),_:1},8,["loading"])]),default:g(()=>[a.value?(p(),G(P,{key:0,"label-width":"100px",ref_key:"formRef",ref:m,model:f(_),"label-suffix":":"},{default:g(()=>[f(b).query.isShow?J("",!0):(p(),G(A,{key:0,label:"\u6240\u5728\u76EE\u5F55",class:"is-required"},{default:g(()=>[s(I,{data:x.value,modelValue:f(_).pid,"onUpdate:modelValue":u[0]||(u[0]=N=>f(_).pid=N),titleKey:"text","default-expand":""},null,8,["data","modelValue"])]),_:1})),s(A,{label:"\u5927\u5C4F\u540D\u79F0",prop:"name",rules:{required:!0,message:"\u5927\u5C4F\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:g(()=>[s(M,{modelValue:f(_).name,"onUpdate:modelValue":u[1]||(u[1]=N=>f(_).name=N)},null,8,["modelValue"])]),_:1}),l.status==="audited"&&d.$route.query.id?(p(),V(Y,{key:1},[s(A,{label:"\u9884\u89C8\u5730\u5740"},{default:g(()=>[s(R,{modelValue:w.value,"onUpdate:modelValue":u[2]||(u[2]=N=>w.value=N),readonly:"",type:"textarea",autosize:{minRows:3}},null,8,["modelValue"])]),_:1}),s(A,null,{default:g(()=>[s(U,{type:"text",onClick:S},{default:g(()=>[j("\u590D\u5236\u9884\u89C8\u5730\u5740")]),_:1})]),_:1})],64)):J("",!0)]),_:1},8,["model"])):J("",!0)]),_:1},8,["modelValue","title"])}}}),Ka=Object.assign({name:"SaveTemplate"},{__name:"save-template",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(l,{emit:t}){const c=t,o=l,a=z({get:()=>o.modelValue,set:v=>c("update:modelValue",v)}),{schemaStore:n,storeToRefs:r}=Q(),{pageConfig:_,comps:k}=r(n),h=T(null),b=Te({loading:!1,id:`temp_${ke()}`,name:""}),x=z(()=>({template:{id:b.id,name:b.name},pageConfig:_.value,comps:k.value})),m=async()=>{h.value&&h.value.validate(async v=>{if(v){try{se(!0),b.loading=!0;const w=x.value,$=w.template.name,y=JSON.stringify(w);await Sa({name:$,content:y})}catch(w){de("save-template/saveAsTemplate",w)}se(!1),b.loading=!1,a.value=!1,q.success({message:"\u6A21\u677F\u5DF2\u4FDD\u5B58\uFF01",showClose:!0})}})};return Ce(()=>o.modelValue,v=>{v&&(h.value&&h.value.resetFields(),b.id=`temp_${ke()}`)}),(v,w)=>{const $=C("b-input"),y=C("b-form-item"),i=C("b-form"),S=C("b-button"),d=C("b-modal");return p(),G(d,{modelValue:a.value,"onUpdate:modelValue":w[1]||(w[1]=u=>a.value=u),"append-to-body":"",title:"\u4FDD\u5B58\u4E3A\u6A21\u677F",top:"200px","custom-class":"schema-modal",onClose:w[2]||(w[2]=u=>a.value=!1)},{footer:g(()=>[s(S,{type:"primary",icon:"save",loading:b.loading,onClick:m},{default:g(()=>[j(" \u4FDD\u5B58\u6A21\u677F ")]),_:1},8,["loading"])]),default:g(()=>[s(i,{"label-width":"100px",ref_key:"formRef",ref:h,model:b,"label-suffix":":"},{default:g(()=>[s(y,{label:"\u6A21\u677F\u540D\u79F0",prop:"name",rules:{required:!0,message:"\u6A21\u677F\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:g(()=>[s($,{modelValue:b.name,"onUpdate:modelValue":w[0]||(w[0]=u=>b.name=u)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}});async function at(l){try{const t=l.clientWidth,c=l.clientHeight;return await Yt(l,{quality:.7,width:t,height:c})}catch(t){return console.error(t),""}}const Ya={class:"header-container"},Ha={class:"left-actions"},Wa={class:"head-btn home"},qa={class:"page-info"},Za={key:0},Qa={key:1,style:{color:"rgba(255, 255, 255, 0.5)"}},eo={class:"global-actions"},to={class:"head-btn"},ao={class:"head-btn",style:{"margin-left":"-1px",padding:"0 4px"}},oo={__name:"index",props:{backUrl:{type:String},backTarget:{type:String,default:"_self",validator:l=>["_self","_blank"].includes(l)},pageStatus:{type:Object,default:()=>({})}},setup(l,{expose:t}){const c=$t(),{schemaStore:o,storeToRefs:a}=Q(),{pageInfo:n,comps:r,toolbar:_,undoDisable:k,redoDisable:h,pageConfig:b,areaData:x}=a(o),{buildPageJson:m,previewScreen:v}=tt(),w=T(!1),$=T("edit"),y=T(!1),i=R=>R.type!=="application/json"?(q.warning("\u8BF7\u9009\u62E9\u6B63\u786E\u7684json\u914D\u7F6E\u6587\u4EF6"),!1):(Ma(R).then(U=>{try{const P=JSON.parse(U),{comps:B,pageConfig:N}=P;o.loadScreenData({comps:B,pageConfig:N})}catch{console.warn("The imported file could not be converted to the correct JSON!")}}),!1),S=()=>{const{templateName:R,pageJson:U}=m();Ia(U,`${R}.json`),q.success({message:"\u6A21\u677F\u6587\u4EF6\u5DF2\u4FDD\u5B58\uFF01",showClose:!0})},d=()=>{$.value="edit",w.value=!0},u=()=>{$.value="audited",w.value=!0},I=async()=>{const R=await v();let U=c.resolve({path:`/screen/preview/${R.pageInfo.id}`});window.open(U.href,"_blank")};function A(R){R==="saveImage"?M():R==="saveTpl"&&(y.value=!0)}async function M(){se(!0),o.selectCom(),x.value.showArea=!1,q.warning("\u6B63\u5728\u5BFC\u51FA\u56FE\u7247\uFF0C\u8BF7\u52FF\u8FDB\u884C\u5176\u4ED6\u64CD\u4F5C\uFF01");try{const R=document.getElementById("canvas-components"),U=await at(R),P=document.createElement("a");P.download=(n.value.name||"\u770B\u677F\u9884\u89C8")+".jpeg",P.href=U,P.click()}catch(R){console.error(R),q.warning("\u56FE\u7247\u5BFC\u51FA\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\u3002")}se(!1)}return t({handleSaveScreen:d,handlePublish:u,handPreview:I}),(R,U)=>{const P=C("b-icon"),B=C("b-tooltip"),N=C("b-divider"),O=C("b-space"),E=C("b-upload"),D=C("b-dropdown-item"),L=C("b-dropdown-menu"),F=C("b-dropdown");return p(),V(Y,null,[e("div",Ya,[e("div",Ha,[e("div",Wa,[s(P,{name:"home"})]),e("div",qa,[f(n).name?(p(),V("span",Za,te(f(n).name),1)):(p(),V("span",Qa,"\u672A\u547D\u540D\u5927\u5C4F"))]),s(O,null,{default:g(()=>[s(B,{content:"\u56FE\u5C42"},{default:g(()=>[e("div",{class:H(["head-btn",{active:f(_).layer}]),onClick:U[0]||(U[0]=X=>f(o).toggleLayerPanel())},[s(P,{name:"container"})],2)]),_:1}),s(B,{content:"\u914D\u7F6E\u9762\u677F"},{default:g(()=>[e("div",{class:H(["head-btn",{active:f(_).config}]),onClick:U[1]||(U[1]=X=>f(o).toggleConfigPanel())},[s(P,{name:"control"})],2)]),_:1}),s(N,{type:"vertical"}),s(B,{content:"\u540E\u9000"},{default:g(()=>[e("div",{class:H(["head-btn",{disabled:f(k)}]),onClick:U[2]||(U[2]=(...X)=>R.undo&&R.undo(...X))},[s(P,{name:"arrowleft"})],2)]),_:1}),s(B,{content:"\u524D\u8FDB"},{default:g(()=>[e("div",{class:H(["head-btn",{disabled:f(h)}]),onClick:U[3]||(U[3]=(...X)=>R.redo&&R.redo(...X))},[s(P,{name:"arrowright"})],2)]),_:1})]),_:1})]),e("div",eo,[s(O,null,{default:g(()=>[s(B,{content:"\u5BFC\u5165json (\u4F1A\u8986\u76D6\u6240\u6709\u5185\u5BB9\uFF01)"},{default:g(()=>[s(E,{action:"/","show-upload-list":!1,"before-upload":i},{default:g(()=>[e("div",to,[s(P,{name:"Import"})])]),_:1})]),_:1}),s(B,{content:"\u5BFC\u51FAjson"},{default:g(()=>[e("div",{class:"head-btn",onClick:S},[s(P,{name:"export"})])]),_:1}),s(N,{type:"vertical"}),e("div",null,[e("div",{class:"head-btn",onClick:d},[s(P,{name:"save",color:"var(--bin-color-primary)"}),j(" \xA0\u4FDD\xA0\u5B58 ")]),s(F,{trigger:"hover",onCommand:A},{dropdown:g(()=>[s(L,null,{default:g(()=>[s(D,{name:"saveTpl"},{default:g(()=>[j("\u4FDD\u5B58\u6A21\u677F")]),_:1}),s(D,{name:"saveImage"},{default:g(()=>[j("\u4FDD\u5B58\u56FE\u7247")]),_:1})]),_:1})]),default:g(()=>[e("div",ao,[s(P,{name:"ellipsis"})])]),_:1})]),s(N,{type:"vertical"}),s(B,{content:"\u9884\u89C8"},{default:g(()=>[e("div",{class:"head-btn",onClick:I},[s(P,{name:"eye",color:"var(--bin-color-primary)"}),j(" \xA0\u9884\xA0\u89C8 ")])]),_:1}),s(B,{content:"\u53D1\u5E03"},{default:g(()=>[e("div",{class:"head-btn",onClick:u},[s(P,{name:"send",color:"var(--bin-color-primary)"}),j(" \xA0\u53D1\xA0\u5E03 ")])]),_:1})]),_:1})])]),s(Fa),s(Xa,{modelValue:w.value,"onUpdate:modelValue":U[4]||(U[4]=X=>w.value=X),status:$.value},null,8,["modelValue","status"]),s(Ka,{modelValue:y.value,"onUpdate:modelValue":U[5]||(U[5]=X=>y.value=X)},null,8,["modelValue"])],64)}}};var lo=W(oo,[["__scopeId","data-v-863b7836"]]);const no={name:"VBasicBar",alias:"\u67F1\u56FE",img:Z("basic-bar.svg")},so={name:"VHorizontalBar",alias:"\u6761\u5F62\u56FE",img:Z("hori-basic-bar.svg")},io={name:"VCapsuleBar",alias:"\u80F6\u56CA\u67F1\u56FE",img:Z("capsule-bar.svg")},co={name:"VBasicLine",alias:"\u6298\u7EBF\u56FE",img:Z("basic-line.svg")},uo={name:"VBasicArea",alias:"\u533A\u57DF\u56FE",img:Z("basic-area.svg")},ro={name:"VBasicPie",alias:"\u997C\u56FE",img:Z("basic-pie.svg")},mo={name:"VBasicRing",alias:"\u73AF\u56FE",img:Z("basic-ring.svg")},po={name:"VBasicRadar",alias:"\u96F7\u8FBE\u56FE",img:Z("basic-radar.svg")},vo={name:"VBasicMap",alias:"\u4E2D\u56FD\u5730\u56FE",img:Z("2d-china.svg")},_o={name:"VBasicMapEvo",alias:"\u7701\u4EFD\u5730\u56FE",img:Z("basic-map-evo.svg")},fo={name:"VBasicScatter",alias:"\u6563\u70B9\u56FE",img:Z("basic-scatter.svg")},go={name:"VLineBasicScatter",alias:"\u6563\u70B9\u7EBF\u56FE",img:Z("line-basic-scatter.svg")},ho={name:"VBasicBoxplot",alias:"\u76D2\u987B\u56FE",img:Z("basic-boxplot.svg")},yo={name:"VBasicFunnel",alias:"\u6F0F\u6597\u56FE",img:Z("basic-funnel.svg")},bo={name:"VBasicWordCloud",alias:"\u8BCD\u4E91\u56FE",img:Z("basic-wordcloud.svg")},xo={name:"VBasicGauge",alias:"\u4EEA\u8868\u76D8",img:Z("basic-gauge.svg")},ko={name:"VProgressCircle",alias:"\u8FDB\u5EA6\u73AF",img:Z("pie-one-value.svg")},wo={name:"VNumberTitleFlop",alias:"\u6570\u5B57\u6307\u6807",img:Z("number-title-flop.svg")},Co={name:"VTimer",alias:"\u65F6\u95F4\u5668",img:Z("timer.svg")},$o={name:"VSelect",alias:"\u4E0B\u62C9\u63A7\u4EF6",img:Z("select.svg")},Vo={name:"VButton",alias:"\u6309\u94AE",img:Z("img.svg")},So={name:"VDatePicker",alias:"\u65E5\u671F\u9009\u62E9",img:Z("timer.svg")},Do={name:"VMainTitle",alias:"\u6807\u9898",img:Z("main-title.svg")},Mo={name:"VBgBox",alias:"\u80CC\u666F\u5757",img:Z("bg-box.svg")},Io={name:"VBorderBox",alias:"\u8FB9\u6846",img:Z("border-box.svg")},Ro={name:"VMainImg",alias:"\u5355\u5F20\u56FE\u7247",img:Z("img.svg")},To={name:"VIcon",alias:"\u56FE\u6807",img:Z("icon.svg")},Eo={name:"VScrollTable",alias:"\u6EDA\u52A8\u8868\u683C",img:Z("scroll-table.svg")},Lo={name:"VEarth3d",alias:"\u70B9\u9635\u5730\u7403",img:Z("earth.svg")},Uo={name:"VLightEarth3d",alias:"\u53D1\u5149\u5730\u7403",img:Z("light-earth.svg")},Bo={name:"VCube3d",alias:"3d\u7ACB\u65B9\u4F53",img:Z("cube.svg")},No={name:"VBuilding3d",alias:"\u5EFA\u7B51\u626B\u63CF",img:Z("building.svg")},Oo=[{type:"basic",name:"\u57FA\u7840",icon:"block",group:[{name:"\u6587\u672C",comps:[Do]},{name:"\u63A7\u4EF6",comps:[$o,Co,Vo,So]},{name:"\u5217\u8868",comps:[Eo]},{name:"\u66F4\u591A",comps:[Ro,Mo,Io,To]}]},{type:"analysis",name:"\u5206\u6790",icon:"barchart",group:[{name:"\u6307\u6807",comps:[wo,ko]},{name:"\u67F1\u56FE",comps:[no,so,io]},{name:"\u7EBF\u56FE",comps:[co,uo]},{name:"\u997C\u56FE",comps:[ro,mo]},{name:"\u6563\u70B9\u56FE",comps:[fo,go]},{name:"\u96F7\u8FBE\u56FE",comps:[po]},{name:"\u5730\u56FE",comps:[vo,_o]},{name:"\u66F4\u591A",comps:[ho,yo,bo,xo]}],comps:[]},{type:"topology",name:"\u7EC4\u6001",icon:"cluster",group:[],comps:[]},{type:"presets",name:"\u88C5\u9970",icon:"highlight",group:[],comps:[]},{type:"3D",name:"3D",icon:"earth",group:[{name:"\u9884\u8BBE\u6A21\u578B",comps:[Lo,Uo,Bo,No]}],comps:[]},{type:"images",name:"\u56FE\u7247",icon:"image",group:[],comps:[]},{type:"comps",name:"\u7EC4\u4EF6",icon:"star",group:[],comps:[]}];const Ao={key:0,class:"comp-wrap"},zo=["title"],jo={class:"inner"},Po=["onDragstart","onClick"],Go=["src"],Jo={class:"comp-item-text"},Fo={__name:"comps",props:{comps:{type:Array,default:()=>[]}},emits:["dragstart","click"],setup(l,{emit:t}){const c=t,o=(n,r)=>c("dragstart",n,r),a=n=>c("click",n);return(n,r)=>l.comps.length>0?(p(),V("div",Ao,[(p(!0),V(Y,null,le(l.comps,(_,k)=>(p(),V("div",{class:"comp-item",key:k,title:_.alias},[e("div",jo,[e("div",{class:"comp-item-img",draggable:!0,onDragstart:h=>o(h,_.name),onClick:h=>a(_.name)},[e("img",{src:_.img},null,8,Go)],40,Po),e("div",Jo,te(_.alias),1)])],8,zo))),128))])):J("",!0)}};var ht=W(Fo,[["__scopeId","data-v-0e514aa6"]]);function Be(){const l=Ht(),t=T("");function c(o){t.value===o?t.value="":t.value=o}l.on("item-click",c),Wt("collapse",{activeGroupKey:t,collapseMitt:l})}function Xo(l){const t=qt("collapse"),c=t==null?void 0:t.collapseMitt,o=z(()=>(t==null?void 0:t.activeGroupKey.value)===l.name);function a(n){c==null||c.emit("item-click",n)}return{isActive:o,triggerClick:a}}const Ko={class:"collapse-group"},Yo={class:"name"},Ho={class:"wrap-label"},Wo={key:1},qo={key:0,class:"wrap-edit"},Zo={class:"content"},Qo={__name:"collapse",props:{title:{type:String,required:!0},name:{type:[String,Number,Object],required:!0},canEdit:{type:Boolean,default:!1}},emits:["edit","remove"],setup(l,{emit:t}){const c=t,o=l,{isActive:a,triggerClick:n}=Xo(o),r=T(!1),_=T("");let k="";function h(){n(o.name)}function b(){r.value=!0,_.value=o.title,k=o.title}function x($){const y=($.target.value||"").trim();(!y||y===k)&&(r.value=!1)}function m($){($.target.value||"").trim()?v():r.value=!1}function v(){r.value=!1,c("edit",_.value)}const w=()=>c("remove");return($,y)=>{const i=C("b-input"),S=C("b-icon"),d=C("b-collapse-transition"),u=we("focus");return p(),V("div",Ko,[e("div",{class:H(["header",[{active:f(a)}]]),flex:"cross:center",onClick:h},[e("div",Yo,[e("div",Ho,[r.value?(p(),V("div",{key:0,class:"create-box",onClick:y[1]||(y[1]=re(()=>{},["stop"]))},[me(s(i,{modelValue:_.value,"onUpdate:modelValue":y[0]||(y[0]=I=>_.value=I),placeholder:"\u8F93\u5165\u540D\u79F0\uFF0C\u56DE\u8F66\u521B\u5EFA",size:"mini",style:{width:"150px",top:"-2px"},onBlur:x,onKeyup:Ee(m,["enter"])},null,8,["modelValue"]),[[u]])])):(p(),V("div",Wo,te(l.title),1))]),l.canEdit&&!r.value?(p(),V("span",qo,[e("i",{class:"b-iconfont b-icon-edit",onClick:re(b,["stop"])}),e("i",{class:"b-iconfont b-icon-delete",onClick:re(w,["stop"])})])):J("",!0),e("span",{class:H(["wrap-arrow",[{active:f(a)}]])},[s(S,{name:"right",size:"12"})],2)])],2),s(d,null,{default:g(()=>[me(e("div",Zo,[Vt($.$slots,"default",{},void 0,!0)],512),[[Ge,f(a)]])]),_:3})])}}};var Ne=W(Qo,[["__scopeId","data-v-1646784e"]]);const el={class:"group-comps"},tl={class:"comp-wrap"},al={class:"inner"},ol=["onDragstart","onClick"],ll={key:0},nl={key:1},sl=["title"],il={__name:"topo-item",props:{groupId:{type:String,required:!0}},emits:["dragstart","click"],setup(l,{emit:t}){const c=t,o=l,a=T([]),n=T(!1);async function r(b){try{const x=rt(`/${b}/index.json`);return(await Zt.get(x)).data.map(w=>({...w,group:b,src:rt(`/${b}/${w.src}`)}))}catch{return[]}}async function _(){n.value=!0;try{a.value=await r(o.groupId)}catch(b){de(b)}n.value=!1}_();const k=(b,x)=>c("dragstart",b,x),h=b=>c("click",b);return(b,x)=>{const m=we("lazy");return p(),V("div",el,[e("div",tl,[(p(!0),V(Y,null,le(a.value,(v,w)=>(p(),V("div",{class:"comp-item",key:w},[e("div",al,[e("div",{class:"comp-item-img",draggable:!0,onDragstart:$=>k($,v),onClick:$=>h(v)},[n.value?me((p(),V("img",nl,null,512)),[[m,v.url?v.url:v.src]]):me((p(),V("img",ll,null,512)),[[m,v.url?v.url:v.src]])],40,ol),e("div",{class:"comp-item-text",title:JSON.stringify(v,null,2)},te(v.name),9,sl)])]))),128))])])}}};var cl=W(il,[["__scopeId","data-v-63637a63"]]);const ul={class:"group-wrap"},rl={class:"group-list"},dl={__name:"topo-list",emits:["dragstart","click"],setup(l,{emit:t}){const c=t,o=T([{key:"pipe",value:"\u7BA1\u7EBF"},{key:"electric",value:"\u7535\u529B"},{key:"blower",value:"\u98CE\u673A"},{key:"gate",value:"\u9600\u95E8"},{key:"twyer",value:"\u9F13\u98CE\u673A"},{key:"boiler",value:"\u9505\u7089"},{key:"cooler",value:"\u51B7\u5374\u5668"},{key:"light",value:"\u6307\u793A\u706F"},{key:"meter",value:"\u4EEA\u8868"},{key:"motor",value:"\u9A6C\u8FBE"},{key:"building",value:"\u5EFA\u7B51"},{key:"sewage",value:"\u6C61\u6C34\u5904\u7406"},{key:"icon",value:"2.5D-2D\u56FE\u6807"},{key:"city",value:"\u57CE\u5E02\u56FE\u6807"}]);Be();const a=(r,_)=>c("dragstart",r,_),n=r=>c("click",r);return(r,_)=>{const k=C("b-scrollbar");return p(),V("div",ul,[e("div",rl,[s(k,{native:""},{default:g(()=>[(p(!0),V(Y,null,le(o.value,h=>(p(),G(Ne,{key:h.key,name:h.key,title:h.value,"can-edit":!1},{default:g(()=>[s(cl,{"group-id":h.key,onDragstart:a,onClick:n},null,8,["group-id"])]),_:2},1032,["name","title"]))),128))]),_:1})])])}}};var ml=W(dl,[["__scopeId","data-v-738295d1"]]);const pl={class:"group-comps"},vl={class:"comp-wrap"},_l={key:0,class:"comp-item img-add"},fl={class:"inner"},gl={class:"comp-item-img"},hl={class:"inner"},yl=["onDragstart","onClick"],bl={key:0},xl={key:1},kl={key:2,class:"hover-layer"},wl=["onClick"],Cl=["title"],$l={__name:"images-item",props:{groupId:{type:String,required:!0}},emits:["dragstart","click"],setup(l,{emit:t}){const c=t,o=l,a=T([]),n=z(()=>!et.includes(o.groupId)),r=T(!1),_=T(!1);async function k(){_.value=!0;try{a.value=await Ta(o.groupId)}catch(v){de(v)}_.value=!1}k();async function h(v){r.value=!0;try{const w=v.map($=>({groupKey:o.groupId,name:$.name,attr:{w:$.width,h:$.height},src:$.image}));await Lt(w),k()}catch(w){console.log(w)}r.value=!1}async function b({groupKey:v,id:w}){Ue.confirm({type:"warning",title:"\u63D0\u793A",message:"\u662F\u5426\u5220\u9664\u5F53\u524D\u56FE\u7247\uFF1F"}).then(async()=>{await Ea(v,w),k()}).catch($=>{console.log($)})}const x=(v,w)=>c("dragstart",v,w),m=v=>c("click",v);return(v,w)=>{const $=C("g-upload"),y=C("g-loading"),i=we("lazy");return p(),V("div",pl,[e("div",vl,[n.value?(p(),V("div",_l,[e("div",fl,[e("div",gl,[r.value?(p(),G(y,{key:1,spinning:""})):(p(),G($,{key:0,onUpload:h,multiple:""}))])])])):J("",!0),(p(!0),V(Y,null,le(a.value,(S,d)=>(p(),V("div",{class:"comp-item",key:d},[e("div",hl,[e("div",{class:H(["comp-item-img",{"can-edit":n.value}]),draggable:!0,onDragstart:u=>x(u,S),onClick:u=>m(S)},[_.value?me((p(),V("img",xl,null,512)),[[i,S.url?S.url:S.src]]):me((p(),V("img",bl,null,512)),[[i,S.url?S.url:S.src]]),n.value?(p(),V("div",kl,[e("i",{class:"b-iconfont b-icon-delete-fill",title:"\u5220\u9664\u56FE\u7247",onClick:re(u=>b(S),["stop"])},null,8,wl)])):J("",!0)],42,yl),e("div",{class:"comp-item-text",title:JSON.stringify(S,null,2)},te(S.name),9,Cl)])]))),128))])])}}};var Ut=W($l,[["__scopeId","data-v-3ac936ec"]]);const Vl={class:"group-wrap"},Sl={class:"group-list"},Dl={__name:"preset-list",emits:["dragstart","click"],setup(l,{emit:t}){const c=t,o=T(La);Be();const a=(r,_)=>c("dragstart",r,_),n=r=>c("click",r);return(r,_)=>{const k=C("b-scrollbar");return p(),V("div",Vl,[e("div",Sl,[s(k,{native:""},{default:g(()=>[(p(!0),V(Y,null,le(o.value,h=>(p(),G(Ne,{key:h.key,name:h.key,title:h.value,"can-edit":!1},{default:g(()=>[s(Ut,{"group-id":h.key,onDragstart:a,onClick:n},null,8,["group-id"])]),_:2},1032,["name","title"]))),128))]),_:1})])])}}};var Ml=W(Dl,[["__scopeId","data-v-1a5b979a"]]);const Il={class:"group-wrap"},Rl={class:"group-list"},Tl={key:0},El={key:1,class:"create-box"},Ll={class:"create-group"},Ul={__name:"images-list",emits:["dragstart","click"],setup(l,{emit:t}){const c=t,o=T([]),a=T(!1);Be();const n=T({key:"",value:""}),r=Te({create:!1,edit:!1}),_=async()=>{a.value=!0;try{o.value=await Ua()}catch($){de("images-list/getCompList",$)}a.value=!1};_();function k(){n.value={key:`group_images_${ke()}`,value:""},r.create=!0}function h($){if(!r.create)return;($.target.value||"").trim()?m():r.create=!1}async function b($,y){try{se(!0);const i={key:$.key,value:y};await Ba(i),_(),q.success("\u4FEE\u6539\u6210\u529F")}catch(i){de("images-list/modifyGroup",i)}se(!1)}async function x($){try{await Ue.confirm({type:"error",title:"\u63D0\u793A",message:"\u786E\u5B9A\u79FB\u9664\u5F53\u524D\u56FE\u7247\u5206\u7EC4\u5417\uFF1F"}),se(!0),await Na($.key),_(),q.success("\u5220\u9664\u6210\u529F\uFF01")}catch(y){de("images-list/removeGroup",y)}se(!1)}async function m(){try{se(!0),await Oa(n.value),_(),r.create=!1,q.success("\u65B0\u589E\u6210\u529F\uFF01")}catch($){de("images-list/addGroup",$)}se(!1)}const v=($,y)=>c("dragstart",$,y),w=$=>c("click",$);return($,y)=>{const i=C("g-loading"),S=C("b-empty"),d=C("b-input"),u=C("b-scrollbar"),I=C("b-button"),A=we("focus");return p(),V("div",Il,[e("div",Rl,[s(u,{native:""},{default:g(()=>[a.value?(p(),V("div",Tl,[s(i,{spinning:""})])):(p(),V(Y,{key:1},[o.value.length===0?(p(),G(S,{key:0},{default:g(()=>[j("\u6682\u65E0\u56FE\u7247\u5206\u7EC4")]),_:1})):J("",!0),(p(!0),V(Y,null,le(o.value,M=>(p(),G(Ne,{key:M.key,name:M.key,title:M.value,"can-edit":!f(et).includes(M.key),onEdit:R=>b(M,R),onRemove:R=>x(M)},{default:g(()=>[s(Ut,{"group-id":M.key,onDragstart:v,onClick:w},null,8,["group-id"])]),_:2},1032,["name","title","can-edit","onEdit","onRemove"]))),128)),r.create?(p(),V("div",El,[me(s(d,{modelValue:n.value.value,"onUpdate:modelValue":y[0]||(y[0]=M=>n.value.value=M),placeholder:"\u8F93\u5165\u540D\u79F0\uFF0C\u56DE\u8F66\u521B\u5EFA",size:"small",onBlur:h,onKeyup:Ee(h,["enter"])},null,8,["modelValue"]),[[A]])])):J("",!0)],64))]),_:1})]),e("div",Ll,[s(I,{type:"primary",size:"small",transparent:"",onClick:k},{default:g(()=>[j(" \u521B\u5EFA\u56FE\u7247\u5206\u7EC4 ")]),_:1})])])}}};var Bl=W(Ul,[["__scopeId","data-v-7193e08d"]]);const Bt=[];Bt.map(l=>l.key);const Nt="COMPS_GROUP",Ot="COMPS_LIB",Fe=async()=>Je.getItem(Nt),Xe=async l=>Je.setItem(Nt,Se(l)),ot=async()=>Je.getItem(Ot),He=async l=>Je.setItem(Ot,Se(l));async function At(){try{const l=await Fe();if(l)return l;const t=Se(Bt);return await Xe(t),t}catch{return[]}}async function Nl(l){try{const t=await Fe();return t?(t.push(l),await Xe(t),!0):!1}catch{return!1}}async function Ol(l){try{const t=await Fe();if(t){const c=Qe(t,l.key,"key");return t[c].value=l.value,await Xe(t),l.key}return!1}catch{return!1}}async function Al(l){try{const t=await Fe();if(t){const c=Qe(t,l,"key");return t.splice(c,1),await Xe(t),!0}return!1}catch{return!1}}async function zl(l,t,c){try{const o={id:da(),group:l,comp:t,src:c},a=await ot();return a?(a.push(o),await He(a),!0):(await He([o]),!1)}catch{return!1}}async function jl(l){try{const t=await ot();return t?t.filter(c=>c.group===l):[]}catch{return[]}}async function Pl(l,t){try{const c=await ot();if(c){const o=c.filter(n=>n.group===l),a=Qe(o,t);return o.splice(a,1),await He(o),!0}return!1}catch{return!1}}const Gl={class:"group-comps"},Jl={key:1,class:"comp-wrap"},Fl={class:"inner"},Xl=["onDragstart","onClick"],Kl={key:0},Yl={key:1},Hl={class:"hover-layer"},Wl=["onClick"],ql={class:"comp-item-text"},Zl={__name:"comp-item",props:{groupId:{type:String,required:!0}},emits:["dragstart","click"],setup(l,{emit:t}){const c=t,o=l,a=T([]),n=T(!1);async function r(){n.value=!0;try{a.value=await jl(o.groupId)}catch(b){de(b)}n.value=!1}ge.on(he.SaveCompSuccess,r),r();async function _({group:b,id:x}){try{se(!0),await Pl(b,x),r()}catch(m){console.log(m)}se(!1)}const k=(b,x)=>c("dragstart",b,x),h=b=>c("click",b);return(b,x)=>{const m=C("b-empty"),v=we("lazy");return p(),V("div",Gl,[a.value.length===0?(p(),G(m,{key:0},{default:g(()=>[j("\u6682\u65E0\u7EC4\u4EF6")]),_:1})):(p(),V("div",Jl,[(p(!0),V(Y,null,le(a.value,(w,$)=>(p(),V("div",{class:"comp-item",key:$},[e("div",Fl,[e("div",{class:"comp-item-img",draggable:!0,onDragstart:y=>k(y,w.comp),onClick:y=>h(w.comp)},[n.value?me((p(),V("img",Yl,null,512)),[[v,w.thumbnail]]):me((p(),V("img",Kl,null,512)),[[v,w.thumbnail]]),e("div",Hl,[e("i",{class:"b-iconfont b-icon-delete-fill",title:"\u5220\u9664\u7EC4\u4EF6",onClick:re(y=>_(w),["stop"])},null,8,Wl)])],40,Xl),e("div",ql,te(w.comp.alias),1)])]))),128))]))])}}};var Ql=W(Zl,[["__scopeId","data-v-36dce380"]]);const en={class:"group-wrap"},tn={class:"group-list"},an={key:0},on={key:1,class:"create-box"},ln={class:"create-group"},nn={__name:"comp-list",emits:["dragstart","click"],setup(l,{emit:t}){const c=t,o=T([]),a=T(!1);Be();const n=T({key:"",value:""}),r=Te({create:!1,edit:!1}),_=async()=>{a.value=!0;try{o.value=await At()}catch($){de("comp-list/getCompList",$)}a.value=!1};_();function k(){n.value={key:`group_comp_${ke()}`,value:""},r.create=!0}function h($){if(!r.create)return;($.target.value||"").trim()?m():r.create=!1}async function b($,y){try{se(!0);const i={key:$.key,value:y};await Ol(i),_(),q.success("\u4FEE\u6539\u6210\u529F")}catch(i){de("comp-list/modifyGroup",i)}se(!1)}async function x($){try{await Ue.confirm({type:"error",title:"\u63D0\u793A",message:"\u786E\u5B9A\u79FB\u9664\u5F53\u524D\u7EC4\u4EF6\u5206\u7EC4\u5417\uFF1F"}),se(!0),await Al($.key),_(),q.success("\u5220\u9664\u6210\u529F\uFF01")}catch(y){de("comp-list/removeGroup",y)}se(!1)}async function m(){try{se(!0),await Nl(n.value),_(),r.create=!1,q.success("\u65B0\u589E\u6210\u529F\uFF01")}catch($){de("comp-list/addGroup",$)}se(!1)}const v=($,y)=>c("dragstart",$,y),w=$=>c("click",$);return($,y)=>{const i=C("g-loading"),S=C("b-empty"),d=C("b-input"),u=C("b-scrollbar"),I=C("b-button"),A=we("focus");return p(),V("div",en,[e("div",tn,[s(u,{native:""},{default:g(()=>[a.value?(p(),V("div",an,[s(i,{spinning:""})])):(p(),V(Y,{key:1},[o.value.length===0?(p(),G(S,{key:0},{default:g(()=>[j("\u6682\u65E0\u7EC4\u4EF6\u5E93")]),_:1})):J("",!0),(p(!0),V(Y,null,le(o.value,M=>(p(),G(Ne,{key:M.key,name:M.key,title:M.value,"can-edit":!f(et).includes(M.key),onEdit:R=>b(M,R),onRemove:R=>x(M)},{default:g(()=>[s(Ql,{"group-id":M.key,onDragstart:v,onClick:w},null,8,["group-id"])]),_:2},1032,["name","title","can-edit","onEdit","onRemove"]))),128)),r.create?(p(),V("div",on,[me(s(d,{modelValue:n.value.value,"onUpdate:modelValue":y[0]||(y[0]=M=>n.value.value=M),placeholder:"\u8F93\u5165\u540D\u79F0\uFF0C\u56DE\u8F66\u521B\u5EFA",size:"small",onBlur:h,onKeyup:Ee(h,["enter"])},null,8,["modelValue"]),[[A]])])):J("",!0)],64))]),_:1})]),e("div",ln,[s(I,{type:"primary",size:"small",transparent:"",onClick:k},{default:g(()=>[j(" \u521B\u5EFA\u7EC4\u4EF6\u5206\u7EC4 ")]),_:1})])])}}};var sn=W(nn,[["__scopeId","data-v-35077b8f"]]);const zt=l=>(ve("data-v-5c54fac0"),l=l(),_e(),l),cn={class:"components-panel"},un=zt(()=>e("div",{class:"panel-title"},[e("span",{class:"panel-text"},"\u7EC4\u4EF6")],-1)),rn={class:"components-type"},dn=["onClick"],mn={class:"com-tab-title"},pn={class:"components-list"},vn=zt(()=>e("i",{class:"b-iconfont b-icon-left",title:"\u6536\u8D77"},null,-1)),_n=[vn],fn={class:"components-list-content"},gn={__name:"index",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{pageConfig:o,toolbar:a}=c(t),n=T({});Be();const r=z(()=>{var d,u;return(u=(d=n.value)==null?void 0:d.group)!=null?u:[]}),_=z(()=>{var d,u;return(u=(d=n.value)==null?void 0:d.comps)!=null?u:[]});function k(d){if(n.value.type===d.type&&a.value.components){t.toggleCompsPanel(!1),n.value={};return}t.toggleCompsPanel(!0),n.value=Se(d)}function h(d,u){d.dataTransfer.setData("normal-comp",u)}async function b(d){try{const u=Mt(d);if(u.attr.x=Math.floor((o.value.width-u.attr.w)/2),u.attr.y=Math.floor((o.value.height-u.attr.h)/2),u.apiData&&u.apiData.type===qe.static&&u.apiData.staticPath){const{data:I}=await Et(u.id,u.apiData.staticPath);u.apiData.config.data=JSON.stringify(I)}t.addCom({component:u}),t.selectCom(u)}catch(u){console.log(u)}}function x(d,u){d.dataTransfer.setData("image-comp",JSON.stringify(dt(u)))}function m(d){const u=dt(d);u.attr.x=Math.floor((o.value.width-u.attr.w)/2),u.attr.y=Math.floor((o.value.height-u.attr.h)/2),t.addCom({component:u}),t.selectCom(u)}function v(d,u){d.dataTransfer.setData("image-comp",JSON.stringify(mt(u)))}function w(d){const u=mt(d);u.attr.x=Math.floor((o.value.width-u.attr.w)/2),u.attr.y=Math.floor((o.value.height-u.attr.h)/2),t.addCom({component:u}),t.selectCom(u)}function $(d,u){d.dataTransfer.setData("custom-comp",JSON.stringify(pt(JSON.parse(u))))}function y(d){const u=pt(JSON.parse(d));t.addCom({component:u}),t.selectCom(u)}function i(d){d.preventDefault(),d.stopPropagation(),d.dataTransfer.dropEffect="none"}function S(){a.value.components&&t.toggleCompsPanel(!1)}return(d,u)=>{const I=C("b-icon"),A=C("b-scrollbar");return p(),V("div",{class:H(["components-panel-wp",{"is-hide":!f(a).components}])},[e("div",cn,[un,e("div",{class:"components-panel-content",onDragover:i},[e("div",rn,[s(A,{native:""},{default:g(()=>[(p(!0),V(Y,null,le(f(Oo),(M,R)=>(p(),V("div",{class:H(["components-item",{active:n.value.type===M.type}]),key:R,onClick:U=>k(M)},[s(I,{class:"com-tab-icon",name:M.icon},null,8,["name"]),e("span",mn,te(M.name),1)],10,dn))),128))]),_:1})])],32),me(e("div",pn,[e("div",{class:"components-list-top"},[e("div",{class:"action",onClick:S},_n)]),e("div",fn,[s(A,{native:""},{default:g(()=>[(p(!0),V(Y,null,le(r.value,(M,R)=>(p(),G(Ne,{key:R,name:R,title:M.name},{default:g(()=>[s(ht,{comps:M.comps,onDragstart:h,onClick:b},null,8,["comps"])]),_:2},1032,["name","title"]))),128)),s(ht,{comps:_.value,onDragstart:h,onClick:b},null,8,["comps"]),n.value.type==="topology"?(p(),G(ml,{key:0,onDragstart:x,onClick:m})):J("",!0),n.value.type==="presets"?(p(),G(Ml,{key:1,onDragstart:v,onClick:w})):J("",!0),n.value.type==="images"?(p(),G(Bl,{key:2,onDragstart:v,onClick:w})):J("",!0),n.value.type==="comps"?(p(),G(sn,{key:3,onDragstart:$,onClick:y})):J("",!0)]),_:1})])],512),[[Ge,f(a).components]])])],2)}}};var hn=W(gn,[["__scopeId","data-v-5c54fac0"]]);const Ie=Te({x:0,y:0});function lt(l={}){const{schemaStore:t,storeToRefs:c}=Q(),{contextMenu:o,selectedCom:a,selectedComIds:n}=c(t),r=z(()=>{var x;return(x=a.value)==null?void 0:x.locked}),_=z(()=>{var x;return(x=a.value)==null?void 0:x.hided}),k=z(()=>({left:`${Ie.x+10}px`,top:`${Ie.y+10}px`,transform:document.documentElement.clientHeight-Ie.y<370?"translate(0px, -100%)":""})),h=async x=>{x.preventDefault(),a.value||n.value.length>1?(Ie.x=x.clientX,Ie.y=x.clientY,o.value.show=!0,ce(document,"click",b)):b()},b=()=>{ue(document,"click",b),l&&l.beforeClose&&l.beforeClose(),o.value.show=!1};return{showMenu:h,isLocked:r,isHided:_,contextMenu:o,contextMenuStyle:k}}const jt=l=>(ve("data-v-b463b3ac"),l=l(),_e(),l),yn={class:"layer-panel"},bn={class:"layer-top"},xn=jt(()=>e("div",{class:"layer-num pl-10"},"\u56FE\u5C42",-1)),kn=jt(()=>e("i",{class:"b-iconfont b-icon-left",title:"\u6536\u8D77"},null,-1)),wn=[kn],Cn={class:"layer-toolbar layer-toolbar-top"},$n={class:"layer-manager-wrap"},Vn={class:"layer-wrap"},Sn=["title","onMousedown","onMouseenter","onDblclick"],Dn=["onUpdate:modelValue"],Mn={key:1,class:"layer-item-span"},In={class:"layer-item-text"},Rn=["title","onClick"],Tn=["title","onClick"],En={key:0,class:"group-list pl-16"},Ln=["title","onMouseenter","onMousedown"],Un={class:"layer-item-span"},Bn={class:"layer-item-text"},Nn={__name:"index",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{comps:o,toolbar:a,hoveredComId:n,selectedCom:r,renamingComId:_,isMultiSelect:k,selectedComs:h}=c(t),{showMenu:b}=lt(),x=z(()=>!!r.value),m=z(()=>({opacity:r.value?1:.5}));function v(R){return k.value?h.value.map(U=>U.id).includes(R.id):!Ve(r.value)&&r.value.id===R.id}const w=z({get:()=>[...o.value].reverse(),set:R=>o.value=R.reverse()}),$=R=>{r.value&&t.moveCom({id:r.value.id,moveType:R})},y=()=>$(ye.up),i=()=>$(ye.down),S=()=>$(ye.top),d=()=>$(ye.bottom),u=R=>t.hoverCom(R),I=()=>t.hoverCom(""),A=R=>{R&&(R.type==="group"&&(R.expand=!R.expand),t.selectCom(R))},M=()=>t.selectCom();return(R,U)=>{const P=C("b-icon"),B=C("b-collapse-transition"),N=we("focus");return p(),V("div",{class:H(["layer-panel-wp",{"is-hide":!f(a).layer}])},[e("div",yn,[e("div",bn,[xn,e("div",{class:"layer-action",onClick:U[0]||(U[0]=O=>f(t).toggleLayerPanel(!1))},wn)]),e("div",Cn,[e("i",{title:"\u4E0A\u79FB\u4E00\u5C42",class:H(["b-iconfont b-icon-arrowup toolbar-icon standard",x.value]),style:K(m.value),onClick:y},null,6),e("i",{title:"\u4E0B\u79FB\u4E00\u5C42",class:H(["b-iconfont b-icon-arrowdown toolbar-icon standard",x.value]),style:K(m.value),onClick:i},null,6),e("i",{title:"\u7F6E\u9876",class:H(["b-iconfont b-icon-vertical-align-botto toolbar-icon standard",x.value]),style:K({transform:"rotate(180deg)",...m.value}),onClick:S},null,6),e("i",{title:"\u7F6E\u5E95",class:H(["b-iconfont b-icon-vertical-align-botto toolbar-icon standard",x.value]),style:K(m.value),onClick:d},null,6)]),e("div",$n,[s(f(ea),Qt({modelValue:w.value,"onUpdate:modelValue":U[4]||(U[4]=O=>w.value=O),class:"drag-area","item-key":"id"},{animation:200}),{item:g(({element:O})=>[e("div",Vn,[e("div",{title:O.alias,class:H(["layer-manager-item",[{hided:O.hided,locked:O.locked,hovered:O.id===f(n),selected:v(O)}]]),onMousedown:E=>A(O),onMouseenter:E=>u(O.id),onMouseleave:I,onDblclick:E=>f(t).renamingCom(O.id),onContextmenu:U[3]||(U[3]=E=>f(b)(E))},[s(P,{name:O.name==="VIcon"?O.config.src:O.icon,size:"18"},null,8,["name"]),O.id===f(_)?me((p(),V("input",{key:0,"onUpdate:modelValue":E=>O.alias=E,class:"layer-item-input",onBlur:U[1]||(U[1]=E=>f(t).renamingCom("")),onKeydown:U[2]||(U[2]=Ee(E=>f(t).renamingCom(""),["enter"]))},null,40,Dn)),[[St,O.alias,void 0,{trim:!0}],[N]]):(p(),V("span",Mn,[e("span",In,te(O.alias),1)])),e("i",{class:H(["b-iconfont",`b-icon-${O.hided?"eye-close":"eye"}`,"show-toggle-btn"]),title:O.hided?"\u663E\u793A":"\u9690\u85CF",onClick:E=>O.hided=!O.hided},null,10,Rn),e("i",{class:H(["b-iconfont",`b-icon-${O.locked?"lock":"unlock"}`,"show-toggle-btn"]),title:O.locked?"\u89E3\u9501":"\u9501\u5B9A",onClick:E=>O.locked=!O.locked},null,10,Tn)],42,Sn),s(B,null,{default:g(()=>[O.type==="group"&&O.expand?(p(),V("div",En,[(p(!0),V(Y,null,le(O.components,E=>(p(),V("div",{class:H(["group-item",[{hovered:E.id===f(n),selected:v(E)}]]),key:E.id,title:E.alias,onMouseenter:D=>u(E.id),onMouseleave:I,onMousedown:D=>A(E)},[s(P,{name:E.name==="VIcon"?E.config.src:E.icon,size:"18"},null,8,["name"]),e("span",Un,[e("span",Bn,te(E.alias),1)])],42,Ln))),128))])):J("",!0)]),_:2},1024)])]),_:1},16,["modelValue"]),e("div",{class:"last-flex-item",onClick:M})])])],2)}}};var On=W(Nn,[["__scopeId","data-v-b463b3ac"]]);const yt=l=>`${l}px`,bt=(l,t,c,o)=>{const a=l!=null?l:document.createElement("canvas");a.width=t*o,a.height=c*o,a.style.width=yt(t),a.style.height=yt(c);const n=a.getContext("2d");return n&&n.setTransform(o,0,0,o,0,0),a};class xt{constructor(t,c){this.el=t,this.options={direction:"TB",width:1e3,height:20,bgColor:"#18181c",fontFamily:"sans-serif",fontSize:"10px",fontColor:"#90a0ae",strokeStyle:"rgba(161, 174, 179, 0.8)",lineWidth:.5,indicatorLineWidth:1,scale:1,offset:40,ratio:2,...c},this.canvas=null,this.ctx=null,this.ruler={width:0,height:0},this.constructRuler()}constructRuler(){const{el:t,options:c}=this,{direction:o,width:a,height:n,ratio:r}=c,_=Math.max(o==="TB"?t.offsetWidth:t.offsetHeight,a),k=n;this.ruler.width=_,this.ruler.height=k;const h=bt(null,_,k,r);ma(h,"canvas-ruler"),t.appendChild(h),this.canvas=h,this.ctx=h.getContext("2d"),this.drawRuler()}drawRuler(){const{ctx:t,options:c,ruler:o}=this,{width:a,height:n}=o;t.beginPath(),t.fillStyle=c.bgColor,t.fillRect(0,0,a,n),t.closePath(),t.beginPath(),t.font=`${c.fontSize} ${c.fontFamily}`,t.textAlign="left",t.fillStyle=c.fontColor,t.strokeStyle=c.strokeStyle,t.lineWidth=c.lineWidth,this.drawPoints(),t.stroke()}drawPoints(){const{ctx:t,options:c,ruler:o}=this,{width:a,height:n}=o,{offset:r,scale:_}=c,k=0,h=n/1.5,b=n/1.2;for(let x=0;x<=a;x+=1){const m=x-r;if(m<0)continue;let v=-1,w=-1;m%50===0?(v=Math.floor(m/_),w=k):m%25===0?w=h:m%5===0&&(w=b),w>=0&&(t.moveTo(x+.5,n+.5),t.lineTo(x+.5,w),v>-1&&t.fillText(`${v}`,x+2.5,n/1.5))}}setSize(t,c,o){const{el:a,options:n}=this;n.width=t,n.height=c,n.scale=o;const{direction:r,width:_,height:k,ratio:h}=n,b=Math.max(r==="TB"?a.offsetWidth:a.offsetHeight,_),x=k;this.ruler.width=b,this.ruler.height=x,bt(this.canvas,b,x,h),this.drawRuler()}destroy(){const{el:t}=this;t.remove()}}const An={class:"canvas-ruler-wp"},zn={class:"ruler-corner"},jn=Object.assign({name:"Ruler"},{__name:"index",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{toolbox:o,canvas:a}=c(t),n=T(null),r=T(null),_=T(null),k=T(null),h=T(0),b=T(0),x=document.documentElement.clientWidth;ta(()=>{if(n.value&&r.value){const v=Math.max(a.value.width,x);_.value?_.value.setSize(v,20,a.value.scale):_.value=new xt(n.value,{direction:"TB",width:v,scale:a.value.scale}),k.value?k.value.setSize(a.value.height,20,a.value.scale):k.value=new xt(r.value,{direction:"LR",width:a.value.height,scale:a.value.scale})}});const m=v=>{const w=v.target;h.value=w.scrollLeft,b.value=w.scrollTop};return $e(()=>{const v=document.getElementById("canvas-wp");v==null||v.addEventListener("scroll",m)}),aa(()=>{const v=document.getElementById("canvas-wp");v==null||v.removeEventListener("scroll",m)}),(v,w)=>{const $=C("b-icon"),y=C("b-tooltip");return p(),V("div",An,[e("div",{ref_key:"hRulerWpRef",ref:n,class:"ruler-wrapper h-container",style:K(`transform: translateX(-${h.value}px);`)},null,4),e("div",{ref_key:"vRulerWpRef",ref:r,class:"ruler-wrapper v-container",style:K(`transform: rotate(90deg) translateX(-${b.value}px);`)},null,4),e("div",zn,[s(y,{content:f(o).markLine?"\u5BF9\u9F50\u7EBF\u5F00\u542F":"\u5BF9\u9F50\u7EBF\u5173\u95ED"},{default:g(()=>[s($,{name:f(o).markLine?"eye":"eye-close",type:"button",onClick:w[0]||(w[0]=i=>f(o).markLine=!f(o).markLine)},null,8,["name"])]),_:1},8,["content"])])])}}});var Pn=W(jn,[["__scopeId","data-v-cce45f38"]]);function kt(l){if(l={...l},l.rotate!==0){const t=l.width*vt(l.rotate)+l.height*_t(l.rotate),c=(l.width-t)/2;l.left+=c,l.right=l.left+t;const o=l.height*vt(l.rotate)+l.width*_t(l.rotate),a=(o-l.height)/2;l.top-=a,l.bottom=l.top+o,l.width=t,l.height=o}else l.bottom=l.top+l.height,l.right=l.left+l.width;return l}const Gn={class:"mark-line"},Jn=5,Fn=Object.assign({name:"MarkLine"},{__name:"index",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{comps:o,selectedCom:a,canvas:n,toolbox:r}=c(t),_=T([]),k=T(["xt","xc","xb","yl","yc","yr"]),h=T({xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}),b=()=>{Object.keys(h.value).forEach(i=>{h.value[i]=!1})};function x({key:i,value:S}){const d={left:"x",top:"y"};t.setShapeSingleStyle({key:d[i],value:S})}const m=(i,S)=>{const d=_.value,u=a.value,I=o.value.filter(P=>!P.hided),A=n.value.scale,M=kt($(u.attr)),R=M.width/2,U=M.height/2;b(),I.forEach(P=>{if(P.id===u.id||P.locked||P.hided)return;const{top:B,left:N,bottom:O,right:E,width:D,height:L}=kt($(P.attr)),F=D/2,X=L/2,ee={top:[{isNearly:y(M.top,B),lineNode:d.xt,line:"xt",dragShift:B,lineShift:B},{isNearly:y(M.bottom,B),lineNode:d.xt,line:"xt",dragShift:B-M.height,lineShift:B},{isNearly:y(M.top+U,B+X),lineNode:d.xc,line:"xc",dragShift:B+X-U,lineShift:B+X},{isNearly:y(M.top,O),lineNode:d.xb,line:"xb",dragShift:O,lineShift:O},{isNearly:y(M.bottom,O),lineNode:d.xb,line:"xb",dragShift:O-M.height,lineShift:O}],left:[{isNearly:y(M.left,N),lineNode:d.yl,line:"yl",dragShift:N,lineShift:N},{isNearly:y(M.right,N),lineNode:d.yl,line:"yl",dragShift:N-M.width,lineShift:N},{isNearly:y(M.left+R,N+F),lineNode:d.yc,line:"yc",dragShift:N+F-R,lineShift:N+F},{isNearly:y(M.left,E),lineNode:d.yr,line:"yr",dragShift:E,lineShift:E},{isNearly:y(M.right,E),lineNode:d.yr,line:"yr",dragShift:E-M.width,lineShift:E}]},pe=[],{rotate:fe}=M;Object.keys(ee).forEach(oe=>{ee[oe].forEach(ie=>{if(!ie.isNearly)return;const be=fe!==0?v(oe,ie,M):ie.dragShift;x({key:oe,value:be}),ie.lineNode.style[oe]=`${ie.lineShift*A+60}px`,pe.push(ie.line)})}),pe.length&&w(pe,i,S)})},v=(i,S,d)=>{const{w:u,h:I}=a.value.attr;return Math.round(i==="top"?S.dragShift-(I-d.height)/2:S.dragShift-(u-d.width)/2)},w=(i,S,d)=>{d?i.includes("yr")?h.value.yr=!0:i.includes("yc")?h.value.yc=!0:i.includes("yl")&&(h.value.yl=!0):i.includes("yl")?h.value.yl=!0:i.includes("yc")?h.value.yc=!0:i.includes("yr")&&(h.value.yr=!0),S?i.includes("xb")?h.value.xb=!0:i.includes("xc")?h.value.xc=!0:i.includes("xt")&&(h.value.xt=!0):i.includes("xt")?h.value.xt=!0:i.includes("xc")?h.value.xc=!0:i.includes("xb")&&(h.value.xb=!0)},$=i=>({left:i.x,top:i.y,width:i.w,height:i.h,rotate:i.rotate}),y=(i,S)=>Math.abs(i-S)<=Jn;return $e(()=>{ge.on(he.CompMove,({isDownward:i,isRightward:S})=>{r.value.markLine&&m(i,S)}),ge.on(he.CompUnMove,()=>{b()})}),Le(()=>{ge.off(he.CompMove),ge.off(he.CompUnMove)}),(i,S)=>(p(),V("div",Gn,[(p(!0),V(Y,null,le(k.value,d=>me((p(),V("div",{key:d,class:H(["line",[d.includes("x")?"xline":"yline",d]]),ref_for:!0,ref:u=>{_.value[d]=u}},null,2)),[[Ge,h.value[d]||!1]])),128))]))}}),{schemaStore:We,storeToRefs:Xn}=Q(),Kn=[{direction:"lt",angle:0},{direction:"t",angle:45},{direction:"rt",angle:90},{direction:"r",angle:135},{direction:"rb",angle:180},{direction:"b",angle:225},{direction:"lb",angle:270},{direction:"l",angle:315}],wt=[{start:338,end:23,cursor:"nwse-resize"},{start:23,end:68,cursor:"ns-resize"},{start:68,end:113,cursor:"nesw-resize"},{start:113,end:158,cursor:"ew-resize"},{start:158,end:203,cursor:"nwse-resize"},{start:203,end:248,cursor:"ns-resize"},{start:248,end:293,cursor:"nesw-resize"},{start:293,end:338,cursor:"ew-resize"}],Yn=l=>{const t=(l+360)%360,c={};let o=-1;return Kn.forEach(a=>{const n=(a.angle+t)%360,r=wt.length,_=0;for(;_<r;){o=(o+1)%r;const k=wt[o];if(n<23||n>=338){c[a.direction]="nwse-resize";break}if(k.start<=n&&n<k.end){c[a.direction]=k.cursor;break}}}),c};function Hn(l,t,c,o,a,n,r){l==="t"?(n.h=Math.round(t.h+(c.y-o.y)/a),n.y=Math.round(t.y+(o.y-c.y)/a),n.h=Math.max(n.h,20),t.lockedRatio&&(n.w=n.h*r)):l==="rt"?(n.h=Math.round(t.h+(c.y-o.y)/a),n.w=Math.round(t.w+(o.x-c.x)/a),n.y=Math.round(t.y+(o.y-c.y)/a),n.w=Math.max(n.w,20),n.h=Math.max(n.h,20),t.lockedRatio&&(n.w=n.h*r)):l==="r"?(n.w=Math.round(t.w+(o.x-c.x)/a),n.w=Math.max(n.w,20),t.lockedRatio&&(n.h=n.w/r)):l==="rb"?(n.h=Math.round(t.h+(o.y-c.y)/a),n.w=Math.round(t.w+(o.x-c.x)/a),n.w=Math.max(n.w,20),n.h=Math.max(n.h,20),t.lockedRatio&&(n.h=n.w/r)):l==="b"?(n.h=Math.round(t.h+(o.y-c.y)/a),n.h=Math.max(n.h,20),t.lockedRatio&&(n.w=n.h*r)):l==="lb"?(n.h=Math.round(t.h+(o.y-c.y)/a),n.w=Math.round(t.w+(c.x-o.x)/a),n.x=Math.round(t.x+(o.x-c.x)/a),n.w=Math.max(n.w,20),n.h=Math.max(n.h,20),t.lockedRatio&&(n.h=n.w/r)):l==="l"?(n.w=Math.round(t.w+(c.x-o.x)/a),n.x=Math.round(t.x+(o.x-c.x)/a),n.w=Math.max(n.w,20),t.lockedRatio&&(n.h=n.w/r)):l==="lt"&&(n.h=Math.round(t.h+(c.y-o.y)/a),n.w=Math.round(t.w+(c.x-o.x)/a),n.w=Math.max(n.w,20),n.h=Math.max(n.h,20),n.x=Math.round(t.x+(o.x-c.x)/a),n.y=Math.round(t.y+(o.y-c.y)/a),t.lockedRatio&&(n.h=n.w/r,n.y=Math.round(t.y+(o.x-c.x)/a)))}const Pt=(l,t,c,o,a)=>{const n={...c.attr},r=n.w/n.h,_=Object.create(null),k=l.clientX,h=l.clientY;let b=!1;const x=v=>{const{shortcuts:w}=Xn(We),{ctrlKey:$,shiftKey:y}=w.value,i=v.clientX,S=v.clientY,d=Math.round((i-k)/o/a)*a,u=Math.round((S-h)/o/a)*a;b=Math.abs(d)>=1||Math.abs(u)>=1,t?Hn(t,n,{x:k,y:h},{x:i,y:S},o,_,r):($&&(_.x=n.x+d),y&&(_.y=n.y+u),!$&&!y&&(_.x=n.x+d,_.y=n.y+u)),c.attr={...c.attr,..._},je().then(()=>{ge.emit(he.CompMove,{isDownward:S-h>0,isRightward:i-k>0})})},m=()=>{ge.emit(he.CompUnMove),b&&We.recordSnapshot(),ue(document,"mousemove",x),ue(document,"mouseup",m)};ce(document,"mousemove",x),ce(document,"mouseup",m)},Wn=(l,t,c,o)=>{Pt(l,null,t,c,o)},qn=(l,t,c,o,a)=>{Pt(l,t,c,o,a)},Zn=(l,t,c)=>{const o=t.getBoundingClientRect(),a=o.left+o.width/2,n=o.top+o.height/2,r=Math.atan2(n-l.clientY,a-l.clientX)*180/Math.PI-c.attr.rotate;let _=!1;const k=b=>{_=!0;const x=Math.atan2(n-b.clientY,a-b.clientX)*180/Math.PI-r,m=Math.round(x%360);c.attr.rotate=m<0?m+360:m},h=()=>{_&&We.recordSnapshot(),ue(document,"mousemove",k),ue(document,"mouseup",h)};ce(document,"mousemove",k),ce(document,"mouseup",h)};const Qn={class:"nav-line"},es=Object.assign({name:"ReferLine"},{__name:"refer-line",props:{attr:{type:Object,required:!0},scale:{type:Number,required:!0}},setup(l){const t=l,c=z(()=>({height:`${t.attr.y+60/t.scale}px`,borderLeftWidth:`${.9/t.scale}px`})),o=z(()=>({width:`${t.attr.x+60/t.scale}px`,borderTopWidth:`${.9/t.scale}px`})),a=z(()=>({fontSize:`${12/t.scale}px`,top:`-${6/t.scale}px`,left:`-${6/t.scale}px`}));return(n,r)=>(p(),V("div",Qn,[e("div",{class:"nav-line-top",style:K(c.value)},null,4),e("div",{class:"nav-line-left",style:K(o.value)},null,4),e("div",{class:"nav-line-account",style:K(a.value)},te(l.attr.x)+", "+te(l.attr.y),5)]))}});var ts=W(es,[["__scopeId","data-v-f5c82920"]]);const as=["onMousedown"],os={key:1,class:"b-iconfont b-icon-lock",title:"\u89E3\u9501"},ls=Object.assign({name:"DvTransform"},{__name:"index",props:{data:{type:Object,required:!0}},setup(l){const t=l,c=oa(),{schemaStore:o,storeToRefs:a}=Q(),{canvas:n,selectedCom:r,selectedComIds:_,toolbox:k,hoveredComId:h,spaceDown:b,isMultiSelect:x}=a(o),m=z(()=>h.value===t.data.id),v=z(()=>{var E;return _.value.includes(t.data.id)||((E=r.value)==null?void 0:E.id)===t.data.id}),w=z(()=>({locked:t.data.locked,selected:v.value})),$=z(()=>t.data.attr.rotateY!==0||t.data.attr.rotateX!==0?{"transform-style":"preserve-3d",perspective:`${t.data.attr.perspective}px`,overflow:"visible"}:null),y=z(()=>{const{x:E,y:D,w:L,h:F}=t.data.attr;return{top:0,left:0,width:`${L}px`,height:`${F}px`,transform:`translate(${E}px, ${D}px)`}}),i=z(()=>({"is-hide":!v.value||t.data.locked})),S=z(()=>({transform:`rotateZ(${t.data.attr.rotate}deg)`})),d=z(()=>({width:`${t.data.attr.w}px`,height:`${t.data.attr.h}px`})),u=z(()=>({display:t.data.hided?"none":"block"})),I=z(()=>Yn(t.data.attr.rotate)),A=z(()=>n.value.scale),M=z(()=>({t:{name:"top",style:{cursor:I.value.t}},rt:{name:"top-right",style:{cursor:I.value.rt}},r:{name:"right",style:{cursor:I.value.r}},rb:{name:"bottom-right",style:{cursor:I.value.rb}},b:{name:"bottom",style:{cursor:I.value.b}},lb:{name:"bottom-left",style:{cursor:I.value.lb}},l:{name:"left",style:{cursor:I.value.l}},lt:{name:"top-left",style:{cursor:I.value.lt}}})),R=()=>o.hoverCom(t.data.id),U=()=>o.hoverCom(""),P=()=>{o.selectCom(t.data)},B=E=>{b.value||(E.stopPropagation(),E.preventDefault(),P(),!t.data.locked&&Wn(E,t.data,A.value,k.value.grid))},N=(E,D)=>{P(),qn(E,D,t.data,A.value,k.value.grid)},O=E=>{Zn(E,c.vnode.el,t.data)};return(E,D)=>(p(),V("div",{class:H(["dv-transform",w.value]),style:K(y.value)},[f(k).referLine&&!f(x)&&v.value?(p(),G(ts,{key:0,attr:l.data.attr,scale:A.value},null,8,["attr","scale"])):J("",!0),e("div",{class:H(["dv-scale",{hovered:m.value}]),style:K(u.value),onMouseenter:R,onMouseleave:U,onMousedown:B},[e("div",{class:H(["transform-handler",i.value]),style:K(S.value)},[e("div",{class:"dv-com",style:K($.value)},[Vt(E.$slots,"default",{},void 0,!0),e("div",{class:"dv-event-disable",style:K(d.value)},null,4)],4),e("span",{class:"control-point rotate-handler",onMousedown:re(O,["prevent","stop"])},null,32),(p(!0),V(Y,null,le(M.value,(L,F)=>(p(),V("i",{key:F,class:H(`control-point ${L.name}-handler`),style:K(L.style),"data-html2canvas-ignore":"",onMousedown:re(X=>N(X,F),["prevent","stop"])},null,46,as))),128))],6)],38),l.data.locked?(p(),V("i",os)):J("",!0)],6))}});var ns=W(ls,[["__scopeId","data-v-4da6c714"]]);const ss=l=>(ve("data-v-dac308a0"),l=l(),_e(),l),is=ss(()=>e("i",{class:"action-btn b-iconfont b-icon-clear"},null,-1)),cs={class:"data-editor",style:{margin:"0"}},us={class:"t-right pt-16"},rs={__name:"index",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{toolbar:o,toolbox:a,pageConfig:n,comps:r}=c(t),_=z(()=>t.toolbar.config?{right:"360px"}:{right:0}),k=T(null),h=()=>{Ue.confirm({type:"error",title:"\u786E\u8BA4\u6E05\u7A7A\u753B\u5E03\u5417\uFF1F\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01"}).then(()=>{t.clearScreen()}).catch(()=>{})};function b(i){const S=i.clipboardData.getData("Text");console.log(S);try{const d=JSON.parse(S);((d==null?void 0:d.type)==="com"||(d==null?void 0:d.type)==="group")&&(d.id=`${d.name}_${ke()}`,d.name==="Group"&&d.components.forEach(u=>{u.id=`${u.name}_${ke()}`}),t.addCom({component:d}),q.success("\u7C98\u8D34\u56FE\u8868\u6210\u529F\uFF01"))}catch(d){console.log(d),q.error("\u7C98\u8D34\u7684\u5185\u5BB9\u4E0D\u662F\u56FE\u8868\u7EC4\u4EF6\uFF01")}setTimeout(()=>{k.value.value=""},100)}const x=T(!1),m=T(""),v=T("360px"),w=()=>{v.value=`${document.body.clientHeight-125}px`},$=()=>{x.value=!0,m.value=JSON.stringify({pageConfig:n.value,components:r.value},null,2)},y=()=>{try{const i=JSON.parse(m.value);n.value=i.pageConfig,r.value=i.components,q.success("\u5E94\u7528\u6210\u529F\uFF01"),x.value=!1}catch{q.error("\u914D\u7F6E\u9879\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u68C0\u67E5\u540E\u518D\u5E94\u7528\u914D\u7F6E\uFF01")}};return $e(()=>{w(),ce(window,"resize",w)}),Le(()=>{ue(window,"resize",w)}),(i,S)=>{const d=C("b-tooltip"),u=C("b-switch"),I=C("b-space"),A=C("b-form-item"),M=C("g-input-number"),R=C("b-button"),U=C("b-form"),P=C("b-modal"),B=C("b-ace-editor");return p(),V("div",{class:"action-bar-wrap",style:K(_.value)},[s(d,{content:"\u9002\u5E94\u5C3A\u5BF8",placement:"left"},{default:g(()=>[e("i",{class:"action-btn b-iconfont b-icon-aim",onClick:S[0]||(S[0]=re(N=>f(t).autoCanvasScale(),["stop"]))})]),_:1}),s(d,{content:"\u539F\u59CB\u5C3A\u5BF8",placement:"left"},{default:g(()=>[e("i",{class:"action-btn b-iconfont b-icon-icon-test",onClick:S[1]||(S[1]=re(N=>f(t).setCanvasScale(100),["stop"]))})]),_:1}),s(d,{content:"\u7F16\u8F91\u914D\u7F6E",placement:"left"},{default:g(()=>[e("i",{class:"action-btn b-iconfont b-icon-edit-square",onClick:re($,["stop"])})]),_:1}),s(d,{content:"\u5DE5\u5177\u8BBE\u7F6E",placement:"left"},{default:g(()=>[e("i",{class:"action-btn b-iconfont b-icon-setting",onClick:S[2]||(S[2]=re(N=>f(o).toolbox=!f(o).toolbox,["stop"]))})]),_:1}),s(P,{title:"\u5DE5\u5177\u8BBE\u7F6E",modelValue:f(o).toolbox,"onUpdate:modelValue":S[6]||(S[6]=N=>f(o).toolbox=N),"append-to-body":"","custom-class":"schema-modal",width:"600px"},{default:g(()=>[s(U,{"label-position":"left","label-width":"100px"},{default:g(()=>[s(A,{label:"\u53C2\u8003\u7EBF"},{default:g(()=>[s(I,null,{default:g(()=>[s(u,{modelValue:f(a).referLine,"onUpdate:modelValue":S[3]||(S[3]=N=>f(a).referLine=N)},null,8,["modelValue"]),j(" \u9009\u4E2D\u7EC4\u4EF6\u65F6\uFF0C\u5DE6\u4E0A\u89D2\u8DDD\u79BB\u6807\u5C3A\u7684\u53C2\u8003\u7EBF\uFF0C\u65B9\u4FBF\u5BF9\u9F50\u4F7F\u7528 ")]),_:1})]),_:1}),s(A,{label:"\u5BF9\u9F50\u7EBF"},{default:g(()=>[s(I,null,{default:g(()=>[s(u,{modelValue:f(a).markLine,"onUpdate:modelValue":S[4]||(S[4]=N=>f(a).markLine=N)},null,8,["modelValue"]),j(" \u5F00\u542F\u540E\uFF0C\u62D6\u62FD\u7EC4\u4EF6\u81F3\u76F8\u90BB\u7EC4\u4EF6\u65F6\uFF0C\u8FBE\u5230\u4E00\u5B9A\u8DDD\u79BB\u540E\u4F1A\u81EA\u52A8\u5438\u9644 ")]),_:1})]),_:1}),s(A,{label:"\u753B\u5E03"},{default:g(()=>[s(I,null,{default:g(()=>[s(M,{modelValue:f(a).grid,"onUpdate:modelValue":S[5]||(S[5]=N=>f(a).grid=N),min:1,max:20,suffix:"px",style:{width:"120px"}},null,8,["modelValue"]),j(" \u9F20\u6807\u62D6\u62FD\u7EC4\u4EF6\u65F6\u79FB\u52A8\u7684\u6B65\u957F\uFF0C\u5355\u4F4Dpx ")]),_:1})]),_:1}),s(A,{label:"\u6E05\u7A7A\u753B\u5E03"},{default:g(()=>[s(I,null,{default:g(()=>[s(R,{style:{width:"120px"},size:"small",onClick:re(h,["stop"])},{default:g(()=>[j(" \u6E05\u7A7A "),is]),_:1}),j(" \u753B\u5E03\u6E05\u7A7A\u4F1A\u6E05\u9664\u6240\u6709\u914D\u7F6E\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C ")]),_:1})]),_:1}),s(A,{label:"\u8DE8\u5C4F\u7C98\u8D34"},{default:g(()=>[e("textarea",{class:"paste-inner",ref_key:"textpasteRef",ref:k,placeholder:"\u590D\u5236\u7EC4\u4EF6\u5185\u5BB9\u540E\u5728\u6B64\u5904\u7C98\u8D34\u5373\u53EF",onPaste:b},null,544)]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(P,{modelValue:x.value,"onUpdate:modelValue":S[8]||(S[8]=N=>x.value=N),title:"\u9875\u9762\u7F16\u8F91\u5668","append-to-body":"",fullscreen:"","custom-class":"schema-modal"},{default:g(()=>[e("div",cs,[s(B,{modelValue:m.value,"onUpdate:modelValue":S[7]||(S[7]=N=>m.value=N),theme:"tomorrow_night",height:v.value,styles:{border:"none"}},null,8,["modelValue","height"])]),e("div",us,[s(R,{size:"small",type:"primary",icon:"snippets",onClick:y},{default:g(()=>[j("\u5E94\u7528\u914D\u7F6E")]),_:1})])]),_:1},8,["modelValue"])],4)}}};var ds=W(rs,[["__scopeId","data-v-dac308a0"]]);const ms={__name:"index",props:{x:Number,y:Number,width:Number,height:Number,showArea:Boolean},setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{toolbox:o,canvas:a,selectedComs:n,areaData:r}=c(t);function _(k){let h=!1;const b={x:r.value.x,y:r.value.y},x=n.value.map(u=>u.attr),m=Object.create(null),v=[],w=k.clientX,$=k.clientY,y=a.value.scale,i=o.value.grid,S=u=>{const I=u.clientX,A=u.clientY,M=Math.round((I-w)/y/i)*i,R=Math.round((A-$)/y/i)*i;h=Math.abs(M)>=1||Math.abs(R)>=1,m.x=b.x+M,m.y=b.y+R,r.value={...r.value,...m},n.value.forEach((U,P)=>{v[P]={x:x[P].x+M,y:x[P].y+R},U.attr={...U.attr,...v[P]}})},d=()=>{h&&t.recordSnapshot(),ue(document,"mousemove",S),ue(document,"mouseup",d)};ce(document,"mousemove",S),ce(document,"mouseup",d)}return(k,h)=>me((p(),V("div",{style:K({left:l.x+"px",top:l.y+"px",width:l.width+"px",height:l.height+"px",zIndex:2}),class:"select-area",onMousedown:re(_,["stop"])},null,36)),[[Ge,l.showArea]])}};var ps=W(ms,[["__scopeId","data-v-e0e4b8a0"]]);function ze(l,t){const{x:c,y:o}=l;return c>=t.x&&c<=t.x+t.width&&o>=t.y&&o<=t.y+t.height}function vs(l){const{x:t,y:c,w:o,h:a}=l;return[{x:t,y:c},{x:t+o,y:c},{x:t,y:c+a},{x:t+o,y:c+a}]}function _s(l,t){const[c,o,a,n]=vs(l);return ze(c,t)||ze(o,t)||ze(a,t)||ze(n,t)}function Ct(l,t){const c=[];return t.forEach(o=>{o.hided||o.locked||_s(o.attr,l)&&c.push(o)}),c}const fs={class:"canvas-main"},gs={__name:"index",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{pageConfig:o,spaceDown:a,canvas:n,selectedCom:r,selectedComIds:_,comps:k,toolbox:h,getPanelOffsetLeft:b,getPanelOffsetTop:x,editorEL:m,areaData:v}=c(t),{showMenu:w}=lt(),$=T(null),y=Te({drag:!1,startX:0,startY:0});let i=0,S=0;const d=z(()=>({width:`${n.value.width}px`,height:`${n.value.height}px`})),u=z(()=>{const{filterShow:D,blendMode:L,hueRotate:F,saturate:X,contrast:ee,brightness:pe,opacity:fe}=o.value.styles,oe={position:"absolute",width:`${o.value.width}px`,height:`${o.value.height}px`,backgroundImage:`url(${o.value.bgImage})`,backgroundColor:o.value.bgColor};return D&&(oe.mixBlendMode=L,oe.opacity=fe,oe.filter=`saturate(${X}) contrast(${ee}) hue-rotate(${F}deg) brightness(${pe})`),oe}),I=z(()=>({position:"absolute",top:"60px",left:"60px",transform:`scale(${n.value.scale}) translate(0px, 0px)`,transition:"0.2s all ease-in-out",transformOrigin:"0 0"})),A=pa(t.autoCanvasScale,50);function M(D){const{w:L,h:F,rotateX:X,rotateY:ee,filterShow:pe,blendMode:fe,hueRotate:oe,saturate:ie,contrast:be,brightness:Ke,opacity:Ae}=D.attr,xe={width:`${L}px`,height:`${F}px`,transform:`rotateX(${X}deg) rotateY(${ee}deg) `};return pe&&(xe.mixBlendMode=fe,xe.opacity=Ae,xe.filter=`saturate(${ie}) contrast(${be}) hue-rotate(${oe}deg) brightness(${Ke})`),xe}async function R(D){D.preventDefault();try{const L=D.dataTransfer.getData("image-comp");if(L){const ee=JSON.parse(L);U(D,ee);return}const F=D.dataTransfer.getData("custom-comp");if(F){const ee=JSON.parse(F);U(D,ee);return}const X=D.dataTransfer.getData("normal-comp");if(X){const ee=Mt(X);if(ee.apiData&&ee.apiData.type===qe.static&&ee.apiData.staticPath){const{data:pe}=await Et(ee.id,ee.apiData.staticPath);ee.apiData.config.data=JSON.stringify(pe)}U(D,ee)}}catch(L){console.warn(L)}}function U(D,L){const{scale:F}=n.value,X=(D.clientX-b.value+$.value.scrollLeft)/F,ee=(D.clientY-x.value+$.value.scrollTop)/F;L.attr.x=Math.round(X-L.attr.w/2),L.attr.y=Math.round(ee-L.attr.h/2),t.addCom({component:L}),t.selectCom(L)}function P(D){D.preventDefault(),D.stopPropagation(),D.dataTransfer.dropEffect="copy"}function B(D){if(a.value){y.drag=!0;const L=D.clientX,F=D.clientY,X=n.value.scale,{scrollLeft:ee,scrollTop:pe,clientWidth:fe,scrollWidth:oe,clientHeight:ie,scrollHeight:be}=$.value,Ke=fe<oe||ie<be,Ae={left:ee,top:pe},xe=ct=>{if(Ke){const Jt=ct.clientX,Ft=ct.clientY,Xt=Math.round((Jt-L)/X),Kt=Math.round((Ft-F)/X);$.value.scrollLeft=Ae.left-Xt,$.value.scrollTop=Ae.top-Kt}},it=()=>{y.drag=!1,ue(document,"mousemove",xe),ue(document,"mouseup",it)};ce(document,"mousemove",xe),ce(document,"mouseup",it)}else t.selectCom()}function N(D){if(r.value||D.preventDefault(),a.value||D.target.className==="select-area")return;E();const L=m.value.getBoundingClientRect();i=L.x,S=L.y;const F=D.clientX,X=D.clientY;v.value.showArea=!0;const ee=n.value.scale;v.value.x=(F-i)/ee,v.value.y=(X-S)/ee;const pe=oe=>{v.value.width=Math.abs((oe.clientX-F)/ee),v.value.height=Math.abs((oe.clientY-X)/ee),oe.clientX<F&&(v.value.x=(oe.clientX-i)/ee),oe.clientY<X&&(v.value.y=(oe.clientY-S)/ee);const ie=Ct(v.value,k.value);ie.length===0?_.value=[]:ie.length===1?_.value=[ie[0].id]:ie.length>1&&(_.value=ie.map(be=>be.id))},fe=oe=>{if(ue(document,"mousemove",pe),ue(document,"mouseup",fe),oe.clientX===F&&oe.clientY===X){E();return}O()};ce(document,"mousemove",pe),ce(document,"mouseup",fe)}function O(){const D=Ct(v.value,k.value);if(D.length===0){E();return}if(D.length===1){t.selectCom(D[0]),E();return}t.multiSelectComs(D)}function E(){v.value.showArea=!1,v.value.width=0,v.value.height=0}return $e(()=>{ce(window,"resize",A),ge.on(he.HideArea,E),t.getEditor(),A()}),Le(()=>{ue(window,"resize",A)}),(D,L)=>(p(),V("div",fs,[e("div",{id:"canvas-wp",ref_key:"canvasWpRef",ref:$,class:"canvas-panel-wrap",onMousedown:re(B,["stop"])},[e("div",{class:"screen-shot",style:K(d.value)},[f(h).markLine?(p(),G(Fn,{key:0,style:K(d.value)},null,8,["style"])):J("",!0),s(ds),s(Pn),e("div",{style:K(I.value)},[e("div",{id:"canvas-components",class:"canvas-panel",style:K(u.value),onDragover:P,onDrop:R,onMousedown:N,onContextmenu:L[0]||(L[0]=(...F)=>f(w)&&f(w)(...F))},[(p(!0),V(Y,null,le(f(k),F=>(p(),G(ns,{key:F.id,data:F},{default:g(()=>[(p(),G(Dt(F.name),{data:F,style:K({...M(F),...f(Aa)(F.animation)}),id:`component_${F.id}`,class:H(f(za)(F.animation))},null,8,["data","style","id","class"]))]),_:2},1032,["data"]))),128)),s(ps,la(na(f(v))),null,16)],36)],4)],4)],544)]))}};var hs=W(gs,[["__scopeId","data-v-6e125cc8"]]);const ys=l=>(ve("data-v-37ccd860"),l=l(),_e(),l),bs={class:"custom-scripts"},xs={class:"func-name",flex:"main:justify cross:center"},ks={class:"fun"},ws={class:"top"},Cs={class:"params"},$s={class:"code",style:{"user-select":"text"}},Vs=ys(()=>e("p",{class:"bottom"},"}",-1)),Ss=Object.assign({name:"scriptConfig"},{__name:"index",props:{label:{type:String,default:"\u521D\u59CB\u5316\u811A\u672C"},funcExplain:{type:String},paramsDesc:{type:Array,default:()=>[]},exampleDesc:{type:Array,default:()=>[{name:"\u83B7\u53D6\u6240\u6709\u7EC4\u4EF6\u4FE1\u606F",code:"console.log(components)"}]}},setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{pageConfig:o,comps:a}=c(t),n=T(null),r=z(()=>["components","userInfo","util"].join(", "));function _(){var b;const h=o.value.initScript.scriptStr;(b=n.value)==null||b.open(h)}function k(h){o.value.initScript.scriptStr=h,t.setPageInfo(o.value)}return(h,b)=>{const x=C("b-checkbox"),m=C("b-button"),v=C("g-field"),w=C("highlightjs"),$=C("CustomScriptsEditor"),y=C("g-field-collapse");return p(),V("div",bs,[s(y,{label:"\u521D\u59CB\u5316\u811A\u672C","default-open":""},{default:g(()=>[s(v,{label:"\u6267\u884C\u811A\u672C"},{default:g(()=>[e("div",xs,[s(x,{modelValue:f(o).initScript.enable,"onUpdate:modelValue":b[0]||(b[0]=i=>f(o).initScript.enable=i)},null,8,["modelValue"]),s(m,{type:"text",icon:"edit",size:"small",onClick:_},{default:g(()=>[j("\u7F16\u8F91")]),_:1})])]),_:1}),e("div",ks,[e("p",ws,[j(" async function ( "),e("span",Cs,te(r.value),1),j(" ){ ")]),e("p",$s,[s(w,{language:"js",code:f(o).initScript.scriptStr},null,8,["code"])]),Vs]),s($,{ref_key:"editorRef",ref:n,modelValue:f(o).initScript.scriptStr,"onUpdate:modelValue":b[1]||(b[1]=i=>f(o).initScript.scriptStr=i),title:l.label+"\u7F16\u8F91\u5668",funcExplain:l.funcExplain,augments:["components"],paramsDesc:l.paramsDesc,exampleDesc:l.exampleDesc,onSuccess:k},null,8,["modelValue","title","funcExplain","paramsDesc","exampleDesc"])]),_:1})])}}});var Ds=W(Ss,[["__scopeId","data-v-37ccd860"]]);const nt=l=>(ve("data-v-0a65e6f2"),l=l(),_e(),l),Ms={class:"page-config-panel"},Is={class:"page-config-top"},Rs=nt(()=>e("span",{class:"mr-16"},"\u57FA\u7840\u914D\u7F6E",-1)),Ts={class:"page-config-content"},Es={key:0},Ls={class:"page-config-wp"},Us={class:"image-thumb-wrap"},Bs=["src"],Ns={key:1,class:"tip",flex:"dir:top main:center cross:center"},Os=nt(()=>e("p",null,"\u6682\u672A\u622A\u53D6\u7F29\u7565\u56FE",-1)),As={class:"pt-8"},zs={class:"page-config-wp mt-16"},js={class:"preset-filter-box"},Ps={class:"pre-desc",style:{display:"flex","flex-flow":"wrap","justify-content":"space-between","align-items":"center",height:"20px",width:"50px"}},Gs=nt(()=>e("div",{style:{width:"24px",height:"20px","line-height":"20px","font-size":"12px"}}," \u5E95\u8272 ",-1)),Js={class:"preset-filter"},Fs={key:1,class:"page-config-wp"},Xs=Object.assign({name:"PageConfig"},{__name:"page-config",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{pageConfig:o,comps:a}=c(t),{paramsDesc:n,exampleDesc:r}=It(a.value),_=[{group:"web\u7AEF",data:va.map(y=>({value:`${y.width}x${y.height}`,label:y.label}))},{group:"\u79FB\u52A8\u8BBE\u5907",data:_a.map(y=>({value:`${y.width}x${y.height}`,label:y.label}))},{group:"\u5176\u4ED6",data:[{value:"custom",label:"\u81EA\u5B9A\u4E49"}]}],k=T(0),h=T(""),b=T(!1),x=z({get:()=>o.value.styles,set:y=>o.value.styles=y}),m=()=>{o.value.bgColor="#0d2a42",o.value.bgImage=""},v=()=>t.autoCanvasScale(),w=y=>{if(y!=="custom"){const i=y.split("x"),S=+i[0],d=+i[1];t.setScreenSize({width:S,height:d})}};async function $(){se(!0),q.warning("\u6B63\u5728\u622A\u53D6\u753B\u5E03\u7F29\u7565\u56FE\uFF0C\u8BF7\u52FF\u8FDB\u884C\u5176\u4ED6\u64CD\u4F5C\uFF01"),b.value=!0;const y=document.getElementById("canvas-components");try{const i=await at(y);o.value.thumbnail=i,q.success("\u622A\u53D6\u7F29\u7565\u56FE\u6210\u529F\uFF01")}catch(i){console.log(i)}b.value=!1,se(!1)}return Ce([()=>o.value.width,()=>o.value.height],()=>{const{width:y,height:i}=o.value;y===1920&&i===1080||y===2560&&i===1080||y===3440&&i===1080||y===3440&&i===1440||y===414&&i===736||y===375&&i===667||y===375&&i===812?h.value=`${y}x${i}`:h.value="custom"},{immediate:!0}),(y,i)=>{const S=C("b-icon"),d=C("b-radio"),u=C("b-radio-group"),I=C("g-group-select"),A=C("g-field"),M=C("g-input-number"),R=C("g-image"),U=C("g-color-picker"),P=C("b-button"),B=C("g-slider"),N=C("g-select"),O=C("g-field-collapse"),E=C("b-scrollbar");return p(),V("div",Ms,[e("div",Is,[s(u,{modelValue:k.value,"onUpdate:modelValue":i[0]||(i[0]=D=>k.value=D),size:"large",type:"capsule",style:{width:"100%"}},{default:g(()=>[s(d,{label:0},{default:g(()=>[Rs,s(S,{name:"desktop"})]),_:1})]),_:1},8,["modelValue"])]),e("div",Ts,[s(E,null,{default:g(()=>[k.value===0?(p(),V("div",Es,[e("div",Ls,[s(A,{label:"\u5C4F\u5E55\u8BBE\u7F6E",style:{"padding-bottom":"8px","padding-top":"8px"}},{default:g(()=>[s(I,{modelValue:h.value,"onUpdate:modelValue":i[1]||(i[1]=D=>h.value=D),data:_,onChange:w},null,8,["modelValue"])]),_:1}),s(A,{label:"\u5C4F\u5E55\u5927\u5C0F",flat:""},{default:g(()=>[s(M,{modelValue:f(o).width,"onUpdate:modelValue":i[2]||(i[2]=D=>f(o).width=D),label:"\u5BBD\u5EA6",min:375,max:3840,inline:"",suffix:"px",onChange:v},null,8,["modelValue"]),s(M,{modelValue:f(o).height,"onUpdate:modelValue":i[3]||(i[3]=D=>f(o).height=D),label:"\u9AD8\u5EA6",min:600,max:2160,inline:"",suffix:"px",onChange:v},null,8,["modelValue"])]),_:1}),s(A,{label:"\u80CC\u666F\u56FE\u7247",tooltip:"\u53EF\u4EE5\u52A0\u8F7D\u5BF9\u5E94\u9884\u8BBE\u7684\u56FE\u7247\u80CC\u666F"},{default:g(()=>[s(R,{"ignore-group-keys":["header","box","decoration","widget"],"show-resize":!1,"show-clear":"",onClear:m,modelValue:f(o).bgImage,"onUpdate:modelValue":i[4]||(i[4]=D=>f(o).bgImage=D)},null,8,["modelValue"])]),_:1}),s(A,{label:"\u80CC\u666F\u989C\u8272"},{default:g(()=>[s(U,{modelValue:f(o).bgColor,"onUpdate:modelValue":i[5]||(i[5]=D=>f(o).bgColor=D)},null,8,["modelValue"])]),_:1}),s(A,{label:"\u7F29\u7565\u56FE",tooltip:"\u622A\u53D6\u5F53\u524D\u753B\u5E03\u5B58\u4E3A\u7F29\u7565\u56FE"},{default:g(()=>[e("div",Us,[f(o).thumbnail?(p(),V("img",{key:0,src:f(o).thumbnail,alt:""},null,8,Bs)):(p(),V("div",Ns,[s(S,{name:"image",size:"52"}),Os]))]),e("div",As,[s(P,{type:"primary",size:"small",loading:b.value,onClick:$},{default:g(()=>[j(" \u622A\u53D6 ")]),_:1},8,["loading"]),s(P,{size:"small",loading:b.value,onClick:i[6]||(i[6]=D=>f(o).thumbnail="")},{default:g(()=>[j(" \u6E05\u9664 ")]),_:1},8,["loading"])])]),_:1})]),s(f(fa)),e("div",zs,[s(O,{label:"\u6EE4\u955C",toggle:"",modelValue:x.value.filterShow,"onUpdate:modelValue":i[23]||(i[23]=D=>x.value.filterShow=D)},{default:g(()=>[s(A,{label:"\u8272\u76F8"},{default:g(()=>[s(B,{modelValue:x.value.hueRotate,"onUpdate:modelValue":i[7]||(i[7]=D=>x.value.hueRotate=D),step:3,min:0,max:360,label:`\u503C\uFF1A${x.value.hueRotate}deg`,"show-input":!1,style:{"margin-bottom":"0"}},null,8,["modelValue","label"]),e("div",js,[e("div",Ps,[Gs,e("div",{style:K({backgroundColor:f(ne)})},null,4)]),e("div",Js,[e("div",{class:"item",style:K([{filter:"hue-rotate(36deg)"},{backgroundColor:f(ne)}]),onClick:i[8]||(i[8]=D=>x.value.hueRotate=36)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(72deg)"},{backgroundColor:f(ne)}]),onClick:i[9]||(i[9]=D=>x.value.hueRotate=72)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(108deg)"},{backgroundColor:f(ne)}]),onClick:i[10]||(i[10]=D=>x.value.hueRotate=108)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(144deg)"},{backgroundColor:f(ne)}]),onClick:i[11]||(i[11]=D=>x.value.hueRotate=144)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(180deg)"},{backgroundColor:f(ne)}]),onClick:i[12]||(i[12]=D=>x.value.hueRotate=180)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(216deg)"},{backgroundColor:f(ne)}]),onClick:i[13]||(i[13]=D=>x.value.hueRotate=216)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(252deg)"},{backgroundColor:f(ne)}]),onClick:i[14]||(i[14]=D=>x.value.hueRotate=252)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(288deg)"},{backgroundColor:f(ne)}]),onClick:i[15]||(i[15]=D=>x.value.hueRotate=288)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(324deg)"},{backgroundColor:f(ne)}]),onClick:i[16]||(i[16]=D=>x.value.hueRotate=324)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(360deg)"},{backgroundColor:f(ne)}]),onClick:i[17]||(i[17]=D=>x.value.hueRotate=360)},null,4)])])]),_:1}),s(A,{label:"\u9971\u548C\u5EA6"},{default:g(()=>[s(B,{modelValue:x.value.saturate,"onUpdate:modelValue":i[18]||(i[18]=D=>x.value.saturate=D),step:.1,min:0,max:2,label:`\u503C\uFF1A${(parseFloat(x.value.saturate)*100).toFixed(0)}%`,"show-input":!1},null,8,["modelValue","label"])]),_:1}),s(A,{label:"\u5BF9\u6BD4\u5EA6"},{default:g(()=>[s(B,{modelValue:x.value.contrast,"onUpdate:modelValue":i[19]||(i[19]=D=>x.value.contrast=D),step:.1,min:0,max:2,label:`\u503C\uFF1A${(parseFloat(x.value.contrast)*100).toFixed(0)}%`,"show-input":!1},null,8,["modelValue","label"])]),_:1}),s(A,{label:"\u4EAE\u5EA6"},{default:g(()=>[s(B,{modelValue:x.value.brightness,"onUpdate:modelValue":i[20]||(i[20]=D=>x.value.brightness=D),step:.1,min:0,max:2,label:`\u503C\uFF1A${(parseFloat(x.value.brightness)*100).toFixed(0)}%`,"show-input":!1},null,8,["modelValue","label"])]),_:1}),s(A,{label:"\u900F\u660E"},{default:g(()=>[s(B,{modelValue:x.value.opacity,"onUpdate:modelValue":i[21]||(i[21]=D=>x.value.opacity=D),min:0,max:1,step:.05,label:`\u503C\uFF1A${(parseFloat(x.value.opacity)*100).toFixed(0)}%`,"show-input":!1},null,8,["modelValue","label"])]),_:1}),s(A,{label:"\u6DF7\u5408"},{default:g(()=>[s(N,{modelValue:x.value.blendMode,"onUpdate:modelValue":i[22]||(i[22]=D=>x.value.blendMode=D),data:f(Rt)},null,8,["modelValue","data"])]),_:1})]),_:1},8,["modelValue"])])])):J("",!0),k.value===1?(p(),V("div",Fs,[s(Ds,{pageConfig:f(o),paramsDesc:f(n),exampleDesc:f(r)},null,8,["pageConfig","paramsDesc","exampleDesc"])])):J("",!0)]),_:1})])])}}});var Ks=W(Xs,[["__scopeId","data-v-0a65e6f2"]]);const Ys={class:"data-center-panel"},Hs={key:1,style:{"min-height":"300px"},flex:"main:center cross:center"},Ws=Object.assign({name:"DataCenterPanel"},{__name:"index",setup(l){const t=ga(()=>sa(()=>import("./source-panel-835bf6e6.js"),["static/js/source-panel-835bf6e6.js","static/js/vendor-c1103bdb.js","static/css/vendor-d5da1a95.css","static/js/chunk-brace-0dab6832.js","static/js/index-71bcd248.js","static/css/index-bd203d9c.css","static/js/chunk-bin-ui-design-9314e876.js","static/css/chunk-bin-ui-design-8c9fd19c.css","static/js/chunk-bin-datav-6a4e943a.js","static/css/chunk-bin-datav-b06db975.css","static/js/chunk-particles.vue3-91e644a5.js","static/js/chunk-three-06bdd351.js","static/js/chunk-gsap-ecfb8fd4.js","static/js/chunk-mockjs-03499d26.js"])),{schemaStore:c,storeToRefs:o}=Q(),{selectedCom:a}=o(c),n=z(()=>a.value.apiData);return(r,_)=>{var h,b;const k=C("b-empty");return p(),V("div",Ys,[(b=(h=n.value)==null?void 0:h.config)!=null&&b.data?(p(),G(f(t),{key:0})):(p(),V("div",Hs,[s(k,null,{default:g(()=>[j("\u8BE5\u7EC4\u4EF6\u4E0D\u9700\u8981\u914D\u7F6E\u6570\u636E")]),_:1})]))])}}});const qs=l=>(ve("data-v-9a3edfca"),l=l(),_e(),l),Zs={class:"com-title-wp"},Qs={flex:"main:justify cross:center",class:"pr-8"},ei=qs(()=>e("span",null,"\u540D\u79F0",-1)),ti={class:"data-editor",style:{margin:"0",height:"350px"}},ai={class:"t-right pt-8"},oi=Object.assign({name:"ConfigTitle"},{__name:"config-title",props:{showCfg:{type:Boolean,default:!1}},setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{selectedCom:o}=c(t),a=T(!1),n=T(""),r=T(!1),_=()=>{a.value=!0,r.value=!1,n.value=JSON.stringify(o.value,null,2)},k=()=>{Ze(JSON.stringify(o.value)),q.success("\u5DF2\u590D\u5236\u914D\u7F6E\u9879\u81F3\u526A\u5207\u677F"),a.value=!1},h=()=>{try{const x=JSON.parse(n.value);n.value=JSON.stringify(x,null,2),b(x),q.success("\u56FE\u8868\u5E94\u7528\u6210\u529F\uFF01"),a.value=!1}catch{q.error("\u914D\u7F6E\u9879\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u68C0\u67E5\u540E\u518D\u5E94\u7528\u914D\u7F6E\uFF01")}};function b(x){const m=o.value.id;t.replaceCom(m,x)}return(x,m)=>{const v=C("g-field"),w=C("b-icon"),$=C("g-input"),y=C("b-ace-editor"),i=C("b-button"),S=C("b-modal");return p(),V("div",Zs,[s(v,{label:"\u7EC4\u4EF6ID",style:{"padding-top":"0","padding-bottom":"0",color:"rgba(255, 255, 255, 0.5)","font-size":"12px"}},{default:g(()=>[j(te(f(o).id),1)]),_:1}),s(v,{label:"\u540D\u79F0",style:{"padding-top":"8px","padding-bottom":"8px"}},{label:g(()=>[e("div",Qs,[ei,l.showCfg?(p(),G(w,{key:0,name:"setting",title:"\u67E5\u770B\u914D\u7F6E\u9879",type:"button",onClick:_})):J("",!0)])]),default:g(()=>[s($,{modelValue:f(o).alias,"onUpdate:modelValue":m[0]||(m[0]=d=>f(o).alias=d)},null,8,["modelValue"])]),_:1}),s(S,{modelValue:a.value,"onUpdate:modelValue":m[2]||(m[2]=d=>a.value=d),title:`[${f(o).alias}] \u914D\u7F6E\u9879 `,"append-to-body":"",top:"60px","custom-class":"schema-modal",onOpened:m[3]||(m[3]=d=>r.value=!0)},{default:g(()=>[e("div",ti,[r.value?(p(),G(y,{key:0,modelValue:n.value,"onUpdate:modelValue":m[1]||(m[1]=d=>n.value=d),theme:"tomorrow_night",wrap:"",styles:{border:"none"}},null,8,["modelValue"])):J("",!0)]),e("div",ai,[s(i,{size:"small",type:"primary",icon:"snippets",onClick:h},{default:g(()=>[j("\u5E94\u7528\u914D\u7F6E\u9879")]),_:1}),s(i,{size:"small",type:"primary",icon:"file-copy",onClick:k},{default:g(()=>[j(" \u590D\u5236\u914D\u7F6E\u9879 ")]),_:1})])]),_:1},8,["modelValue","title"])])}}});var li=W(oi,[["__scopeId","data-v-9a3edfca"]]);const Oe=l=>(ve("data-v-65db66ef"),l=l(),_e(),l),ni={class:"basic-setting-wp"},si={flex:"main:justify cross:center",class:"pr-8"},ii=Oe(()=>e("span",null,"\u5C3A\u5BF8",-1)),ci={style:{width:"81px",padding:"0 4px","margin-bottom":"8px",display:"inline-flex","justify-content":"space-between"}},ui=Oe(()=>e("i",{class:"b-iconfont b-icon-rotate-left"},null,-1)),ri=[ui],di=Oe(()=>e("i",{class:"b-iconfont b-icon-rotate-right"},null,-1)),mi=[di],pi={flex:"main:justify",style:{width:"100%"}},vi=["title","onClick"],_i=Oe(()=>e("div",{class:"divider"},null,-1)),fi={class:"preset-filter-box"},gi={class:"pre-desc",style:{display:"flex","flex-flow":"wrap","justify-content":"space-between","align-items":"center",height:"20px",width:"50px"}},hi=Oe(()=>e("div",{style:{width:"24px",height:"20px","line-height":"20px","font-size":"12px"}},"\u5E95\u8272",-1)),yi={class:"preset-filter"},bi={__name:"basic-setting",props:{attr:{type:Object,required:!0},readonly:{type:Boolean,default:!1}},emits:["update:attr"],setup(l,{emit:t}){const c=t,o=l,a=z({get:()=>o.attr,set:x=>c("update:attr",x)}),{schemaStore:n,storeToRefs:r}=Q(),{selectedCom:_}=r(n),k=z(()=>!Ve(_.value.groupStyle));function h(){_.value.attr.rotate<=0||(_.value.attr.rotate-=90)}function b(){_.value.attr.rotate>=360||(_.value.attr.rotate+=90)}return(x,m)=>{const v=C("b-icon"),w=C("g-input-number"),$=C("g-field"),y=C("b-switch"),i=C("g-slider"),S=C("g-select"),d=C("g-field-collapse");return p(),V("div",ni,[s($,{label:"\u5C3A\u5BF8",style:{"padding-top":"0"},flat:""},{label:g(()=>[e("div",si,[ii,s(v,{name:a.value.lockedRatio?"link":"disconnect",color:a.value.lockedRatio?"var(--bin-color-primary)":"var(--s-text-color)",title:a.value.lockedRatio?"\u89E3\u9664\u9501\u5B9A\u5BBD\u9AD8\u5173\u8054":"\u9501\u5B9A\u5BBD\u9AD8\u5173\u8054",type:"button",onClick:m[0]||(m[0]=u=>a.value.lockedRatio=!a.value.lockedRatio)},null,8,["name","color","title"])])]),default:g(()=>[s(w,{modelValue:a.value.x,"onUpdate:modelValue":m[1]||(m[1]=u=>a.value.x=u),suffix:"X",inline:"",disabled:l.readonly||k.value,style:{"margin-bottom":"8px",width:"85px"}},null,8,["modelValue","disabled"]),s(w,{modelValue:a.value.y,"onUpdate:modelValue":m[2]||(m[2]=u=>a.value.y=u),suffix:"Y",inline:"",disabled:l.readonly||k.value,style:{"margin-bottom":"8px",width:"85px"}},null,8,["modelValue","disabled"]),e("div",ci,[e("span",{title:"\u5DE6\u8F6C90\xB0",onClick:m[3]||(m[3]=u=>h()),class:H(["align-btn",{disabled:l.readonly||k.value}])},ri,2),e("span",{title:"\u53F3\u8F6C90\xB0",onClick:m[4]||(m[4]=u=>b()),class:H(["align-btn",{disabled:l.readonly||k.value}])},mi,2)]),s(w,{modelValue:a.value.w,"onUpdate:modelValue":m[5]||(m[5]=u=>a.value.w=u),suffix:"W",min:10,max:4e3,inline:"",style:{width:"85px"},disabled:l.readonly||k.value},null,8,["modelValue","disabled"]),s(w,{modelValue:a.value.h,"onUpdate:modelValue":m[6]||(m[6]=u=>a.value.h=u),suffix:"H",min:10,max:4e3,inline:"",style:{width:"85px"},disabled:l.readonly||k.value},null,8,["modelValue","disabled"]),s(w,{modelValue:a.value.rotate,"onUpdate:modelValue":m[7]||(m[7]=u=>a.value.rotate=u),min:0,max:360,step:1,inline:"",suffix:"\xB0",disabled:l.readonly||k.value,style:{width:"81px",padding:"0 4px"}},null,8,["modelValue","disabled"])]),_:1}),a.value.chartThemeColor!==void 0?(p(),G($,{key:0,label:"\u989C\u8272",style:{padding:"6px 0 12px"}},{default:g(()=>[s(f(ha))]),_:1})):J("",!0),s($,{label:"\u5BF9\u9F50"},{default:g(()=>[e("div",pi,[(p(!0),V(Y,null,le(f(ya),u=>(p(),V("span",{key:u.value,title:u.label,onClick:I=>f(n).doAdsorption(u.value),class:H(["align-btn",{disabled:l.readonly||k.value}])},[e("i",{class:H(`iconfont-align b-icon-${u.value}-vs`)},null,2)],10,vi))),128))])]),_:1}),_i,s(d,{label:"\u6EE4\u955C&\u53D8\u6362"},{default:g(()=>[s($,{label:"\u542F\u7528"},{default:g(()=>[s(y,{modelValue:a.value.filterShow,"onUpdate:modelValue":m[8]||(m[8]=u=>a.value.filterShow=u),size:"small"},null,8,["modelValue"])]),_:1}),s($,{label:"\u8272\u76F8"},{default:g(()=>[s(i,{modelValue:a.value.hueRotate,"onUpdate:modelValue":m[9]||(m[9]=u=>a.value.hueRotate=u),step:3,min:0,max:360,label:`\u503C\uFF1A${a.value.hueRotate}deg`,"show-input":!1,style:{"margin-bottom":"0"}},null,8,["modelValue","label"]),e("div",fi,[e("div",gi,[hi,e("div",{style:K({backgroundColor:f(ne)})},null,4)]),e("div",yi,[e("div",{class:"item",style:K([{filter:"hue-rotate(36deg)"},{backgroundColor:f(ne)}]),onClick:m[10]||(m[10]=u=>a.value.hueRotate=36)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(72deg)"},{backgroundColor:f(ne)}]),onClick:m[11]||(m[11]=u=>a.value.hueRotate=72)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(108deg)"},{backgroundColor:f(ne)}]),onClick:m[12]||(m[12]=u=>a.value.hueRotate=108)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(144deg)"},{backgroundColor:f(ne)}]),onClick:m[13]||(m[13]=u=>a.value.hueRotate=144)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(180deg)"},{backgroundColor:f(ne)}]),onClick:m[14]||(m[14]=u=>a.value.hueRotate=180)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(216deg)"},{backgroundColor:f(ne)}]),onClick:m[15]||(m[15]=u=>a.value.hueRotate=216)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(252deg)"},{backgroundColor:f(ne)}]),onClick:m[16]||(m[16]=u=>a.value.hueRotate=252)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(288deg)"},{backgroundColor:f(ne)}]),onClick:m[17]||(m[17]=u=>a.value.hueRotate=288)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(324deg)"},{backgroundColor:f(ne)}]),onClick:m[18]||(m[18]=u=>a.value.hueRotate=324)},null,4),e("div",{class:"item",style:K([{filter:"hue-rotate(360deg)"},{backgroundColor:f(ne)}]),onClick:m[19]||(m[19]=u=>a.value.hueRotate=360)},null,4)])])]),_:1}),s($,{label:"\u9971\u548C\u5EA6"},{default:g(()=>[s(i,{modelValue:a.value.saturate,"onUpdate:modelValue":m[20]||(m[20]=u=>a.value.saturate=u),step:.1,min:0,max:2,label:`\u503C\uFF1A${(parseFloat(a.value.saturate)*100).toFixed(0)}%`,"show-input":!1},null,8,["modelValue","label"])]),_:1}),s($,{label:"\u5BF9\u6BD4\u5EA6"},{default:g(()=>[s(i,{modelValue:a.value.contrast,"onUpdate:modelValue":m[21]||(m[21]=u=>a.value.contrast=u),step:.1,min:0,max:2,label:`\u503C\uFF1A${(parseFloat(a.value.contrast)*100).toFixed(0)}%`,"show-input":!1},null,8,["modelValue","label"])]),_:1}),s($,{label:"\u4EAE\u5EA6"},{default:g(()=>[s(i,{modelValue:a.value.brightness,"onUpdate:modelValue":m[22]||(m[22]=u=>a.value.brightness=u),step:.1,min:0,max:2,label:`\u503C\uFF1A${(parseFloat(a.value.brightness)*100).toFixed(0)}%`,"show-input":!1},null,8,["modelValue","label"])]),_:1}),s($,{label:"\u900F\u660E"},{default:g(()=>[s(i,{modelValue:a.value.opacity,"onUpdate:modelValue":m[23]||(m[23]=u=>a.value.opacity=u),min:0,max:1,step:.05,label:`\u503C\uFF1A${(parseFloat(a.value.opacity)*100).toFixed(0)}%`,"show-input":!1},null,8,["modelValue","label"])]),_:1}),s($,{label:"\u6DF7\u5408"},{default:g(()=>[s(S,{modelValue:a.value.blendMode,"onUpdate:modelValue":m[24]||(m[24]=u=>a.value.blendMode=u),data:f(Rt)},null,8,["modelValue","data"])]),_:1}),s($,{label:"\u65CB\u8F6C",flat:""},{default:g(()=>[s(w,{modelValue:a.value.rotate,"onUpdate:modelValue":m[25]||(m[25]=u=>a.value.rotate=u),label:"Z\u8F74(\u5E73\u9762)-\u65CB\u8F6C",min:0,max:360,step:1,inline:"",suffix:"\xB0",slider:""},null,8,["modelValue"]),s(w,{modelValue:a.value.rotateX,"onUpdate:modelValue":m[26]||(m[26]=u=>a.value.rotateX=u),label:"X\u8F74-\u65CB\u8F6C",min:0,max:360,step:1,inline:"",suffix:"\xB0",slider:""},null,8,["modelValue"]),s(w,{modelValue:a.value.rotateY,"onUpdate:modelValue":m[27]||(m[27]=u=>a.value.rotateY=u),label:"Y\u8F74-\u65CB\u8F6C",min:0,max:360,step:1,inline:"",suffix:"\xB0",slider:""},null,8,["modelValue"]),s(w,{modelValue:a.value.perspective,"onUpdate:modelValue":m[28]||(m[28]=u=>a.value.perspective=u),label:"\u900F\u89C6\u50CF\u7D20",min:100,max:2e3,step:1,inline:"",suffix:"px",slider:""},null,8,["modelValue"])]),_:1})]),_:1})])}}};var xi=W(bi,[["__scopeId","data-v-65db66ef"]]);const ki={class:"setting-panel"},wi={__name:"index",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{selectedCom:o}=c(t);return(a,n)=>(p(),V("div",ki,[s(li,{"show-cfg":""}),(p(),G(xi,{key:`${f(o).id}'_basic-setting`,attr:f(o).attr},null,8,["attr"])),(p(),G(Dt(f(o).name+"Config"),{key:f(o).id,data:f(o)},null,8,["data"]))]))}};var Ci=W(wi,[["__scopeId","data-v-218986ba"]]);const $i={class:"animation-wrap"},Vi=["onMouseover","onClick"],Si={__name:"animation-item",props:{list:{type:Array,default:()=>[]}},setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{selectedCom:o}=c(t),a=T(""),n=_=>o.value.animation.name===_,r=_=>{o.value.animation.name=_.value};return(_,k)=>(p(),V("div",$i,[(p(!0),V(Y,null,le(l.list,(h,b)=>(p(),V("div",{class:H(["animation-box",[n(h.value)&&"active"]]),key:b,onMouseover:x=>a.value=h.value,onClick:x=>r(h)},[e("div",{class:H(["animation-item",[a.value===h.value&&`animate__animated  animate__${h.value}`]])},te(h.label),3)],42,Vi))),128))]))}};var Re=W(Si,[["__scopeId","data-v-35abdbe6"]]);const Di={class:"animations-panel"},Mi={style:{padding:"0 10px"}},Ii={class:"p10"},Ri={style:{position:"relative",overflow:"hidden"}},Ti={__name:"index",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{selectedCom:o}=c(t),a=z({get:()=>o.value.animation,set:_=>o.value.animation=_}),n=T([{key:"tab0",title:"\u5E38\u7528"},{key:"tab1",title:"\u5F3A\u8C03"},{key:"tab2",title:"\u79FB\u5165"},{key:"tab3",title:"\u9000\u51FA"},{key:"tab4",title:"\u5176\u4ED6"}]),r=T("tab0");return(_,k)=>{const h=C("b-switch"),b=C("g-field"),x=C("b-space"),m=C("b-tag"),v=C("g-select"),w=C("g-input-number"),$=C("b-tabs"),y=C("b-move-transition");return p(),V("div",Di,[e("div",Mi,[s(x,null,{default:g(()=>[s(b,{label:"\u542F\u7528\u52A8\u753B",style:{padding:"4px 0"}},{default:g(()=>[s(h,{modelValue:a.value.enable,"onUpdate:modelValue":k[0]||(k[0]=i=>a.value.enable=i),size:"small"},null,8,["modelValue"])]),_:1}),s(b,{label:"\u5FAA\u73AF\u64AD\u653E",style:{padding:"4px 0 4px 46px"}},{default:g(()=>[s(h,{modelValue:a.value.loop,"onUpdate:modelValue":k[1]||(k[1]=i=>a.value.loop=i),size:"small"},null,8,["modelValue"])]),_:1})]),_:1}),s(b,{label:"\u5F53\u524D\u52A8\u753B"},{default:g(()=>[s(m,{type:"primary"},{default:g(()=>[j(te(f(ja)(a.value.name)),1)]),_:1})]),_:1}),s(b,{label:"\u64AD\u653E\u901F\u5EA6"},{default:g(()=>[s(v,{modelValue:a.value.timing,"onUpdate:modelValue":k[2]||(k[2]=i=>a.value.timing=i),data:f(Pa)},null,8,["modelValue","data"])]),_:1}),s(b,{label:"\u4EA4\u66FF\u65B9\u5411"},{default:g(()=>[s(v,{modelValue:a.value.direction,"onUpdate:modelValue":k[3]||(k[3]=i=>a.value.direction=i),data:f(Ga)},null,8,["modelValue","data"])]),_:1}),s(x,null,{default:g(()=>[s(b,{label:"\u52A8\u753B\u65F6\u957F",style:{padding:"4px 0"}},{default:g(()=>[s(w,{modelValue:a.value.duration,"onUpdate:modelValue":k[4]||(k[4]=i=>a.value.duration=i),suffix:"\u79D2",min:0,"inline-flex":""},null,8,["modelValue"])]),_:1}),s(b,{label:"\u52A8\u753B\u5EF6\u8FDF",style:{padding:"4px 0 4px 0"}},{default:g(()=>[s(w,{modelValue:a.value.delay,"onUpdate:modelValue":k[5]||(k[5]=i=>a.value.delay=i),suffix:"\u79D2",min:0,"inline-flex":""},null,8,["modelValue"])]),_:1})]),_:1})]),e("div",Ii,[s($,{modelValue:r.value,"onUpdate:modelValue":k[6]||(k[6]=i=>r.value=i),data:n.value},null,8,["modelValue","data"]),e("div",Ri,[s(y,null,{default:g(()=>[r.value==="tab0"?(p(),G(Re,{key:0,list:f(Me)[0].children},null,8,["list"])):J("",!0),r.value==="tab1"?(p(),G(Re,{key:1,list:f(Me)[1].children},null,8,["list"])):J("",!0),r.value==="tab2"?(p(),G(Re,{key:2,list:f(Me)[2].children},null,8,["list"])):J("",!0),r.value==="tab3"?(p(),G(Re,{key:3,list:f(Me)[3].children},null,8,["list"])):J("",!0),r.value==="tab4"?(p(),G(Re,{key:4,list:f(Me)[4].children},null,8,["list"])):J("",!0)]),_:1})])])])}}};var Ei=W(Ti,[["__scopeId","data-v-09b2b3c1"]]);const Li={class:"setting-panel"},Ui={class:"page-config-top"},Bi={class:"page-config-content"},Ni={flex:"main:justify",style:{width:"100%"}},Oi=["title","onClick"],Ai={__name:"multi-setting",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{areaData:o}=c(t),a=z(()=>({x:o.value.x,y:o.value.y,w:o.value.width,h:o.value.height}));return(n,r)=>{const _=C("b-radio"),k=C("b-radio-group"),h=C("g-input-number"),b=C("g-field"),x=C("b-button"),m=C("b-button-group");return p(),V("div",Li,[e("div",Ui,[s(k,{"model-value":"\u591A\u9009\u533A\u57DF",size:"large",type:"capsule",style:{width:"100%"}},{default:g(()=>[s(_,{label:"\u591A\u9009\u533A\u57DF"})]),_:1})]),e("div",Bi,[s(b,{label:"\u4F4D\u7F6E",flat:""},{default:g(()=>[s(h,{modelValue:a.value.x,"onUpdate:modelValue":r[0]||(r[0]=v=>a.value.x=v),suffix:"X",inline:"",disabled:""},null,8,["modelValue"]),s(h,{modelValue:a.value.y,"onUpdate:modelValue":r[1]||(r[1]=v=>a.value.y=v),suffix:"Y",inline:"",disabled:""},null,8,["modelValue"])]),_:1}),s(b,{label:"\u5927\u5C0F",flat:""},{default:g(()=>[s(h,{modelValue:a.value.w,"onUpdate:modelValue":r[2]||(r[2]=v=>a.value.w=v),suffix:"W",min:10,max:4e3,inline:"",disabled:""},null,8,["modelValue"]),s(h,{modelValue:a.value.h,"onUpdate:modelValue":r[3]||(r[3]=v=>a.value.h=v),suffix:"H",min:10,max:4e3,inline:"",disabled:""},null,8,["modelValue"])]),_:1}),s(b,{label:"\u5BF9\u9F50"},{default:g(()=>[e("div",Ni,[(p(!0),V(Y,null,le(f(Tt),v=>(p(),V("span",{key:v.value,title:v.label,onClick:w=>f(t).doAlign(v.value),class:"align-btn"},[e("i",{class:H(`menu-icon iconfont-align b-icon-${v.value}`)},null,2)],8,Oi))),128))])]),_:1}),s(b,{label:"\u7EC4\u5408"},{default:g(()=>[s(m,null,{default:g(()=>[s(x,{size:"small",icon:"group",onClick:r[4]||(r[4]=v=>f(t).group())},{default:g(()=>[j("\u7EC4\u5408")]),_:1})]),_:1})]),_:1})])])}}};var zi=W(Ai,[["__scopeId","data-v-5ed0166e"]]);const ji={style:{margin:"-16px",padding:"10px"}},Pi={__name:"EventParamsModal",props:{modelValue:{type:Boolean,default:!1},params:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(l,{emit:t}){const c=t,o=l,a=z({get:()=>o.modelValue,set:r=>c("update:modelValue",r)}),n=[{title:"\u53C2\u6570\u540D",key:"desc"},{title:"\u53C2\u6570Key",key:"name"},{title:"\u53C2\u6570\u7C7B\u578B",key:"type"}];return(r,_)=>{const k=C("b-table"),h=C("b-modal");return p(),G(h,{modelValue:a.value,"onUpdate:modelValue":_[0]||(_[0]=b=>a.value=b),title:"\u53C2\u6570\u4FE1\u606F",width:"750px","append-to-body":"","custom-class":"schema-modal"},{default:g(()=>[e("div",ji,[s(k,{columns:n,data:l.params,size:"small",border:""},null,8,["data"])])]),_:1},8,["modelValue"])}}},Gi={flex:"main:justify cross:center"},Ji={__name:"trigger-config",props:{eventList:{type:Array,default:()=>ba},events:{type:Object,default:()=>({})}},setup(l){const t=l,c=z(()=>t.events),o=z(()=>{let _=!1;return t.eventList.forEach(k=>{if(!Ve(c.value[k])){_=!0;return}}),_}),a=T([]),n=T(!1);function r(_){a.value=_,n.value=!0}return(_,k)=>{const h=C("b-checkbox"),b=C("b-button"),x=C("g-field"),m=C("g-field-collapse");return o.value?(p(),G(m,{key:0,label:"\u89E6\u53D1\u4E8B\u4EF6","default-open":""},{default:g(()=>[(p(!0),V(Y,null,le(l.eventList,v=>(p(),V(Y,{key:v},[c.value[v]?(p(),G(x,{key:0,label:c.value[v].name},{default:g(()=>[e("div",Gi,[s(h,{modelValue:c.value[v].enable,"onUpdate:modelValue":w=>c.value[v].enable=w},null,8,["modelValue","onUpdate:modelValue"]),s(b,{type:"text",title:"\u67E5\u770B\u4E8B\u4EF6\u53C2\u6570",onClick:w=>r(c.value[v].params)},{default:g(()=>[j(" \u67E5\u770B ")]),_:2},1032,["onClick"])])]),_:2},1032,["label"])):J("",!0)],64))),128)),s(Pi,{modelValue:n.value,"onUpdate:modelValue":k[0]||(k[0]=v=>n.value=v),params:a.value},null,8,["modelValue","params"])]),_:1})):J("",!0)}}};const st=l=>(ve("data-v-96df17aa"),l=l(),_e(),l),Fi={class:"params-map"},Xi={flex:"",class:"params-list"},Ki={class:"left"},Yi=st(()=>e("div",{class:"title"},"\u52A8\u4F5C\u53C2\u6570",-1)),Hi=["onDrop"],Wi=["title"],qi=["title"],Zi=st(()=>e("i",{class:"b-iconfont b-icon-swap",style:{color:"white"}},null,-1)),Qi=["title"],ec=["title"],tc=["title"],ac={class:"btn-con"},oc={class:"right"},lc=st(()=>e("div",{class:"title",style:{color:"#52c41a"}},"\u4E8B\u4EF6\u53C2\u6570",-1)),nc=["onDragstart"],sc={class:"text"},ic={class:"text t-right"},cc={__name:"ParamsMap",props:{emitListAll:{type:Array,default:()=>[]},onEvent:{type:Object,default:null},isShow:{type:Boolean,default:!0}},emits:["save"],setup(l,{emit:t}){const c=t,o=l,a=z(()=>o.emitListAll.find(v=>v.indexIdEventName===o.onEvent.indexIdEventName).params),n=T(Se(o.onEvent.actionParams));function r(v,w){v.dataTransfer.setData("eventParams",JSON.stringify(w))}function _(v){v.preventDefault()}function k(v,w){v.preventDefault(),v.stopPropagation();const $=v.dataTransfer.getData("eventParams"),y=JSON.parse($);w.append?q.warning("\u8FFD\u52A0\u5B57\u6BB5\u65E0\u9700\u6620\u5C04\u3002"):w.name===y.name?q.warning("\u76F8\u540C\u5B57\u6BB5\u65E0\u9700\u6620\u5C04\u3002"):w.map=y}function h(v){v.preventDefault();const w=v.dataTransfer.getData("eventParams");n.value.push({append:!0,...JSON.parse(w)})}function b(v){delete v.map}function x(v){n.value.splice(v,1)}function m(){c("save",n.value)}return(v,w)=>{const $=C("b-button");return p(),V("div",Fi,[e("div",Xi,[e("div",Ki,[Yi,e("div",{class:H(["fields",{empty:n.value.length===0}]),onDragover:_,onDrop:h},[(p(!0),V(Y,null,le(n.value,(y,i)=>(p(),V("div",{key:y.name,class:"param-field",flex:"main:justify cross:center",onDragover:_,onDrop:S=>k(S,y)},[e("div",{class:"text t-left",title:y.desc},[y.append?(p(),G($,{key:0,type:"text","text-color":"danger",icon:"close-circle",title:"\u53D6\u6D88",onClick:S=>x(i)},null,8,["onClick"])):J("",!0),e("span",{title:y.desc},te(y.mapDesc?y.mapDesc:y.desc),9,qi)],8,Wi),Boolean(y.map)&&l.isShow?(p(),V(Y,{key:0},[Zi,e("div",{class:"text t-right",title:y.map.desc},[s($,{type:"text","text-color":"danger",icon:"close-circle",title:"\u53D6\u6D88",onClick:S=>b(y)},null,8,["onClick"]),e("span",{title:y.map.desc},te(y.map.mapDesc?y.map.mapDesc:y.map.desc),9,ec)],8,Qi)],64)):(p(),V("span",{key:1,class:"text t-right",title:y.name},te(y.mapName?y.mapName:y.name),9,tc))],40,Hi))),128))],34),e("div",ac,[s($,{style:{width:"100%"},type:"primary",size:"small",onClick:m},{default:g(()=>[j(" \u4FDD\u5B58 ")]),_:1})])]),e("div",oc,[lc,(p(!0),V(Y,null,le(a.value,y=>(p(),V("div",{key:y.name,class:"param-field move",flex:"main:justify cross:center",draggable:"true",onDragstart:i=>r(i,y)},[e("span",sc,te(y.mapDesc?y.mapDesc:y.desc),1),e("span",ic,te(y.mapName?y.mapName:y.name),1)],40,nc))),128))])])])}}};var uc=W(cc,[["__scopeId","data-v-96df17aa"]]);const rc={class:"series-title"},dc={flex:"main:justify"},mc={style:{width:"100%"},flex:"main:justify cross:center"},pc={style:{width:"49%","margin-right":"2%","margin-top":"2px"}},vc={style:{width:"49%","margin-top":"2px"}},_c={key:0,style:{"min-height":"80px"},flex:"main:center cross:center"},fc={__name:"response-config",props:{compId:{type:String,default:""},events:{type:Object,default:()=>({})},label:{type:String,default:"\u81EA\u5B9A\u4E49\u811A\u672C"},funcExplain:{type:String,default:"\u901A\u8FC7\u63D0\u4F9B\u7684\u53C2\u6570\u7F16\u5199\u811A\u672C\uFF0C\u53EF\u4EE5\u5B9E\u73B0\u66F4\u7075\u6D3B\u7684\u7EC4\u4EF6\u914D\u7F6E\u3002"},paramsDesc:{type:Array,default:()=>[]},exampleDesc:{type:Array,default:()=>[]}},setup(l){const t=l,c=T(null),o=T(""),a=z(()=>t.events),n=z(()=>Object.keys(a.value).includes("onEvents")),r=T(null),_=T(!1),k=z(()=>xa.value.filter(d=>d.compId!==t.compId).map(d=>({value:d.compId,label:d.compName}))),h=z(()=>{const d=a.value.actions;return Object.keys(d).map(u=>({value:u,label:d[u].title}))});function b(d){return ft.value.filter(u=>u.eventName.includes(d)).map(u=>({value:u.eventName,label:u.title}))}function x(){a.value.onEvents.push({eventSource:"",eventName:"",actionName:"",actionParams:[],customScript:{enable:!1,scriptStr:""},register:!1})}function m(d){if(d.eventSource===""){q.warning("\u8BF7\u9009\u62E9\u4E8B\u4EF6\u6E90\uFF01");return}if(d.eventName===""){q.warning("\u8BF7\u7ED1\u5B9A\u4E8B\u4EF6\uFF01");return}if(d.actionName===""){q.warning("\u8BF7\u7ED1\u5B9A\u52A8\u4F5C\uFF01");return}d.register=!0}function v(d,u){u.register?u.register=!1:a.value.onEvents.splice(d,1)}function w(d){_.value=!1,a.value.onEvents[r.value].actionParams=d,r.value=null}function $(d){const u=a.value.onEvents[d];if(u.eventName===""){q.warning("\u8BF7\u7ED1\u5B9A\u4E8B\u4EF6\uFF01");return}if(u.actionName===""){q.warning("\u8BF7\u7ED1\u5B9A\u52A8\u4F5C\uFF01");return}r.value=d,_.value=!0}function y(d,u){const I=a.value.actions[d];I&&(u.actionParams=Se(I.params))}function i(d){const u=a.value.onEvents[d].customScript.scriptStr||"";c.value&&c.value.open(u,d)}function S(d,u){a.value.onEvents[u].customScript.scriptStr=d}return(d,u)=>{const I=C("b-icon"),A=C("b-button"),M=C("g-select"),R=C("g-switch"),U=C("g-button"),P=C("g-field"),B=C("b-drawer"),N=C("CustomScriptsEditor"),O=C("g-field-collapse");return n.value?(p(),G(O,{key:0,label:"\u54CD\u5E94\u4E8B\u4EF6","default-open":""},{add:g(()=>[s(A,{type:"text",title:"\u65B0\u589E\u4E00\u4E2A\u54CD\u5E94\u4E8B\u4EF6",onClick:x},{default:g(()=>[s(I,{name:"plus",size:"16"})]),_:1})]),default:g(()=>{var E,D;return[(p(!0),V(Y,null,le(a.value.onEvents,(L,F)=>(p(),G(P,{key:F,label:"\u4E8B\u4EF6","label-width":"85px"},{label:g(()=>[e("div",rc,[e("span",null,"\u4E8B\u4EF6"+te(F+1),1)])]),default:g(()=>[s(M,{modelValue:L.eventSource,"onUpdate:modelValue":X=>L.eventSource=X,data:k.value,disabled:L.register,label:"\u4E8B\u4EF6\u6E90",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","data","disabled"]),L.eventSource!==""?(p(),V(Y,{key:0},[e("div",dc,[s(M,{modelValue:L.eventName,"onUpdate:modelValue":X=>L.eventName=X,data:b(L.eventSource),disabled:L.register,inline:"",label:"\u7ED1\u5B9A\u4E8B\u4EF6",style:{width:"49%"}},null,8,["modelValue","onUpdate:modelValue","data","disabled"]),s(M,{modelValue:L.actionName,"onUpdate:modelValue":X=>L.actionName=X,data:h.value,disabled:L.register,inline:"",label:"\u7ED1\u5B9A\u52A8\u4F5C",onChange:X=>y(L.actionName,L),style:{width:"49%"}},null,8,["modelValue","onUpdate:modelValue","data","disabled","onChange"])]),e("div",mc,[s(R,{modelValue:L.customScript.enable,"onUpdate:modelValue":X=>L.customScript.enable=X,label:"\u662F\u5426\u6267\u884C\u811A\u672C"},null,8,["modelValue","onUpdate:modelValue"]),L.customScript.enable?(p(),G(U,{key:0,icon:"edit",title:"\u7F16\u8F91",label:"\u811A\u672C\u914D\u7F6E",style:{textAlign:"right"},onClick:X=>i(F)},null,8,["onClick"])):J("",!0)])],64)):J("",!0),L.register?J("",!0):(p(),G(A,{key:1,size:"small",style:{width:"100%","margin-bottom":"4px"},onClick:X=>$(F)},{default:g(()=>[j(" \u53C2\u6570\u6620\u5C04 ")]),_:2},1032,["onClick"])),e("span",pc,[s(A,{size:"small",style:{width:"100%"},type:"primary",disabled:L.register,onClick:X=>m(L)},{default:g(()=>[j(" \u6CE8\u518C\u4E8B\u4EF6 ")]),_:2},1032,["disabled","onClick"])]),e("span",vc,[s(A,{size:"small",style:{width:"100%"},onClick:X=>v(F,L)},{default:g(()=>[j(te(L.register?"\u53D6\u6D88":"\u5220\u9664"),1)]),_:2},1032,["onClick"])])]),_:2},1024))),128)),a.value.onEvents.length===0?(p(),V("div",_c," \u6682\u65E0\u54CD\u5E94\u4E8B\u4EF6 ")):J("",!0),s(B,{modelValue:_.value,"onUpdate:modelValue":u[0]||(u[0]=L=>_.value=L),title:"\u53C2\u6570\u6620\u5C04",width:550,"mask-closable":!1,"class-name":"source-drawer",styles:{padding:0},"append-to-body":""},{default:g(()=>[_.value?(p(),G(uc,{key:0,emitListAll:f(ft),onEvent:a.value.onEvents[r.value],onSave:w},null,8,["emitListAll","onEvent"])):J("",!0)]),_:1},8,["modelValue"]),s(N,{ref_key:"editorRef",ref:c,modelValue:o.value,"onUpdate:modelValue":u[1]||(u[1]=L=>o.value=L),title:l.label+"\u7F16\u8F91\u5668",funcExplain:l.funcExplain,augments:(D=(E=a.value)==null?void 0:E.customScript)==null?void 0:D.augments,paramsDesc:l.paramsDesc,exampleDesc:l.exampleDesc,onSuccess:S},null,8,["modelValue","title","funcExplain","augments","paramsDesc","exampleDesc"])]}),_:1})):J("",!0)}}},gc={__name:"DefaultAction",props:{events:{type:Object,default:()=>({})}},setup(l){const t=l,c=z(()=>t.events),o=z(()=>Object.keys(c.value).includes("defaultAction"));return(a,n)=>{const r=C("b-switch"),_=C("g-field"),k=C("g-field-collapse");return o.value?(p(),G(k,{key:0,label:"\u9ED8\u8BA4\u52A8\u4F5C","default-open":""},{default:g(()=>[s(_,{label:"\u662F\u5426\u5F00\u542F"},{default:g(()=>[s(r,{modelValue:c.value.defaultAction,"onUpdate:modelValue":n[0]||(n[0]=h=>c.value.defaultAction=h),size:"small"},null,8,["modelValue"])]),_:1})]),_:1})):J("",!0)}}};const hc={class:"events-panel"},yc={class:"events-panel-content"},bc={key:0,class:"scroll-container"},xc={class:"setting-panel-gui"},kc={key:1,style:{"min-height":"300px"},flex:"main:center cross:center"},wc={__name:"index",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{selectedCom:o,comps:a}=c(t),n=z(()=>o.value.events),{paramsDesc:r,exampleDesc:_}=It(a.value,o.value);return(k,h)=>{const b=C("b-scrollbar"),x=C("b-empty");return p(),V("div",hc,[e("div",yc,[f(Ve)(n.value)?(p(),V("div",kc,[s(x,null,{default:g(()=>[j("\u8BE5\u7EC4\u4EF6\u4E0D\u9700\u8981\u914D\u7F6E\u4E8B\u4EF6")]),_:1})])):(p(),V("div",bc,[s(b,null,{default:g(()=>[e("div",xc,[s(gc,{events:n.value},null,8,["events"]),s(Ji,{events:n.value},null,8,["events"]),s(fc,{events:n.value,"comp-id":f(o).id,paramsDesc:f(r),exampleDesc:f(_)},null,8,["events","comp-id","paramsDesc","exampleDesc"])])]),_:1})]))])])}}};var Cc=W(wc,[["__scopeId","data-v-7d7ae764"]]);const De=l=>(ve("data-v-3fe4e856"),l=l(),_e(),l),$c={class:"config-panel"},Vc={key:0,class:"page-config-panel"},Sc={class:"page-config-top"},Dc=De(()=>e("span",{class:"mr-8"},"\u5B9A\u5236",-1)),Mc=De(()=>e("span",{class:"mr-8"},"\u52A8\u753B",-1)),Ic=De(()=>e("span",{class:"mr-8"},"\u6570\u636E",-1)),Rc=De(()=>e("span",{class:"mr-8"},"\u4E8B\u4EF6",-1)),Tc={class:"page-config-content"},Ec={key:1,class:"page-config-content"},Lc=De(()=>e("div",{class:"cfg-toggle-bar__top"},null,-1)),Uc=De(()=>e("div",{class:"cfg-toggle-bar__bottom"},null,-1)),Bc=[Lc,Uc],Nc={__name:"index",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{toolbar:o,selectedCom:a,isMultiSelect:n,curComIsGroup:r}=c(t),_=T(0),k=z(()=>!Ve(a.value.groupStyle));return Ce(()=>a.value,()=>{_.value=0}),(h,b)=>{const x=C("b-icon"),m=C("b-radio"),v=C("b-radio-group"),w=C("b-scrollbar");return p(),V("div",{class:H(["config-panel-wp",{"is-hide":!f(o).config}])},[e("div",$c,[f(a)||f(n)?(p(),V("div",Vc,[f(a)?(p(),V(Y,{key:0},[e("div",Sc,[s(v,{modelValue:_.value,"onUpdate:modelValue":b[0]||(b[0]=$=>_.value=$),size:"large",type:"capsule",style:{width:"100%"}},{default:g(()=>[s(m,{label:0},{default:g(()=>[Dc,s(x,{name:"project"})]),_:1}),s(m,{label:1,disabled:k.value},{default:g(()=>[Mc,s(x,{name:"shake"})]),_:1},8,["disabled"]),s(m,{label:2,disabled:f(r)},{default:g(()=>[Ic,s(x,{name:"thunderbolt"})]),_:1},8,["disabled"]),s(m,{label:3,disabled:f(r)},{default:g(()=>[Rc,s(x,{name:"rocket"})]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),e("div",Tc,[s(w,null,{default:g(()=>[_.value===0?(p(),G(Ci,{key:f(a).id})):J("",!0),_.value===1?(p(),G(Ei,{key:f(a).id})):J("",!0),_.value===2?(p(),G(Ws,{key:f(a).id})):J("",!0),_.value===3?(p(),G(Cc,{key:f(a).id})):J("",!0)]),_:1})])],64)):J("",!0),f(n)?(p(),V("div",Ec,[s(zi)])):J("",!0)])):(p(),G(Ks,{key:1}))]),e("div",{class:H(["cfg-toggle-bar",{open:f(o).config}]),onClick:b[1]||(b[1]=$=>f(t).toggleConfigPanel())},Bc,2)],2)}}};var Oc=W(Nc,[["__scopeId","data-v-3fe4e856"]]);const Ac={name:"shortcut",props:{modelValue:{type:Boolean}},emits:["update:modelValue"]},zc=l=>(ve("data-v-e42168ba"),l=l(),_e(),l),jc=zc(()=>e("div",{class:"shortcut-wp"},[e("div",{class:"shortcut-box"},[e("div",{class:"key-title"},"\u57FA\u7840\u5FEB\u6377\u952E"),e("div",{class:"key-wrap"},[e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u5F00\u5173\u56FE\u5C42\u9762\u677F"),e("div",{class:"shortcut-value"},"Ctrl + \u2190")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u5F00\u5173\u914D\u7F6E\u9762\u677F"),e("div",{class:"shortcut-value"},"Ctrl + \u2192")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u5F00\u5173\u7EC4\u4EF6\u9762\u677F"),e("div",{class:"shortcut-value"},"Ctrl + \u2191")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u5F00\u5173\u5DE5\u5177\u680F"),e("div",{class:"shortcut-value"},"Ctrl + \u2193")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u590D\u5236\u9009\u4E2D\u7EC4\u4EF6"),e("div",{class:"shortcut-value"},"Ctrl + C")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u7C98\u8D34\u7EC4\u4EF6"),e("div",{class:"shortcut-value"},"Ctrl + V")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u64A4\u9500\u64CD\u4F5C"),e("div",{class:"shortcut-value"},"Ctrl + Z")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u4FDD\u5B58\u5927\u5C4F"),e("div",{class:"shortcut-value"},"Ctrl + S")])])]),e("div",{class:"shortcut-box"},[e("div",{class:"key-title"},"\u753B\u5E03\u64CD\u4F5C"),e("div",{class:"key-wrap"},[e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u753B\u5E03\u7F29\u653E\u6700\u4F73\u6BD4\u4F8B"),e("div",{class:"shortcut-value"},"Ctrl + A")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u753B\u5E03\u7F29\u653E\u4E3A1\uFF1A1"),e("div",{class:"shortcut-value"},"Ctrl + D")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u81EA\u7531\u7F29\u653E"),e("div",{class:"shortcut-value"},"Ctrl + \u9F20\u6807\u6EDA\u8F6E/\u6EDA\u52A8")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u79FB\u52A8\u753B\u5E03"),e("div",{class:"shortcut-value"},"Space + \u9F20\u6807\u5DE6\u952E/\u62D6\u52A8")])])]),e("div",{class:"shortcut-box"},[e("div",{class:"key-title"},"\u7EC4\u4EF6\u64CD\u4F5C"),e("div",{class:"key-wrap"},[e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u7EC4\u4EF6\u7F6E\u9876"),e("div",{class:"shortcut-value"},"Alt + Home")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u7EC4\u4EF6\u7F6E\u5E95"),e("div",{class:"shortcut-value"},"Alt + End")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u4E0A\u79FB\u4E00\u5C42"),e("div",{class:"shortcut-value"},"Alt + \u2191")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u4E0B\u79FB\u4E00\u5C42"),e("div",{class:"shortcut-value"},"Alt + \u2193")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u79FB\u52A8\u7EC4\u4EF61\u50CF\u7D20"),e("div",{class:"shortcut-value"},"\u2191 \u2193 \u2190 \u2192")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u79FB\u52A8\u7EC4\u4EF610\u50CF\u7D20"),e("div",{class:"shortcut-value"},"Shift + \u2191 \u2193 \u2190 \u2192")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u591A\u9009\u70B9\u51FB\u7EC4\u4EF6"),e("div",{class:"shortcut-value"},"Ctrl + \u9F20\u6807\u5DE6\u952E")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u91CD\u547D\u540D"),e("div",{class:"shortcut-value"},"F2/\u53CC\u51FB\u56FE\u5C42")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u7EC4\u5408"),e("div",{class:"shortcut-value"},"Ctrl + G")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u5220\u9664\u9009\u4E2D\u7EC4\u4EF6"),e("div",{class:"shortcut-value"},"Delete")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u9501\u5B9AX\u8F74\u62D6\u52A8"),e("div",{class:"shortcut-value"},"Shift + \u9F20\u6807\u5DE6\u952E\u62D6\u52A8")]),e("div",{class:"shortcut-item"},[e("div",{class:"shortcut-title"},"\u9501\u5B9AY\u8F74\u62D6\u52A8"),e("div",{class:"shortcut-value"},"Ctrl + \u9F20\u6807\u5DE6\u952E\u62D6\u52A8")])])])],-1));function Pc(l,t,c,o,a,n){const r=C("b-modal");return p(),G(r,{title:"\u5FEB\u6377\u952E\u6307\u5357","model-value":c.modelValue,"append-to-body":"","custom-class":"schema-modal",width:"600px",onClose:t[0]||(t[0]=_=>l.$emit("update:modelValue",!1))},{default:g(()=>[jc]),_:1},8,["model-value"])}var Gc=W(Ac,[["render",Pc],["__scopeId","data-v-e42168ba"]]);const Gt=l=>(ve("data-v-aa163156"),l=l(),_e(),l),Jc={class:"footer-panel"},Fc={class:"screen-info",flex:"cross:center"},Xc={class:"ml-8",style:{transform:"scale(0.9)"}},Kc={key:0,class:"ml-8",style:{transform:"scale(0.9)"}},Yc={flex:"cross:center"},Hc={class:"scale-input-wp"},Wc=Gt(()=>e("span",{class:"percent"},"%",-1)),qc=Gt(()=>e("i",{class:"b-iconfont b-icon-down"},null,-1)),Zc={class:"scale-slider-wp"},Qc=Object.assign({name:"FooterPanel"},{__name:"index",setup(l){const{schemaStore:t,storeToRefs:c}=Q(),{pageConfig:o,canvas:a,shortcuts:n}=c(t),r=T([200,150,100,50]),_=T(20),k=T(20),h=T(!1),b=async v=>{v===-1?t.autoCanvasScale():t.setCanvasScale(v===0?_.value:v)},x=z(()=>n.value.altKey||n.value.ctrlKey||n.value.spaceKey||n.value.shiftKey),m=z(()=>{const{altKey:v,ctrlKey:w,spaceKey:$,shiftKey:y}=n.value,i=[];return v&&i.push("Alt"),w&&i.push("Ctrl"),$&&i.push("Space"),y&&i.push("Shift"),`\u6309\u4E0B\u4E86 [ ${i.join(" , ")} ] \u952E`});return Ce(()=>a.value.scale,v=>{const w=parseInt((v*100).toFixed(2));k.value=w,_.value=w}),(v,w)=>{const $=C("b-icon"),y=C("b-tooltip"),i=C("b-dropdown-item"),S=C("b-dropdown-menu"),d=C("b-dropdown"),u=C("b-slider");return p(),V(Y,null,[e("div",Jc,[e("div",Fc,[s(y,{content:"\u5FEB\u6377\u952E\u63D0\u793A","open-delay":500},{default:g(()=>[s($,{name:"read",size:"16",type:"button",onClick:w[0]||(w[0]=I=>h.value=!0)})]),_:1}),e("span",Xc,te(f(o).width)+" \u50CF\u7D20 * "+te(f(o).height)+" \u50CF\u7D20 ",1),x.value?(p(),V("span",Kc,te(m.value),1)):J("",!0)]),e("div",Yc,[s(d,{trigger:"click",onCommand:b},{dropdown:g(()=>[s(S,null,{default:g(()=>[(p(!0),V(Y,null,le(r.value,I=>(p(),G(i,{key:I,name:I},{default:g(()=>[j(te(`${I}%`),1)]),_:2},1032,["name"]))),128)),s(i,{name:-1},{default:g(()=>[j("\u81EA\u9002\u5E94")]),_:1})]),_:1})]),default:g(()=>[e("div",Hc,[me(e("input",{"onUpdate:modelValue":w[1]||(w[1]=I=>_.value=I),type:"number",class:"scale-input",onKeydown:w[2]||(w[2]=Ee(I=>b(0),["enter"]))},null,544),[[St,_.value]]),Wc,qc])]),_:1}),e("div",Zc,[s(u,{modelValue:k.value,"onUpdate:modelValue":w[3]||(w[3]=I=>k.value=I),min:10,max:200,step:5,"show-tooltip":!1,onChange:b},null,8,["modelValue"])])])]),s(Gc,{modelValue:h.value,"onUpdate:modelValue":w[4]||(w[4]=I=>h.value=I)},null,8,["modelValue"])],64)}}});var eu=W(Qc,[["__scopeId","data-v-aa163156"]]);const ae=l=>(ve("data-v-16ee9347"),l=l(),_e(),l),tu=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-group"},null,-1)),au=ae(()=>e("div",{class:"context-menu-divider"},null,-1)),ou=["onClick"],lu=ae(()=>e("div",{class:"context-menu-divider"},null,-1)),nu=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-delete"},null,-1)),su=ae(()=>e("span",{class:"key-code"},"Delete",-1)),iu=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-ungroup"},null,-1)),cu=ae(()=>e("div",{class:"context-menu-divider"},null,-1)),uu=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-vertical-align-botto",style:{transform:"rotate(180deg)"}},null,-1)),ru=ae(()=>e("span",{class:"key-code"},"Alt + Home",-1)),du=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-vertical-align-botto"},null,-1)),mu=ae(()=>e("span",{class:"key-code"},"Alt + End",-1)),pu=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-arrowup"},null,-1)),vu=ae(()=>e("span",{class:"key-code"},"Alt + \u2191",-1)),_u=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-arrowdown"},null,-1)),fu=ae(()=>e("span",{class:"key-code"},"Alt + \u2193",-1)),gu=ae(()=>e("div",{class:"context-menu-divider"},null,-1)),hu=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-unlock"},null,-1)),yu=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-lock"},null,-1)),bu=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-eye"},null,-1)),xu=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-eye-close"},null,-1)),ku=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-save"},null,-1)),wu=ae(()=>e("div",{class:"context-menu-divider"},null,-1)),Cu=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-edit"},null,-1)),$u=ae(()=>e("span",{class:"key-code"},"F2",-1)),Vu=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-file-copy"},null,-1)),Su=ae(()=>e("span",{class:"key-code"},"Ctrl + C,V",-1)),Du=ae(()=>e("i",{class:"menu-icon b-iconfont b-icon-delete"},null,-1)),Mu=ae(()=>e("span",{class:"key-code"},"Delete",-1)),Iu={__name:"index",setup(l,{expose:t}){const c=T([]),o=T({}),{schemaStore:a,storeToRefs:n}=Q(),{selectedCom:r,selectedComs:_,curComIsGroup:k,isMultiSelect:h,areaData:b}=n(a),{isLocked:x,isHided:m,contextMenu:v,contextMenuStyle:w}=lt(),$=B=>{r.value&&a.moveCom({id:r.value.id,moveType:B})},y=()=>$(ye.up),i=()=>$(ye.down),S=()=>$(ye.top),d=()=>$(ye.bottom),u=()=>{r.value&&(r.value.locked=!r.value.locked)},I=()=>{r.value&&(r.value.hided=!r.value.hided)},A=async()=>{if(c.value=await At(),c.value.length===0){q.warning("\u8BF7\u5148\u521B\u5EFA\u4E00\u4E2A\u9ED8\u8BA4\u7684\u7EC4\u4EF6\u5206\u7EC4\u5728\u8FDB\u884C\u4FDD\u5B58\uFF01");return}o.value=c.value[0].key,Ue({type:"success",title:"\u6307\u5B9A\u7EC4\u4EF6\u5206\u7EC4",message:ut(Ca,{modelValue:o.value,onChange:B=>o.value=B},()=>c.value.map(B=>ut(wa,{label:B.value,value:B.key}))),showCancelButton:!0,confirmText:"\u4FDD\u5B58",cancelText:"\u53D6\u6D88",beforeClose:async(B,N,O)=>{if(B==="confirm"){try{const E=document.getElementById(`component_${r.value.id}`),D=await at(E),L={groupKey:"analysis_material",name:r.value.alias,attr:{w:E.clientWidth,h:E.clientHeight},file:Ra(D,r.value.alias)},F=await Lt(L);await zl(o.value,r.value,F),N.confirmButtonLoading=!0,q.success("\u4FDD\u5B58\u6210\u529F!"),ge.emit(he.SaveCompSuccess)}catch(E){console.log(E),de("createPreviewThumb",E)}N.confirmButtonLoading=!1,O()}else O()}}).then(()=>{}).catch(()=>{})},M=()=>{const B=_.value;B&&B.length>0&&(a.batchDeleteComs(B),a.recordSnapshot(),b.value.showArea=!1)},R=()=>{const B=r.value;B&&a.renamingCom(B.id)},U=()=>{a.copyComs(_.value)},P=B=>{B.preventDefault()};return $e(()=>{ce(document,"contextmenu",P)}),Le(()=>{ue(document,"contextmenu",P)}),t({moveUp:y,moveBottom:d,moveDown:i,moveTop:S,lockCom:u,hideCom:I,toDeleteCom:M,renameCom:R,toCopyCom:U}),(B,N)=>(p(),G(ia,{name:"fade-scale-move"},{default:g(()=>[f(v).show?(p(),V("div",{key:0,class:"context-menu-wrap",style:K(f(w))},[f(h)&&!f(r)?(p(),V(Y,{key:0},[e("div",{class:"context-menu-item",onClick:N[0]||(N[0]=O=>f(a).group())},[tu,j(" \u521B\u5EFA\u5206\u7EC4 ")]),au,(p(!0),V(Y,null,le(f(Tt),O=>(p(),V("div",{class:"context-menu-item",key:O.value,onClick:E=>f(a).doAlign(O.value),style:{"padding-right":"8px"}},[e("i",{class:H(`menu-icon iconfont-align b-icon-${O.value}`)},null,2),j(" "+te(O.label),1)],8,ou))),128)),lu,e("div",{class:"context-menu-item",onClick:M},[nu,j(" \u5220\u9664 "),su])],64)):J("",!0),f(r)?(p(),V(Y,{key:1},[f(k)?(p(),V(Y,{key:0},[e("div",{class:"context-menu-item",onClick:N[1]||(N[1]=O=>f(a).ungroup())},[iu,j(" \u89E3\u9664\u5206\u7EC4 ")]),cu],64)):J("",!0),e("div",{class:"context-menu-item",onClick:S},[uu,j(" \u7F6E\u9876 "),ru]),e("div",{class:"context-menu-item",onClick:d},[du,j(" \u7F6E\u5E95 "),mu]),e("div",{class:"context-menu-item",onClick:y},[pu,j(" \u4E0A\u79FB\u4E00\u5C42 "),vu]),e("div",{class:"context-menu-item",onClick:i},[_u,j(" \u4E0B\u79FB\u4E00\u5C42 "),fu]),gu,e("div",{class:"context-menu-item",onClick:u},[f(x)?(p(),V(Y,{key:0},[hu,j(" \u89E3\u9501 ")],64)):(p(),V(Y,{key:1},[yu,j(" \u9501\u5B9A ")],64))]),e("div",{class:"context-menu-item",onClick:I},[f(m)?(p(),V(Y,{key:0},[bu,j(" \u663E\u793A ")],64)):(p(),V(Y,{key:1},[xu,j(" \u9690\u85CF ")],64))]),e("div",{class:"context-menu-item",onClick:A},[ku,j(" \u4FDD\u5B58 ")]),wu,e("div",{class:"context-menu-item",onClick:R},[Cu,j(" \u91CD\u547D\u540D "),$u]),e("div",{class:"context-menu-item",onClick:U},[Vu,j(" \u590D\u5236 "),Su]),e("div",{class:"context-menu-item",onClick:M},[Du,j(" \u5220\u9664 "),Mu])],64)):J("",!0)],4)):J("",!0)]),_:1}))}};var Ru=W(Iu,[["__scopeId","data-v-16ee9347"]]);function Tu(){const l=Pe(),{schemaStore:t}=Q(),c=T(!1),o=async n=>{try{c.value=!0;const r=await ka(n);if(r){const{id:_,name:k,pid:h,layout:b,components:x}=r,m={pageInfo:{id:_,name:k,pid:h},pageConfig:JSON.parse(b),comps:x.map(v=>JSON.parse(v.componentContent))};t.loadScreenData(m),await je(),document.title=k}}catch(r){console.log(r)}c.value=!1},a=async()=>{try{c.value=!0;const n=await Va();if(n.tpl.length>0){const r=await Da(n.tpl);if(r){const _=JSON.parse(r.content),{comps:k,pageConfig:h}=_;t.loadScreenData({comps:k,pageConfig:h})}}else t.setScreenSize(n)}catch(n){console.log(n)}c.value=!1};return Ce(()=>l.path,async()=>{const{id:n}=l.query;n?await o(n):await a()},{immediate:!0}),{loading:c}}function Eu(){const l=T(null),t=T(null),{saveScreenData:c}=tt(),{schemaStore:o,storeToRefs:a}=Q(),{pageInfo:n,canvas:r,selectedCom:_,selectedComs:k,curComIsGroup:h,isMultiSelect:b}=a(o),x=Pe();let m=null;const v=i=>{const S=i.target;if(!["input","textarea"].includes(S.tagName.toLowerCase())){const d=i.key.toLowerCase();d==="delete"?(t.value&&t.value.toDeleteCom(),i.preventDefault()):d==="f2"&&(t.value&&t.value.renameCom(),i.preventDefault());const u=_.value;i.altKey&&(w("altKey"),d==="arrowup"?t.value&&t.value.moveUp():d==="arrowdown"?t.value&&t.value.moveDown():d==="home"?t.value&&t.value.moveTop():d==="end"&&t.value&&t.value.moveBottom(),i.preventDefault()),i.shiftKey&&w("shiftKey"),i.ctrlKey&&(w("ctrlKey"),d==="arrowup"?(o.toggleCompsPanel(),i.preventDefault()):d==="arrowdown"?(o.toggleToolbox(),i.preventDefault()):d==="arrowleft"?(o.toggleLayerPanel(),i.preventDefault()):d==="arrowright"?(o.toggleConfigPanel(),i.preventDefault()):d==="a"?(o.autoCanvasScale(),i.preventDefault()):d==="d"?(o.setCanvasScale(100),i.preventDefault()):d==="g"?(h.value&&o.ungroup(),b.value&&o.group(),i.preventDefault()):d==="c"?(m=k.value,Ze(JSON.stringify(m)),i.preventDefault()):d==="v"?(m&&o.copyComs(m),i.preventDefault()):d==="s"?(n.value.id||x.query.id?c("edit").then(()=>{q.success("\u4FDD\u5B58\u6210\u529F\uFF01"),Ye("save-success")}):l.value&&l.value.handleSaveScreen(),i.preventDefault()):d==="z"&&(o.undo(),i.preventDefault())),i.keyCode===32&&(w("spaceKey"),i.preventDefault());const I=i.shiftKey?10:1;u&&!i.altKey&&(d==="arrowleft"?(u.attr.x-=I,o.recordSnapshot(),i.preventDefault()):d==="arrowright"?(u.attr.x+=I,o.recordSnapshot(),i.preventDefault()):d==="arrowup"?(u.attr.y-=I,o.recordSnapshot(),i.preventDefault()):d==="arrowdown"&&(u.attr.y+=I,o.recordSnapshot(),i.preventDefault()))}},w=i=>{o.toggleKey({key:i,status:!0})},$=()=>{o.resetKeyCode()},y=i=>{const S=parseInt((r.value.scale*100).toFixed(2)),d=(i.wheelDelta>0?1:-1)*5,u=Math.min(Math.max(S+d,20),200);o.setCanvasScale(u)};return $e(()=>{ce(document,"keydown",v),ce(document,"keyup",$)}),Le(()=>{ue(document,"keydown",v),ue(document,"keyup",$)}),{headerRef:l,contextMenuRef:t,ctrlMouseWheel:y}}const Lu={key:0,flex:"main:center cross:center",class:"full-wrapper"},Uu={key:1,class:"editor-main-wrapper"},Bu={class:"edit-main-wp"},Nu=Object.assign({name:"ScreenEditor"},{__name:"index",setup(l){const{loading:t}=Tu(),{headerRef:c,contextMenuRef:o,ctrlMouseWheel:a}=Eu();return(n,r)=>{const _=C("g-loading");return p(),V("div",{class:"schema-screen-container",onWheel:r[0]||(r[0]=re((...k)=>f(a)&&f(a)(...k),["ctrl","prevent"]))},[s(lo,{ref_key:"headerRef",ref:c,"back-url":"/"},null,512),f(t)?(p(),V("div",Lu,[s(_,{spinning:""})])):(p(),V("div",Uu,[s(hn),s(On),e("div",Bu,[s(hs),s(eu)]),s(Oc)])),s(Ru,{ref_key:"contextMenuRef",ref:o},null,512)],32)}}});var Zu=W(Nu,[["__scopeId","data-v-3ff3886c"]]);export{Zu as default};
