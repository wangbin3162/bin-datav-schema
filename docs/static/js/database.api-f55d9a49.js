import{aJ as n,ab as c,aa as d}from"./vendor-0fc4fabe.js";import{a as r,c as l,d as i}from"./index-89bf360d.js";n.config({name:"__schema_db__",version:1});async function u(e,t){try{const{data:a}=await m(),s=a.findIndex(o=>o.id===e);if(s>-1){const o=a[s];a.splice(s,1,{id:e,datasetName:t,datasourceName:"\u63A2\u7D22\u7A7A\u95F4",creator:o.creator,updater:o.updater,updateDate:d().format("YYYY/MM/DD HH:mm:ss")})}else a.push({id:e,datasetName:t,datasourceName:"\u63A2\u7D22\u7A7A\u95F4",creator:"316281400@qq.com",updater:"316281400@qq.com",updateDate:d().format("YYYY/MM/DD HH:mm:ss")});await n.setItem("list",i(a))}catch(a){console.log("save mock screen data fail.")}}async function m(){const e="list";try{const t=await n.getItem(e);if(t&&t.length)return{data:t};const{data:a}=await c.get(r(`/data/mock/${e}.json`));return await n.setItem(e,a),{data:a}}catch(t){return console.log(t),[]}}async function p(e){try{const t=await n.getItem(e);if(t)return{data:t};{const{data:a}=await c.get(r(`/data/mock/${e}.json`));return await n.setItem(e,a),{data:a}}}catch(t){throw new Error("404")}}async function w(e,t){const a=e||`screen_${l()}`;t.pageInfo.id=a;try{const s=await n.setItem(a,i(t));return await u(a,s.pageInfo.name),{data:s}}catch(s){return console.log(s),null}}async function y(e){try{const{data:t}=await m(),a=t.findIndex(s=>s.id===e);return a>-1?(t.splice(a,1),await n.removeItem(e),await n.setItem("list",i(t)),!0):!1}catch(t){return console.log(t),!1}}function I(e,t){const a=r(`/data/${t}.json?comId=${e}`);return c.get(a)}export{I as a,m as g,p as l,y as r,w as s};
